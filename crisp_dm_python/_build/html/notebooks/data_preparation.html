
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Preparation &#8212; CRISP-DM</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Random Forest Classifier Train Set" href="modelling.html" />
    <link rel="prev" title="Data Understanding" href="data_understanding.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/nextgen_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CRISP-DM</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="business_understanding.html">
   Business Understanding
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data_understanding.html">
   Data Understanding
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Data Preparation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="modelling.html">
   Random Forest Classifier Train Set
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deployment.html">
   Deployment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../quellen.html">
   Quellen:
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/data_preparation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/tlex-web/data_analytics_crisp_dm"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/tlex-web/data_analytics_crisp_dm/issues/new?title=Issue%20on%20page%20%2Fnotebooks/data_preparation.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/tlex-web/data_analytics_crisp_dm/main?urlpath=tree/docs/notebooks/data_preparation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-values">
   Missing Values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verteilung-der-missing-values">
     Verteilung der Missing Values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#behandlung-von-anomalien">
   Behandlung von Anomalien
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#age">
     Age
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#annual-premium">
     Annual Premium
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-test-splitting">
   Train Test Splitting
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#categorial-mapping">
     Categorial Mapping
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imputationverfahren-fur-die-variable-age">
   Imputationverfahren für die Variable Age
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imputation-auf-der-train-batch">
     Imputation auf der Train Batch
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mean-imputation">
       Mean Imputation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#median-imputation">
       Median Imputation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-nearest-neighbour">
       K-Nearest Neighbour
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#miss-forest">
       Miss Forest
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lineares-regressionsmodell">
       Lineares Regressionsmodell
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualisierung-der-imputationsverfahren-in-der-train-batch">
       Visualisierung der Imputationsverfahren in der Train Batch
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualisierung-der-imputationsverfahren-auf-der-test-batch">
     Visualisierung der Imputationsverfahren auf der Test Batch
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualisierung-der-impuation-von-gender">
     Visualisierung der Impuation von gender
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sampling">
   Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#oversampling">
     Oversampling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#undersampling-mit-einem-einfachen-modell-evaluieren">
     Undersampling mit einem einfachen Modell evaluieren
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#oversampling-w-smote">
     Oversampling \w SMOTE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entscheidung-fur-over-oder-undersampling">
     Entscheidung für Over- oder Undersampling
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-engineering">
   Feature Engineering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bewertung-des-feature-engineerings-mittels-logistischer-regression">
     Bewertung des Feature Engineerings mittels Logistischer Regression
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Data Preparation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-values">
   Missing Values
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verteilung-der-missing-values">
     Verteilung der Missing Values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#behandlung-von-anomalien">
   Behandlung von Anomalien
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#age">
     Age
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#annual-premium">
     Annual Premium
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-test-splitting">
   Train Test Splitting
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#categorial-mapping">
     Categorial Mapping
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imputationverfahren-fur-die-variable-age">
   Imputationverfahren für die Variable Age
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imputation-auf-der-train-batch">
     Imputation auf der Train Batch
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mean-imputation">
       Mean Imputation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#median-imputation">
       Median Imputation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-nearest-neighbour">
       K-Nearest Neighbour
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#miss-forest">
       Miss Forest
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lineares-regressionsmodell">
       Lineares Regressionsmodell
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#visualisierung-der-imputationsverfahren-in-der-train-batch">
       Visualisierung der Imputationsverfahren in der Train Batch
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualisierung-der-imputationsverfahren-auf-der-test-batch">
     Visualisierung der Imputationsverfahren auf der Test Batch
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualisierung-der-impuation-von-gender">
     Visualisierung der Impuation von gender
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sampling">
   Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#oversampling">
     Oversampling
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#undersampling-mit-einem-einfachen-modell-evaluieren">
     Undersampling mit einem einfachen Modell evaluieren
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#oversampling-w-smote">
     Oversampling \w SMOTE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entscheidung-fur-over-oder-undersampling">
     Entscheidung für Over- oder Undersampling
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-engineering">
   Feature Engineering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bewertung-des-feature-engineerings-mittels-logistischer-regression">
     Bewertung des Feature Engineerings mittels Logistischer Regression
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="data-preparation">
<h1>Data Preparation<a class="headerlink" href="#data-preparation" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_input-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.figure_factory</span> <span class="k">as</span> <span class="nn">ff</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="kn">import</span> <span class="n">download_plotlyjs</span><span class="p">,</span> <span class="n">init_notebook_mode</span><span class="p">,</span> <span class="n">iplot</span><span class="p">,</span> <span class="n">plot</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">missingno</span> <span class="k">as</span> <span class="nn">msno</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">KNNImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">resample</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">auc</span><span class="p">,</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">StratifiedKFold</span><span class="p">,</span> <span class="n">RandomizedSearchCV</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>
<span class="kn">from</span> <span class="nn">imblearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span> <span class="k">as</span> <span class="n">imbpipeline</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_and_set_df</span><span class="p">(</span><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">train</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>

    <span class="c1"># with open(filepath) as file:</span>
    <span class="c1"># file.readlines()</span>

    <span class="c1"># Datensatz einlesen</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;$&#39;</span><span class="p">,</span>  <span class="c1"># r&#39;([$-,])+/g&#39;</span>
                     <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>  <span class="c1"># , na_values=[np.nan, pd.NA], keep_default_na=True)</span>

    <span class="c1"># Spaltennamen alle kleingeschrieben</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="c1"># Die Spaltennamen waren verschoben - In diesem Schritt werden sie richtig zugeordnet</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;unnamed: 0&#39;</span><span class="p">:</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;gender&#39;</span><span class="p">,</span>
        <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span>
        <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="s1">&#39;driving_license&#39;</span><span class="p">,</span>
        <span class="s1">&#39;driving_license&#39;</span><span class="p">:</span> <span class="s1">&#39;region_code&#39;</span><span class="p">,</span>
        <span class="s1">&#39;region_code&#39;</span><span class="p">:</span> <span class="s1">&#39;previously_insured&#39;</span><span class="p">,</span>
        <span class="s1">&#39;previously_insured&#39;</span><span class="p">:</span> <span class="s1">&#39;vehicle_age&#39;</span><span class="p">,</span>
        <span class="s1">&#39;vehicle_age&#39;</span><span class="p">:</span> <span class="s1">&#39;vehicle_damage&#39;</span><span class="p">,</span>
        <span class="s1">&#39;vehicle_damage&#39;</span><span class="p">:</span> <span class="s1">&#39;annual_premium&#39;</span><span class="p">,</span>
        <span class="s1">&#39;annual_premium&#39;</span><span class="p">:</span> <span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">,</span>
        <span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">:</span> <span class="s1">&#39;vintage&#39;</span><span class="p">,</span>
        <span class="s1">&#39;vintage&#39;</span><span class="p">:</span> <span class="s1">&#39;response&#39;</span><span class="p">,</span>
        <span class="s1">&#39;response&#39;</span><span class="p">:</span> <span class="s1">&#39;nan&#39;</span>
    <span class="p">},</span>
        <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Letzte Spalte besteht nur aus nan und kann somit gelöscht werden</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">train</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;nan&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">df</span>


<span class="k">def</span> <span class="nf">set_datatypes</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>

    <span class="c1"># Numerische Variablen</span>
    <span class="c1"># Nullable Interger</span>

    <span class="c1"># Variable Age</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>

    <span class="c1"># Annual Premium</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;annual_premium&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;annual_premium&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;annual_premium&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;annual_premium&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>

    <span class="c1"># Vintage</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;##&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;vintage&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;vintage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;vintage&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;vintage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;vintage&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>

    <span class="c1"># Region Code</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;region_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;region_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;region_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;region_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;region_code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;region_code&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;region_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;region_code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="c1"># Policy Sales Channel</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;##&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;policy_sales_channel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
        <span class="n">df</span><span class="p">[</span><span class="s2">&quot;policy_sales_channel&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;policy_sales_channel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;policy_sales_channel&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>

    <span class="c1"># Kategorische Variablen</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;driving_license&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;driving_license&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;previously_insured&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;previously_insured&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vehicle_damage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vehicle_damage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vehicle_age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vehicle_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="c1"># Response</span>
    <span class="n">df</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
        <span class="p">{</span><span class="s1">&#39;0&#39;</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;no&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

    <span class="c1">#df = df.replace(to_replace=[&#39;NaN&#39;, &#39;&lt;NA&gt;&#39;, &#39;NAN&#39;, &#39;nan&#39;,</span>
    <span class="c1">#                pd.NA, np.nan, np.NaN, np.NAN], value=np.NaN, inplace=True)</span>

    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">read_and_set_df</span><span class="p">(</span><span class="s1">&#39;../data/train.csv&#39;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">set_datatypes</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>gender</th>
      <th>age</th>
      <th>driving_license</th>
      <th>region_code</th>
      <th>previously_insured</th>
      <th>vehicle_age</th>
      <th>vehicle_damage</th>
      <th>annual_premium</th>
      <th>policy_sales_channel</th>
      <th>vintage</th>
      <th>response</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Male</td>
      <td>44</td>
      <td>No</td>
      <td>28.0</td>
      <td>No</td>
      <td>&gt; 2 Years</td>
      <td>Yes</td>
      <td>40454</td>
      <td>26</td>
      <td>217</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Male</td>
      <td>76</td>
      <td>No</td>
      <td>3.0</td>
      <td>No</td>
      <td>1-2 Year</td>
      <td>No</td>
      <td>33536</td>
      <td>26</td>
      <td>183</td>
      <td>no</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Male</td>
      <td>47</td>
      <td>No</td>
      <td>28.0</td>
      <td>No</td>
      <td>&gt; 2 Years</td>
      <td>Yes</td>
      <td>38294</td>
      <td>26</td>
      <td>27</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Male</td>
      <td>21</td>
      <td>Yes</td>
      <td>11.0</td>
      <td>Yes</td>
      <td>&lt; 1 Year</td>
      <td>No</td>
      <td>28619</td>
      <td>152</td>
      <td>203</td>
      <td>no</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Female</td>
      <td>29</td>
      <td>Yes</td>
      <td>41.0</td>
      <td>Yes</td>
      <td>&lt; 1 Year</td>
      <td>No</td>
      <td>27496</td>
      <td>152</td>
      <td>39</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>380999.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>190500.0</td>
      <td>109985.081943</td>
      <td>1.0</td>
      <td>95250.5</td>
      <td>190500.0</td>
      <td>285749.5</td>
      <td>380999.0</td>
    </tr>
    <tr>
      <th>gender</th>
      <td>379948</td>
      <td>2</td>
      <td>Male</td>
      <td>205447</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>age</th>
      <td>370107.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38.852091</td>
      <td>15.63218</td>
      <td>20.0</td>
      <td>25.0</td>
      <td>36.0</td>
      <td>49.0</td>
      <td>205.0</td>
    </tr>
    <tr>
      <th>driving_license</th>
      <td>380948</td>
      <td>2</td>
      <td>No</td>
      <td>206635</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>region_code</th>
      <td>380999.0</td>
      <td>53.0</td>
      <td>28.0</td>
      <td>106372.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>previously_insured</th>
      <td>380948</td>
      <td>2</td>
      <td>No</td>
      <td>206635</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>vehicle_age</th>
      <td>380948</td>
      <td>3</td>
      <td>1-2 Year</td>
      <td>200228</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>vehicle_damage</th>
      <td>380948</td>
      <td>2</td>
      <td>Yes</td>
      <td>192328</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>annual_premium</th>
      <td>380999.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30527.70069</td>
      <td>17242.997675</td>
      <td>-9997.0</td>
      <td>24371.0</td>
      <td>31656.0</td>
      <td>39390.0</td>
      <td>540165.0</td>
    </tr>
    <tr>
      <th>policy_sales_channel</th>
      <td>380999.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>112.035331</td>
      <td>54.203334</td>
      <td>1.0</td>
      <td>29.0</td>
      <td>133.0</td>
      <td>152.0</td>
      <td>163.0</td>
    </tr>
    <tr>
      <th>vintage</th>
      <td>380948.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>154.344475</td>
      <td>83.673075</td>
      <td>10.0</td>
      <td>82.0</td>
      <td>154.0</td>
      <td>227.0</td>
      <td>299.0</td>
    </tr>
    <tr>
      <th>response</th>
      <td>380999</td>
      <td>2</td>
      <td>no</td>
      <td>334297</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="missing-values">
<h2>Missing Values<a class="headerlink" href="#missing-values" title="Permalink to this headline">¶</a></h2>
<p>Die Funktion <code class="docutils literal notranslate"><span class="pre">heatmap()</span></code> von <code class="docutils literal notranslate"><span class="pre">missingno</span></code> misst die Nullkorrelation: wie stark das Vorhandensein oder Fehlen einer Variable das Vorhandensein einer anderen Variable beeinflusst.</p>
<p>Die Nullkorrelation reicht von -1 (wenn eine Variable auftritt, tritt die andere definitiv nicht auf) über 0 (auftauchende oder nicht auftauchende Variablen haben keinen Einfluss aufeinander) bis 1 (wenn eine Variable auftritt, tritt die andere definitiv auf).</p>
<div class="section" id="verteilung-der-missing-values">
<h3>Verteilung der Missing Values<a class="headerlink" href="#verteilung-der-missing-values" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verteilung der Missing Values innerhalb der Variablen </span>
<span class="n">msno</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">sparkline</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.27</span><span class="p">,</span> <span class="mf">0.52</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/data_preparation_8_1.png" src="../_images/data_preparation_8_1.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;YlGnBu&quot;</span><span class="p">,</span>
            <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Missing Data&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/data_preparation_9_1.png" src="../_images/data_preparation_9_1.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lineare Abhängigkeit der fehlenden Werten in den jeweiligen Spalten </span>
<span class="c1"># -&gt; Zeigt an, ob fehlende Werte an denselben Stellen in Datensatz auftreten</span>
<span class="n">msno</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/data_preparation_10_1.png" src="../_images/data_preparation_10_1.png" />
</div>
</div>
<p>Um dieses Diagramm zu interpretieren, lesen Sie es aus einer Top-Down-Perspektive. Clusterblätter, die in einem Abstand von Null miteinander verbunden sind, sagen das Vorhandensein des jeweils anderen vollständig voraus - eine Variable könnte immer leer sein, wenn eine andere gefüllt ist, oder sie könnten immer beide gefüllt oder beide leer sein, und so weiter. In diesem speziellen Beispiel klebt das Dendrogramm die Variablen zusammen, die erforderlich und daher in jedem Datensatz vorhanden sind.</p>
<p>Beschreibung:
Das Dendrogramm verwendet einen hierarchischen Clustering-Algorithmus, um die Variablen anhand ihrer Nullkorrelation gegeneinander abzugrenzen.</p>
<p>Erklärung:
Clutster, die sich in bei Null aufspalten, sagen sich untereinander vollkommen voraus (Korrelation von 1).</p>
<p>Auf jeder Stufe des Baums werden die Variablen auf der Grundlage der Kombination aufgeteilt, die den Abstand der verbleibenden Cluster minimiert.</p>
<p>Je monotoner die Variablen sind, desto näher liegt ihr Gesamtabstand bei Null und desto näher liegt ihr durchschnittlicher Abstand (die y-Achse) bei Null.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msno</span><span class="o">.</span><span class="n">dendrogram</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/data_preparation_12_1.png" src="../_images/data_preparation_12_1.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_na_bool</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>

<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">df_na_bool</span><span class="p">[(</span><span class="n">df_na_bool</span><span class="p">[</span><span class="s1">&#39;previously_insured&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="o">&amp;</span> 
           <span class="p">(</span><span class="n">df_na_bool</span><span class="p">[</span><span class="s1">&#39;driving_license&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="o">&amp;</span>
           <span class="p">(</span><span class="n">df_na_bool</span><span class="p">[</span><span class="s1">&#39;vehicle_age&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="o">&amp;</span>
           <span class="p">(</span><span class="n">df_na_bool</span><span class="p">[</span><span class="s1">&#39;vehicle_damage&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="o">&amp;</span>
           <span class="p">(</span><span class="n">df_na_bool</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Listenweiser Fallausschluss - Wir haben mittels dem listenweisen Fallausschluss 51 Zeilen aus dem Datensatz entfernt. Dabei haben wir ebenfalls die Anzahl der missing values bei den Variablen von age und gender um 51 Werte reduziert.</p>
</div>
</div>
<div class="section" id="behandlung-von-anomalien">
<h2>Behandlung von Anomalien<a class="headerlink" href="#behandlung-von-anomalien" title="Permalink to this headline">¶</a></h2>
<div class="section" id="age">
<h3>Age<a class="headerlink" href="#age" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Untergrenze: 18</p></li>
</ul>
<p>Da man in Indien ab 18 Jahren ein KFZ  führen darf, kann man ab diesem Alter auch auf seinen Namen eine KFZ-Verischerung abschließen</p>
<ul class="simple">
<li><p>Obergrenze: 75</p></li>
</ul>
<p>Da der obere Whisker bei <code class="docutils literal notranslate"><span class="pre">age</span></code> und <code class="docutils literal notranslate"><span class="pre">response=Yes</span></code> bei 75 liegt, übernehmen wir diesen Wert als Übergrenze.
Aufgrund der durchschnittlichen Lebenserwartung in Indien von 69.3, wird es wohl keine Personen über 80 Jahren geben, welche noch ein KFZ führen.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index_max_age</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">75</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index_max_age</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">index_min_age</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index_min_age</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    362674.000000
mean         38.043932
std          14.659251
min          20.000000
25%          24.000000
50%          35.000000
75%          49.000000
max          74.000000
Name: age, dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="annual-premium">
<h3>Annual Premium<a class="headerlink" href="#annual-premium" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Untergrenze: 0</p></li>
</ul>
<p>Negative Werte als Prämie erscheinen uns nicht schlüssig, da man in Indien sicherlich keine Erstattungen oder Rückzahlungen von Beiträgen bei der Krankenkasse zu erwarten hat, da die Beiträge dort nicht gesetzlich geregelt, sondern nach eigenem Ermessen gezahlt werden.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index_min_premium</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;annual_premium&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">index_min_premium</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;annual_premium&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    373154.000000
mean      30487.282658
std       17150.424235
min        2630.000000
25%       24371.000000
50%       31611.000000
75%       39298.000000
max      540165.000000
Name: annual_premium, dtype: float64
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="train-test-splitting">
<h2>Train Test Splitting<a class="headerlink" href="#train-test-splitting" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;response&#39;</span><span class="p">]]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">X_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">y_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">X_test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

<span class="nb">len</span><span class="p">(</span><span class="n">X_train_df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_train_df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test_df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(261207, 261207, 111947, 111947)
</pre></div>
</div>
</div>
</div>
<div class="section" id="categorial-mapping">
<h3>Categorial Mapping<a class="headerlink" href="#categorial-mapping" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">map_categorials_x</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mapping der kategorialen Variablen zu numerischen Variablen</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">LE</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;driving_license&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;driving_license&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;previously_insured&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;previously_insured&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vehicle_age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;vehicle_age&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;vehicle_damage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;vehicle_damage&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;region_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;region_code&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;gender&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">df</span>

<span class="n">X_train_label_encoded</span> <span class="o">=</span> <span class="n">map_categorials_x</span><span class="p">(</span><span class="n">X_train_df</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="n">X_test_label_encoded</span> <span class="o">=</span> <span class="n">map_categorials_x</span><span class="p">(</span><span class="n">X_test_df</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">map_categorials_y</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mapping der Zielvariable</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">LE</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>

    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;response&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">df</span>

<span class="n">y_train_label_encoded</span> <span class="o">=</span> <span class="n">map_categorials_y</span><span class="p">(</span><span class="n">y_train_df</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="n">y_test_label_encoded</span> <span class="o">=</span> <span class="n">map_categorials_y</span><span class="p">(</span><span class="n">y_test_df</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>ONE HOT ENCODING</p>
<p>ONE-HOT-ENCODING transformiert kategoriale Variablen zu binären Variablen mittels des ‘one-hot’ Verfahrens.
Dieser Schritt der Kodierung kategorialer Variablen ist nötig, um diese später in linearen Modellen und Vektor Maschinen zu verwenden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_df_one_hot_encoded_data_without_gender</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_train_df</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;driving_license&#39;</span><span class="p">,</span> <span class="s1">&#39;vehicle_age&#39;</span><span class="p">,</span> <span class="s1">&#39;vehicle_damage&#39;</span><span class="p">,</span> <span class="s1">&#39;previously_insured&#39;</span><span class="p">])</span>

<span class="n">X_test_df_one_hot_encoded_data_without_gender</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_test_df</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;driving_license&#39;</span><span class="p">,</span> <span class="s1">&#39;vehicle_age&#39;</span><span class="p">,</span> <span class="s1">&#39;vehicle_damage&#39;</span><span class="p">,</span> <span class="s1">&#39;previously_insured&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Wir wenden die ONE-HOT Kodierung nicht auf die Variable <code class="docutils literal notranslate"><span class="pre">gender</span></code> an, die wir dann deren fehlende Werte nicht mehr mit den <code class="docutils literal notranslate"><span class="pre">sklearn.Imputer</span></code> imputieren können. Stattdessen kodieren wir alle anderen Variablen und wenden die ONE-HOT Kodierung nach der erfolgreichen Imputation von <code class="docutils literal notranslate"><span class="pre">gender</span></code> wieder diese an.</p>
</div>
</div>
<div class="section" id="imputationverfahren-fur-die-variable-age">
<h2>Imputationverfahren für die Variable Age<a class="headerlink" href="#imputationverfahren-fur-die-variable-age" title="Permalink to this headline">¶</a></h2>
<div class="section" id="imputation-auf-der-train-batch">
<h3>Imputation auf der Train Batch<a class="headerlink" href="#imputation-auf-der-train-batch" title="Permalink to this headline">¶</a></h3>
<p>usprüngliche Verteilung vom Alter bei der Train und Test Batch</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_original_age</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train_df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
<span class="n">X_test_original_age</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test_df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="mean-imputation">
<h4>Mean Imputation<a class="headerlink" href="#mean-imputation" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing values of Age with the average of Age (mean)</span>
<span class="n">X_test_mean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test_df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">X_test_df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
<span class="n">X_train_mean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train_df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">X_train_df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="median-imputation">
<h4>Median Imputation<a class="headerlink" href="#median-imputation" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing values of Age with the average of Age (median)</span>
<span class="n">X_test_median</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test_df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">X_test_df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
<span class="n">X_train_median</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train_df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">X_train_df</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="k-nearest-neighbour">
<h4>K-Nearest Neighbour<a class="headerlink" href="#k-nearest-neighbour" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Um die beste Anzahl an neighbors zu ermittlen, erstellen wir eine Pipeline zur Extraktion der höchsten accuracy </span>
<span class="c1"># bei einem Random Forest Classifier mittles cross-validation</span>
<span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">n_neighbors</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">21</span><span class="p">]]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">n_neighbors</span><span class="p">:</span>
	<span class="c1"># modeling pipeline</span>
	<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">))),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">))])</span>
	<span class="c1"># Cross-Validation </span>
	<span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
	<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">X_train_label_encoded</span><span class="p">,</span> <span class="n">y_train_label_encoded</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
	<span class="c1"># Ergebnisse sichern</span>
	<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%.3f</span><span class="s1"> (</span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores</span><span class="p">)))</span>
<span class="c1"># plot model performance</span>
<span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">,</span> <span class="n">showmeans</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Zur dynamischen Übergabe der besten Anzahl an n_neighbors filtern wir diesen aus dem Array n_neighbors, </span>
<span class="c1"># über den Index der Spalte mit dem höchsten Mittelwert</span>

<span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="n">means_per_row</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">means_per_row</span><span class="p">)</span>

<span class="n">best_n_neighbors</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_neighbors</span><span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">l</span><span class="p">))])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn</span> <span class="o">=</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">best_n_neighbors</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">)</span>

<span class="c1"># Modellierung auf Trainingsdaten</span>
<span class="c1"># Da unser Modell nur mit numerischen Werten umgehen kann, ersetzen wir die kategorialen Werte durch numerische</span>
<span class="n">X_train_df_knn_X</span> <span class="o">=</span> <span class="n">X_train_df_one_hot_encoded_data_without_gender</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span> 

<span class="n">X_knn_train</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_df_knn_X</span><span class="p">)</span>
<span class="n">X_train_df_knn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_knn_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_train_df_knn_X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">X_train_df_knn</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train_df_knn</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>

<span class="c1"># Modellierung auf Testdaten</span>
<span class="n">X_test_df_knn_X</span> <span class="o">=</span> <span class="n">X_test_df_one_hot_encoded_data_without_gender</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">X_knn_test</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test_df_knn_X</span><span class="p">)</span>
<span class="n">X_test_df_knn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_knn_test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_test_df_knn_X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">X_test_df_knn</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test_df_knn</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>

<span class="c1"># Nach der Imputation wandeln wir diese wieder zu kategorialen Werten zurück. (Dieser Schritt wäre nicht nötig, allerdings wollen wir bei der ONE-HOT Kodierung wieder die Ausprägung im Variablennamen stehen haben, z.B gender_Female statt gender_0)</span>
<span class="n">X_train_df_knn</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train_df_knn</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Male&#39;</span><span class="p">})</span>
<span class="n">X_test_df_knn</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test_df_knn</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Male&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the correlation matrix</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">X_train_df_knn</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Generate a mask for the upper triangle; True = do NOT show</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Set up the matplotlib figure</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="c1"># Generate a custom diverging colormap</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;crest&quot;</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Draw the heatmap with the mask and correct aspect ratio</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span>
    <span class="n">corr</span><span class="p">,</span>          <span class="c1"># The data to plot</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>     <span class="c1"># Mask some cells</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>     <span class="c1"># What colors to plot the heatmap as</span>
    <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>    <span class="c1"># Should the values be plotted in the cells?</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mf">.3</span><span class="p">,</span>       <span class="c1"># The maximum value of the legend. All higher vals will be same color</span>
    <span class="n">vmin</span><span class="o">=-</span><span class="mf">.3</span><span class="p">,</span>      <span class="c1"># The minimum value of the legend. All lower vals will be same color</span>
    <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>      <span class="c1"># The center value of the legend. With divergent cmap, where white is</span>
    <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>   <span class="c1"># Force cells to be square</span>
    <span class="n">linewidths</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="c1"># Width of lines that divide cells</span>
    <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">}</span>  <span class="c1"># Extra kwargs for the legend; in this case, shrink by 50%</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/data_preparation_40_1.png" src="../_images/data_preparation_40_1.png" />
</div>
</div>
</div>
<div class="section" id="miss-forest">
<h4>Miss Forest<a class="headerlink" href="#miss-forest" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Modellierung auf den Trainingsdaten</span>
<span class="c1"># Diesselbe Herangehensweise bei der Impuation von gender wenden wir auch hier an</span>
<span class="n">X_train_df_mice_X</span> <span class="o">=</span> <span class="n">X_train_df_one_hot_encoded_data_without_gender</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">mice_imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">()</span>
<span class="n">X_mice</span> <span class="o">=</span> <span class="n">mice_imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_df_mice_X</span><span class="p">)</span>
<span class="n">X_train_df_mice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_mice</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_train_df_mice_X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">X_train_df_mice</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train_df_mice</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>
<span class="n">X_train_df_mice</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train_df_mice</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Male&#39;</span><span class="p">})</span>

<span class="c1"># Modellierung auf den Testdaten</span>
<span class="n">X_test_df_mice_X</span> <span class="o">=</span> <span class="n">X_test_df_one_hot_encoded_data_without_gender</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Female&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Male&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">X_mice</span> <span class="o">=</span> <span class="n">mice_imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test_df_mice_X</span><span class="p">)</span>
<span class="n">X_test_df_mice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_mice</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">X_test_df_mice_X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">X_test_df_mice</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test_df_mice</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">)</span>
<span class="n">X_test_df_mice</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test_df_mice</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Male&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="lineares-regressionsmodell">
<h4>Lineares Regressionsmodell<a class="headerlink" href="#lineares-regressionsmodell" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train-Batch Datensatz filtern, nach allen Zeilen mit Missing Values bei Age</span>
<span class="n">X_train_age_na</span> <span class="o">=</span> <span class="n">X_train_df_one_hot_encoded_data_without_gender</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="n">X_train_age_missing</span> <span class="o">=</span> <span class="n">X_train_age_na</span><span class="p">[</span><span class="n">X_train_age_na</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
<span class="n">X_train_age_missing</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">X_train_age_missing</span><span class="p">,</span> <span class="n">X_train_df_one_hot_encoded_data_without_gender</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">del</span> <span class="n">X_train_age_missing</span><span class="p">[</span><span class="s1">&#39;age_y&#39;</span><span class="p">]</span>
<span class="k">del</span> <span class="n">X_train_age_missing</span><span class="p">[</span><span class="s1">&#39;age_x&#39;</span><span class="p">]</span>

<span class="c1"># Test-Batch Datensatz filtern, nach allen Zeilen mit Missing Values bei Age</span>
<span class="n">X_test_age_na</span> <span class="o">=</span> <span class="n">X_test_df_one_hot_encoded_data_without_gender</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="n">X_test_age_missing</span> <span class="o">=</span> <span class="n">X_test_age_na</span><span class="p">[</span><span class="n">X_test_age_na</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
<span class="n">X_test_age_missing</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">X_test_age_missing</span><span class="p">,</span> <span class="n">X_test_df_one_hot_encoded_data_without_gender</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">del</span> <span class="n">X_test_age_missing</span><span class="p">[</span><span class="s1">&#39;age_y&#39;</span><span class="p">]</span>
<span class="k">del</span> <span class="n">X_test_age_missing</span><span class="p">[</span><span class="s1">&#39;age_x&#39;</span><span class="p">]</span>

<span class="c1"># Länge der beiden Data Frames ausgeben lassen</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train_age_missing</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test_age_missing</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7577 3264
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Casting für die Training-Batch</span>
<span class="n">X_train_df_one_hot_encoded_data_no_na</span> <span class="o">=</span> <span class="n">X_train_df_one_hot_encoded_data_without_gender</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">X_train_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">X_train_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X_train_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X_train_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X_train_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Casting für die Testing-Batch</span>
<span class="n">X_test_df_one_hot_encoded_data_no_na</span> <span class="o">=</span> <span class="n">X_test_df_one_hot_encoded_data_without_gender</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">X_test_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">X_test_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X_test_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X_test_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X_test_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test_df_one_hot_encoded_data_no_na</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Modell aufbauen</span>
<span class="k">def</span> <span class="nf">smf_ols_spec</span><span class="p">(</span><span class="n">df</span><span class="p">):</span> 
    <span class="n">mod</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;age ~ annual_premium + policy_sales_channel + vehicle_damage_No + vehicle_damage_Yes + previously_insured_No + previously_insured_Yes&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">X_train_df_one_hot_encoded_data_no_na</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mod</span>

<span class="n">ols_train</span> <span class="o">=</span> <span class="n">smf_ols_spec</span><span class="p">(</span><span class="n">X_train_df_one_hot_encoded_data_no_na</span><span class="p">)</span>
<span class="n">ols_test</span> <span class="o">=</span> <span class="n">smf_ols_spec</span><span class="p">(</span><span class="n">X_test_df_one_hot_encoded_data_no_na</span><span class="p">)</span>

<span class="c1"># Modell auf den Trainingsdaten fitten</span>
<span class="n">res_train</span> <span class="o">=</span> <span class="n">ols_train</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">res_test</span> <span class="o">=</span> <span class="n">ols_test</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resultate für die Training-Batch ausgeben lassen </span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_train</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    age   R-squared:                       0.363
Model:                            OLS   Adj. R-squared:                  0.363
Method:                 Least Squares   F-statistic:                 3.596e+04
Date:                Mon, 24 Jan 2022   Prob (F-statistic):               0.00
Time:                        14:20:49   Log-Likelihood:            -9.8108e+05
No. Observations:              252944   AIC:                         1.962e+06
Df Residuals:                  252939   BIC:                         1.962e+06
Df Model:                           4                                         
Covariance Type:            nonrobust                                         
==========================================================================================
                             coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------------------
Intercept                 27.3314      0.037    747.907      0.000      27.260      27.403
annual_premium          9.261e-07   1.36e-06      0.680      0.497   -1.74e-06     3.6e-06
policy_sales_channel      -0.1481      0.000   -330.880      0.000      -0.149      -0.147
vehicle_damage_No         12.0812      0.045    266.564      0.000      11.992      12.170
vehicle_damage_Yes        15.2503      0.045    339.196      0.000      15.162      15.338
previously_insured_No     14.5066      0.043    334.118      0.000      14.421      14.592
previously_insured_Yes    12.8249      0.047    272.830      0.000      12.733      12.917
==============================================================================
Omnibus:                    27342.642   Durbin-Watson:                   2.005
Prob(Omnibus):                  0.000   Jarque-Bera (JB):            38040.906
Skew:                           0.862   Prob(JB):                         0.00
Kurtosis:                       3.797   Cond. No.                     7.00e+18
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The smallest eigenvalue is 6.33e-24. This might indicate that there are
strong multicollinearity problems or that the design matrix is singular.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resultate für die Training-Batch ausgeben lassen </span>
<span class="nb">print</span><span class="p">(</span><span class="n">res_test</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:                    age   R-squared:                       0.363
Model:                            OLS   Adj. R-squared:                  0.363
Method:                 Least Squares   F-statistic:                 3.596e+04
Date:                Mon, 24 Jan 2022   Prob (F-statistic):               0.00
Time:                        14:20:50   Log-Likelihood:            -9.8108e+05
No. Observations:              252944   AIC:                         1.962e+06
Df Residuals:                  252939   BIC:                         1.962e+06
Df Model:                           4                                         
Covariance Type:            nonrobust                                         
==========================================================================================
                             coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------------------
Intercept                 27.3314      0.037    747.907      0.000      27.260      27.403
annual_premium          9.261e-07   1.36e-06      0.680      0.497   -1.74e-06     3.6e-06
policy_sales_channel      -0.1481      0.000   -330.880      0.000      -0.149      -0.147
vehicle_damage_No         12.0812      0.045    266.564      0.000      11.992      12.170
vehicle_damage_Yes        15.2503      0.045    339.196      0.000      15.162      15.338
previously_insured_No     14.5066      0.043    334.118      0.000      14.421      14.592
previously_insured_Yes    12.8249      0.047    272.830      0.000      12.733      12.917
==============================================================================
Omnibus:                    27342.642   Durbin-Watson:                   2.005
Prob(Omnibus):                  0.000   Jarque-Bera (JB):            38040.906
Skew:                           0.862   Prob(JB):                         0.00
Kurtosis:                       3.797   Cond. No.                     7.00e+18
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The smallest eigenvalue is 6.33e-24. This might indicate that there are
strong multicollinearity problems or that the design matrix is singular.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hier müssen wir die für die Regression verwendeten Variablen nochmal casten, um diese auch im Modell verwenden zu können</span>
<span class="n">X_train_age_missing</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">X_train_age_missing</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X_train_age_missing</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train_age_missing</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X_train_age_missing</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_train_age_missing</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Predicten </span>
<span class="n">predictions_age_train_data_ols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">res_train</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_age_missing</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
<span class="n">predictions_age_train_data_ols</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span>
<span class="n">predictions_age_train_data_ols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>204594</th>
      <td>33.92</td>
    </tr>
    <tr>
      <th>205811</th>
      <td>29.76</td>
    </tr>
    <tr>
      <th>210684</th>
      <td>31.74</td>
    </tr>
    <tr>
      <th>209565</th>
      <td>38.76</td>
    </tr>
    <tr>
      <th>208503</th>
      <td>53.29</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>201237</th>
      <td>38.75</td>
    </tr>
    <tr>
      <th>206751</th>
      <td>39.10</td>
    </tr>
    <tr>
      <th>205019</th>
      <td>33.90</td>
    </tr>
    <tr>
      <th>209509</th>
      <td>34.61</td>
    </tr>
    <tr>
      <th>203509</th>
      <td>38.75</td>
    </tr>
  </tbody>
</table>
<p>7577 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hier müssen wir die für die Regression verwendeten Variablen nochmal casten, um diese auch im Modell verwenden zu können</span>
<span class="n">X_test_age_missing</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">X_test_age_missing</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X_test_age_missing</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test_age_missing</span><span class="p">[</span><span class="s1">&#39;vintage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">X_test_age_missing</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_test_age_missing</span><span class="p">[</span><span class="s1">&#39;policy_sales_channel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Predicten </span>
<span class="n">predictions_age_test_data_ols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">res_test</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_age_missing</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
<span class="n">predictions_age_test_data_ols</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span>
<span class="n">predictions_age_test_data_ols</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>206088</th>
      <td>34.16</td>
    </tr>
    <tr>
      <th>207480</th>
      <td>53.27</td>
    </tr>
    <tr>
      <th>202831</th>
      <td>34.61</td>
    </tr>
    <tr>
      <th>209973</th>
      <td>33.42</td>
    </tr>
    <tr>
      <th>206356</th>
      <td>29.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>207734</th>
      <td>53.77</td>
    </tr>
    <tr>
      <th>208920</th>
      <td>29.76</td>
    </tr>
    <tr>
      <th>200971</th>
      <td>52.09</td>
    </tr>
    <tr>
      <th>208086</th>
      <td>28.55</td>
    </tr>
    <tr>
      <th>209968</th>
      <td>38.78</td>
    </tr>
  </tbody>
</table>
<p>3264 rows × 1 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Training-Batch</span>
<span class="n">X_train_df_regression</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">X_train_age_missing</span><span class="p">,</span> <span class="n">predictions_age_train_data_ols</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train_df_regression</span> <span class="o">=</span> <span class="n">X_train_df_regression</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">X_train_df_one_hot_encoded_data_without_gender</span><span class="p">)</span>

<span class="c1"># Training-Batch</span>
<span class="n">X_test_df_regression</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">X_test_age_missing</span><span class="p">,</span> <span class="n">predictions_age_test_data_ols</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test_df_regression</span> <span class="o">=</span> <span class="n">X_test_df_regression</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">X_test_df_one_hot_encoded_data_without_gender</span><span class="p">)</span>

<span class="n">X_train_df_regression</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>annual_premium</th>
      <th>driving_license_No</th>
      <th>driving_license_Yes</th>
      <th>gender</th>
      <th>policy_sales_channel</th>
      <th>previously_insured_No</th>
      <th>previously_insured_Yes</th>
      <th>region_code</th>
      <th>vehicle_age_1-2 Year</th>
      <th>vehicle_age_&lt; 1 Year</th>
      <th>vehicle_age_&gt; 2 Years</th>
      <th>vehicle_damage_No</th>
      <th>vehicle_damage_Yes</th>
      <th>vintage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>47.0</td>
      <td>38294</td>
      <td>1</td>
      <td>0</td>
      <td>Male</td>
      <td>26</td>
      <td>1</td>
      <td>0</td>
      <td>28.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29.0</td>
      <td>27496</td>
      <td>0</td>
      <td>1</td>
      <td>Female</td>
      <td>152</td>
      <td>0</td>
      <td>1</td>
      <td>41.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>39</td>
    </tr>
    <tr>
      <th>5</th>
      <td>24.0</td>
      <td>2630</td>
      <td>1</td>
      <td>0</td>
      <td>Female</td>
      <td>160</td>
      <td>1</td>
      <td>0</td>
      <td>33.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>176</td>
    </tr>
    <tr>
      <th>6</th>
      <td>23.0</td>
      <td>23367</td>
      <td>1</td>
      <td>0</td>
      <td>Male</td>
      <td>152</td>
      <td>1</td>
      <td>0</td>
      <td>11.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>249</td>
    </tr>
    <tr>
      <th>9</th>
      <td>32.0</td>
      <td>28771</td>
      <td>0</td>
      <td>1</td>
      <td>Female</td>
      <td>152</td>
      <td>0</td>
      <td>1</td>
      <td>6.0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>80</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>380991</th>
      <td>74.0</td>
      <td>32908</td>
      <td>1</td>
      <td>0</td>
      <td>Male</td>
      <td>26</td>
      <td>1</td>
      <td>0</td>
      <td>8.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>160</td>
    </tr>
    <tr>
      <th>380993</th>
      <td>63.0</td>
      <td>2630</td>
      <td>1</td>
      <td>0</td>
      <td>Male</td>
      <td>124</td>
      <td>1</td>
      <td>0</td>
      <td>28.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>380994</th>
      <td>46.0</td>
      <td>24758</td>
      <td>1</td>
      <td>0</td>
      <td>Male</td>
      <td>26</td>
      <td>1</td>
      <td>0</td>
      <td>28.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>139</td>
    </tr>
    <tr>
      <th>380995</th>
      <td>46.0</td>
      <td>51660</td>
      <td>1</td>
      <td>0</td>
      <td>Male</td>
      <td>124</td>
      <td>1</td>
      <td>0</td>
      <td>28.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>227</td>
    </tr>
    <tr>
      <th>380997</th>
      <td>34.0</td>
      <td>2630</td>
      <td>1</td>
      <td>0</td>
      <td>Female</td>
      <td>124</td>
      <td>1</td>
      <td>0</td>
      <td>41.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>208</td>
    </tr>
  </tbody>
</table>
<p>261207 rows × 15 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="visualisierung-der-imputationsverfahren-in-der-train-batch">
<h4>Visualisierung der Imputationsverfahren in der Train Batch<a class="headerlink" href="#visualisierung-der-imputationsverfahren-in-der-train-batch" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Datensätze erstellen</span>
<span class="n">hist_data_train</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train_df_regression</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train_df_mice</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train_df_knn</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train_mean</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train_median</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train_original_age</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)]</span>

<span class="c1"># Gruppennamen und Farben festlegen</span>
<span class="n">group_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;train_imputed_regression&#39;</span><span class="p">,</span> <span class="s1">&#39;train_imputed_mice_age&#39;</span><span class="p">,</span><span class="s1">&#39;train_imputed_knn_age&#39;</span><span class="p">,</span><span class="s1">&#39;train_imputed_mean_age&#39;</span><span class="p">,</span> <span class="s1">&#39;train_imputed_median_age&#39;</span><span class="p">,</span> <span class="s1">&#39;actual_df_age&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;#333F44&#39;</span><span class="p">,</span> <span class="s1">&#39;#37AA9C&#39;</span><span class="p">,</span> <span class="s1">&#39;#f3722c&#39;</span><span class="p">,</span> <span class="s1">&#39;#6a994e&#39;</span><span class="p">,</span> <span class="s1">&#39;#0077b6&#39;</span><span class="p">]</span>

<span class="c1"># Erstellen des Histogrammes </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">create_distplot</span><span class="p">(</span><span class="n">hist_data_train</span><span class="p">,</span> <span class="n">group_labels</span><span class="p">,</span> <span class="n">show_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">rug_text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_rug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.893</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">traceorder</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">,</span><span class="n">title_font_family</span><span class="o">=</span><span class="s2">&quot;Times New Roman&quot;</span><span class="p">,</span><span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;Courier&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span><span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;LightSteelBlue&quot;</span><span class="p">,</span><span class="n">bordercolor</span><span class="o">=</span><span class="s2">&quot;#fff&quot;</span><span class="p">,</span><span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Titel hinzufügen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s1">&#39;Verteilung der Variable age nach der Imputation in der Train Batch&#39;</span><span class="p">)</span>

<span class="c1"># Plot anzeigen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
</div>
<div class="section" id="visualisierung-der-imputationsverfahren-auf-der-test-batch">
<h3>Visualisierung der Imputationsverfahren auf der Test Batch<a class="headerlink" href="#visualisierung-der-imputationsverfahren-auf-der-test-batch" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Datensätze erstellen</span>
<span class="n">hist_data_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_train_df_regression</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_test_df_mice</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_test_df_knn</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_test_mean</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_test_median</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X_test_original_age</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)]</span>

<span class="c1"># Gruppennamen und Farben festlegen</span>
<span class="n">group_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;test_imputed_ols_age&#39;</span><span class="p">,</span><span class="s1">&#39;test_imputed_mice_age&#39;</span><span class="p">,</span><span class="s1">&#39;test_imputed_knn_age&#39;</span><span class="p">,</span><span class="s1">&#39;test_imputed_mean_age&#39;</span><span class="p">,</span> <span class="s1">&#39;test_imputed_median_age&#39;</span><span class="p">,</span> <span class="s1">&#39;actual_df_age&#39;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;#333F44&#39;</span><span class="p">,</span> <span class="s1">&#39;#37AA9C&#39;</span><span class="p">,</span> <span class="s1">&#39;#f3722c&#39;</span><span class="p">,</span> <span class="s1">&#39;#6a994e&#39;</span><span class="p">,</span> <span class="s1">&#39;#0077b6&#39;</span><span class="p">]</span>

<span class="c1"># Erstellen des Histogrammes </span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">create_distplot</span><span class="p">(</span><span class="n">hist_data_test</span><span class="p">,</span> <span class="n">group_labels</span><span class="p">,</span> <span class="n">show_hist</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">rug_text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_rug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.895</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">traceorder</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">,</span><span class="n">title_font_family</span><span class="o">=</span><span class="s2">&quot;Times New Roman&quot;</span><span class="p">,</span><span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;Courier&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">),</span><span class="n">bgcolor</span><span class="o">=</span><span class="s2">&quot;LightSteelBlue&quot;</span><span class="p">,</span><span class="n">bordercolor</span><span class="o">=</span><span class="s2">&quot;#fff&quot;</span><span class="p">,</span><span class="n">borderwidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># Titel hinzufügen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s1">&#39;Verteilung der Variable age nach der Imputation in der Test Batch&#39;</span><span class="p">)</span>

<span class="c1"># Plot anzeigen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="visualisierung-der-impuation-von-gender">
<h3>Visualisierung der Impuation von gender<a class="headerlink" href="#visualisierung-der-impuation-von-gender" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Before Imputation: </span><span class="se">\n</span><span class="si">{</span><span class="n">X_train_df</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;After KNN Imputation: </span><span class="se">\n</span><span class="si">{</span><span class="n">X_train_df_knn</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;After MICE Imputation: </span><span class="se">\n</span><span class="si">{</span><span class="n">X_train_df_mice</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Before Imputation: 
Male      0.540897
Female    0.459103
Name: gender, dtype: float64


After KNN Imputation: 
Male      0.540996
Female    0.459004
Name: gender, dtype: float64


After MICE Imputation: 
Male      0.540962
Female    0.459038
Name: gender, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Hier wenden wir die ONE-HOT Kodierung wieder auf <code class="docutils literal notranslate"><span class="pre">gender</span></code> an und entscheiden uns sowohl bei der Imputation von <code class="docutils literal notranslate"><span class="pre">age</span></code> als auch von <code class="docutils literal notranslate"><span class="pre">gender</span></code> für die Ergebnisse der Imputation vom <code class="docutils literal notranslate"><span class="pre">KNNImputer</span></code>, da diese der uprünglichen Verteilung in den jeweiligen Variablen am Nächsten sind.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_df_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_train_df_knn</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">])</span>

<span class="n">X_test_df_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_test_df_knn</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([73., 38., 34., 27., 29., 58., 22., 20., 68., 54., 25., 52., 71.,
       57., 50., 21., 36., 45., 44., 24., 72., 43., 39., 23., 40., 41.,
       47., 46., 28., 31., 30., 56., 53., 42., 26., 48., 63., 66., 69.,
       49., 37., 35., 55., 59., 32., 33., 60., 64., 61., 51., 70., 74.,
       67., 62., 65.])
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="sampling">
<h2>Sampling<a class="headerlink" href="#sampling" title="Permalink to this headline">¶</a></h2>
<div class="section" id="oversampling">
<h3>Oversampling<a class="headerlink" href="#oversampling" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_df_os</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_train_df_final</span> <span class="p">,</span> <span class="n">y_train_df</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">response_no</span> <span class="o">=</span> <span class="n">X_train_df_os</span><span class="p">[</span><span class="n">X_train_df_os</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">]</span>
<span class="n">response_yes</span> <span class="o">=</span> <span class="n">X_train_df_os</span><span class="p">[</span><span class="n">X_train_df_os</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">]</span>

<span class="c1"># upsample minority</span>
<span class="n">response_upsampled</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span><span class="n">response_yes</span><span class="p">,</span>
                          <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># sample with replacement</span>
                          <span class="n">n_samples</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">response_no</span><span class="p">),</span> <span class="c1"># match number in majority class</span>
                          <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># reproducible results</span>

<span class="c1"># combine majority and upsampled minority</span>
<span class="n">upsampled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">response_no</span><span class="p">,</span> <span class="n">response_upsampled</span><span class="p">])</span>

<span class="c1"># check new class counts</span>
<span class="n">upsampled</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>no     228997
yes    228997
Name: response, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_upsampled_response</span> <span class="o">=</span> <span class="n">upsampled</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;response&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df_upsampled_response</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;response&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">upsampled</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;response&#39;</span><span class="p">,</span>
                                    <span class="n">text</span><span class="o">=</span><span class="n">upsampled</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                                    <span class="n">color_discrete_map</span><span class="o">=</span><span class="p">{</span>
                                        <span class="s1">&#39;yes&#39;</span><span class="p">:</span> <span class="s1">&#39;rgb(18,116,117)&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;no&#39;</span><span class="p">:</span> <span class="s1">&#39;rgb(20,29,67)&#39;</span>
                                    <span class="p">})</span>

<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Relative Verteilung der Ausprägungen von Response nach dem Upsampling&#39;</span><span class="p">,</span>
                 <span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;Response&#39;</span><span class="p">,</span>
                 <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</div>
<div class="section" id="undersampling-mit-einem-einfachen-modell-evaluieren">
<h3>Undersampling mit einem einfachen Modell evaluieren<a class="headerlink" href="#undersampling-mit-einem-einfachen-modell-evaluieren" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">imblearn.under_sampling</span> <span class="kn">import</span> <span class="n">RandomUnderSampler</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="n">undersample</span> <span class="o">=</span> <span class="n">RandomUnderSampler</span><span class="p">(</span><span class="n">sampling_strategy</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>

<span class="c1"># Undersampling anwenden</span>
<span class="n">X_train_under</span><span class="p">,</span> <span class="n">y_train_under</span> <span class="o">=</span> <span class="n">undersample</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train_df_final</span><span class="p">,</span> <span class="n">y_train_label_encoded</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">])</span>
<span class="n">X_test_under</span><span class="p">,</span> <span class="n">y_test_under</span> <span class="o">=</span> <span class="n">undersample</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_test_df_final</span><span class="p">,</span> <span class="n">y_test_label_encoded</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">])</span>

<span class="c1"># Verteilung von train</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before undersampling train: &quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_train_label_encoded</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After undersampling train: &quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_train_under</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="c1"># Verteilung von test</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before undersampling test: &quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_test_label_encoded</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After undersampling test: &quot;</span><span class="p">,</span> <span class="n">Counter</span><span class="p">(</span><span class="n">y_test_under</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Before undersampling train:  Counter({0: 228997, 1: 32210})
After undersampling train:  Counter({0: 32210, 1: 32210})
------------------------------------------------------------
Before undersampling test:  Counter({0: 98002, 1: 13945})
After undersampling test:  Counter({0: 13945, 1: 13945})
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="oversampling-w-smote">
<h3>Oversampling \w SMOTE<a class="headerlink" href="#oversampling-w-smote" title="Permalink to this headline">¶</a></h3>
<p>SMOTE (Synthetic Minority Oversampling Technique) besteht darin, Elemente für die minority class zu synthetisieren, die auf den bereits vorhandenen Elementen basieren. Dabei wird nach dem Zufallsprinzip eine Zeile aus der minority class ausgewählt und die k-nearest neighbors für dessen Daten berechnet. Die synthetischen Daten werden zwischen dem ausgewählten Zeile und deren Nachbarn eingefügt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_SMOTE_cross</span> <span class="o">=</span> <span class="n">X_train_df_final</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;Int64&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;raise&#39;</span><span class="p">)</span>
<span class="n">X_train_SMOTE_cross</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 261207 entries, 0 to 261206
Data columns (total 16 columns):
 #   Column                  Non-Null Count   Dtype
---  ------                  --------------   -----
 0   age                     261207 non-null  Int64
 1   region_code             261207 non-null  Int64
 2   annual_premium          261207 non-null  Int64
 3   policy_sales_channel    261207 non-null  Int64
 4   vintage                 261207 non-null  Int64
 5   driving_license_No      261207 non-null  Int64
 6   driving_license_Yes     261207 non-null  Int64
 7   vehicle_age_1-2 Year    261207 non-null  Int64
 8   vehicle_age_&lt; 1 Year    261207 non-null  Int64
 9   vehicle_age_&gt; 2 Years   261207 non-null  Int64
 10  vehicle_damage_No       261207 non-null  Int64
 11  vehicle_damage_Yes      261207 non-null  Int64
 12  previously_insured_No   261207 non-null  Int64
 13  previously_insured_Yes  261207 non-null  Int64
 14  gender_Female           261207 non-null  Int64
 15  gender_Male             261207 non-null  Int64
dtypes: Int64(16)
memory usage: 35.9 MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pipeline für die Crossvalidierung</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">imbpipeline</span><span class="p">(</span><span class="n">steps</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;smote&#39;</span><span class="p">,</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">sampling_strategy</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span> <span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)],</span>
                                <span class="p">[</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">MinMaxScaler</span><span class="p">()],</span>
                                <span class="p">[</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                                                                  <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)]])</span>

<span class="c1"># Splitting des Datensatzes</span>
<span class="n">stratified_kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                       <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Grid Search mit Parametertuning durchführen</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;classifier__C&#39;</span><span class="p">:[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]}</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">pipeline</span><span class="p">,</span>
                           <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
                           <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
                           <span class="n">cv</span><span class="o">=</span><span class="n">stratified_kfold</span><span class="p">,</span>
                           <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>


<span class="c1"># Modell fitten</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_df_final</span><span class="p">,</span> <span class="n">y_train_df</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">])</span>

<span class="c1"># Besten Paramter ausgeben</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="c1"># Modell testen</span>
<span class="n">cv_score</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span>
<span class="n">test_score</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_df_final</span><span class="p">,</span> <span class="n">y_test_df</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cross-validation score: </span><span class="si">{</span><span class="n">cv_score</span><span class="si">}</span><span class="se">\n</span><span class="s1">Test score: </span><span class="si">{</span><span class="n">test_score</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;classifier__C&#39;: 100}
Cross-validation score: 0.8328181788821624
Test score: 0.8335114000095518
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">()</span>

<span class="c1"># Oversampling durchführen</span>
<span class="n">X_train_SMOTE</span><span class="p">,</span> <span class="n">y_train_SMOTE</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train_df_final</span><span class="p">,</span> <span class="n">y_train_label_encoded</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">])</span>
<span class="n">X_test_SMOTE</span><span class="p">,</span> <span class="n">y_test_SMOTE</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_test_df_final</span><span class="p">,</span> <span class="n">y_test_label_encoded</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="entscheidung-fur-over-oder-undersampling">
<h3>Entscheidung für Over- oder Undersampling<a class="headerlink" href="#entscheidung-fur-over-oder-undersampling" title="Permalink to this headline">¶</a></h3>
<p>Um uns für ein Samplingverfahren zu entscheiden, wenden wir bei beiden Verfahren einen unangepassten <code class="docutils literal notranslate"><span class="pre">Random</span> <span class="pre">Forest</span> <span class="pre">Classifier</span></code> an, um uns anhand der Modellgüte einen Eindruck zu verschaffen, ob das Over - bzw. Undersampling an Over - oder Underfitting leidet und wie gut bzw. schlecht die Perfomance der Datensätze, auf Grundlage der beiden Samplingverfahren ist.</p>
<p>Oversampling</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">roc_curve</span>

<span class="c1"># Modell für den Random Forest instanzieren</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Modell fitten</span>
<span class="n">rfc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_SMOTE</span><span class="p">,</span> <span class="n">y_train_SMOTE</span><span class="p">)</span>

<span class="c1"># absolute und relative Vorhersagen</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_SMOTE</span><span class="p">)</span>
<span class="n">resa</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_SMOTE</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># False Positive, True Postive Rate bestimmen</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test_SMOTE</span><span class="p">,</span> <span class="n">resa</span><span class="p">)</span>

<span class="c1"># Fläche unter der False Positive, True Postive Rate berechnen</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test_SMOTE</span><span class="p">,</span> <span class="n">resa</span><span class="p">)</span>

<span class="c1"># Area Plot erstellen</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">area</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">fpr</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">tpr</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC-Curve (AUC=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">),</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span>
<span class="p">)</span>

<span class="c1"># Linie des Zufallsmodelles einfügen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">),</span>
    <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># Skalierung anpassen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">constrain</span><span class="o">=</span><span class="s1">&#39;domain&#39;</span><span class="p">)</span>

<span class="c1"># Plot anzeigen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Undersampling</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Modell für den Random Forest instanzieren</span>
<span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Modell fitten</span>
<span class="n">rfc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_under</span><span class="p">,</span> <span class="n">y_train_under</span><span class="p">)</span>

<span class="c1"># absolute und relative Vorhersagen</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_under</span><span class="p">)</span>
<span class="n">resa</span> <span class="o">=</span> <span class="n">rfc</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_under</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># False Positive, True Postive Rate bestimmen</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test_under</span><span class="p">,</span> <span class="n">resa</span><span class="p">)</span>

<span class="c1"># Fläche unter der False Positive, True Postive Rate berechnen</span>
<span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test_under</span><span class="p">,</span> <span class="n">resa</span><span class="p">)</span>

<span class="c1"># Area Plot erstellen</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">area</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">fpr</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">tpr</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC-Curve (AUC=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">),</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span>
<span class="p">)</span>

<span class="c1"># Linie des Zufallsmodelles einfügen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">),</span>
    <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># Skalierung anpassen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">constrain</span><span class="o">=</span><span class="s1">&#39;domain&#39;</span><span class="p">)</span>

<span class="c1"># Plot anzeigen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Aufgrund des sehr hohen ROC AUC beim Oversampling, gehen wir davon aus, dass unser synthetisches Oversampling mittels <code class="docutils literal notranslate"><span class="pre">SMOTE</span></code> starkes Overfitting aufweist. Wahrscheinlich würde der <code class="docutils literal notranslate"><span class="pre">RandomOverSampler</span></code> weniger abhängige Werte erzeugen, da wir allerings beim Undersampling auch einen hohen ROC AUC berechnen konnten, entscheiden wir uns lieber für den Verlust an Daten, als den Informationsausstausch beim Oversampling.</p>
</div>
</div>
<div class="section" id="feature-engineering">
<h2>Feature Engineering<a class="headerlink" href="#feature-engineering" title="Permalink to this headline">¶</a></h2>
<p>Da wir vorwiegend kategoriale Variablen im Datensatz vorfinden, sehen wir die Möglichkeit der Generierung von neuen Features als eingeschränkt an. Wir kombinieren lediglich die metrischen Varialen <code class="docutils literal notranslate"><span class="pre">annual_premium</span></code> und <code class="docutils literal notranslate"><span class="pre">vintage</span></code> zu neuen Variablen und nehmen ein Binning bei <code class="docutils literal notranslate"><span class="pre">age</span></code> vor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">feature_engine.creation</span> <span class="kn">import</span> <span class="n">MathematicalCombination</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">QuantileTransformer</span><span class="p">,</span> <span class="n">StandardScaler</span>
</pre></div>
</div>
</div>
</div>
<p>arithmetische Kombination aus den metrischen Variablen <code class="docutils literal notranslate"><span class="pre">annual_premium</span></code> und <code class="docutils literal notranslate"><span class="pre">vintage</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combinator</span> <span class="o">=</span> <span class="n">MathematicalCombination</span><span class="p">(</span>
    <span class="n">variables_to_combine</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">,</span> <span class="s1">&#39;vintage&#39;</span><span class="p">],</span>
    <span class="n">math_operations</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;prod&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">],</span>
    <span class="n">new_variables_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean_annual_vintage&#39;</span><span class="p">,</span> <span class="s1">&#39;prod_annual_vintage&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_annual_vintage&#39;</span><span class="p">,</span> <span class="s1">&#39;std_annual_vintage&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">X_train_df_fe</span> <span class="o">=</span> <span class="n">combinator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_df_final</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">X_test_df_fe</span> <span class="o">=</span> <span class="n">combinator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test_df_final</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="n">X_train_df_fe</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">,</span> <span class="s1">&#39;vintage&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_annual_vintage&#39;</span><span class="p">,</span> <span class="s1">&#39;prod_annual_vintage&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_annual_vintage&#39;</span><span class="p">,</span> <span class="s1">&#39;std_annual_vintage&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>annual_premium</th>
      <th>vintage</th>
      <th>mean_annual_vintage</th>
      <th>prod_annual_vintage</th>
      <th>sum_annual_vintage</th>
      <th>std_annual_vintage</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>44620.0</td>
      <td>190.0</td>
      <td>22405.0</td>
      <td>8477800.0</td>
      <td>44810.0</td>
      <td>31416.754288</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2630.0</td>
      <td>280.0</td>
      <td>1455.0</td>
      <td>736400.0</td>
      <td>2910.0</td>
      <td>1661.700936</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22486.0</td>
      <td>43.0</td>
      <td>11264.5</td>
      <td>966898.0</td>
      <td>22529.0</td>
      <td>15869.597490</td>
    </tr>
    <tr>
      <th>3</th>
      <td>25739.0</td>
      <td>297.0</td>
      <td>13018.0</td>
      <td>7644483.0</td>
      <td>26036.0</td>
      <td>17990.210727</td>
    </tr>
    <tr>
      <th>4</th>
      <td>30764.0</td>
      <td>48.0</td>
      <td>15406.0</td>
      <td>1476672.0</td>
      <td>30812.0</td>
      <td>21719.491891</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Binning bei der Variable <code class="docutils literal notranslate"><span class="pre">age</span></code> erstellen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;age_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;20-40&#39;</span><span class="p">,</span><span class="s1">&#39;40-60&#39;</span><span class="p">,</span><span class="s1">&#39;60-80&#39;</span><span class="p">,</span><span class="s1">&#39;80-100&#39;</span><span class="p">])</span>
<span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;age_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;20-40&#39;</span><span class="p">,</span><span class="s1">&#39;40-60&#39;</span><span class="p">,</span><span class="s1">&#39;60-80&#39;</span><span class="p">,</span><span class="s1">&#39;80-100&#39;</span><span class="p">])</span>

<span class="n">LE</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>

<span class="c1"># Kategoriale Ausprägung von age_bin in numerische Katgorien umwandeln -&gt; Korrelation, Modelling</span>
<span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;age_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;age_bin&#39;</span><span class="p">])</span>
<span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;age_bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LE</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;age_bin&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Standard scaling removes mean and scale data to unit variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">standart_scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_scaled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">standart_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_df_fe</span><span class="p">[[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]])</span>
<span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_scaled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">standart_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test_df_fe</span><span class="p">[[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]])</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train-Batch&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_scaled&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard Deviation:&#39;</span><span class="p">,</span> <span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_scaled&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test-Batch&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_scaled&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard Deviation:&#39;</span><span class="p">,</span> <span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_scaled&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train-Batch
Mean: -1.2132219280073072e-17
Standard Deviation: 1.0000019141961571
Test-Batch
Mean: -7.527702257420734e-17
Standard Deviation: 1.0000044664292016
</pre></div>
</div>
</div>
</div>
<p>Min Max Skalierung - skaliert alle Ausprägungen auf Werte zwischen 0 und 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">minmax_scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>

<span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_min_max_scaled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minmax_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_df_fe</span><span class="p">[[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]])</span>
<span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_min_max_scaled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minmax_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test_df_fe</span><span class="p">[[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train-Batch&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_min_max_scaled&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard Deviation:&#39;</span><span class="p">,</span> <span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_min_max_scaled&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test-Batch&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_min_max_scaled&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard Deviation:&#39;</span><span class="p">,</span> <span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_min_max_scaled&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train-Batch
Mean: 0.0518642232659577
Standard Deviation: 0.031986064385974664
Test-Batch
Mean: 0.0518642232659577
Standard Deviation: 0.031986064385974664
</pre></div>
</div>
</div>
</div>
<p>Quantil Transformation - uniforme Verteilung in der Variable</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qtrans</span> <span class="o">=</span> <span class="n">QuantileTransformer</span><span class="p">()</span>

<span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_uniform&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtrans</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_df_fe</span><span class="p">[[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]])</span>
<span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_uniform&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtrans</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test_df_fe</span><span class="p">[[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train-Batch&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_uniform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard Deviation:&#39;</span><span class="p">,</span> <span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_uniform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test-Batch&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_uniform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard Deviation:&#39;</span><span class="p">,</span> <span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_uniform&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train-Batch
Mean: 0.48491554777431445
Standard Deviation: 0.30965228679198414
Test-Batch
Mean: 0.48519349425765373
Standard Deviation: 0.31001016651123997
</pre></div>
</div>
</div>
</div>
<p>Quantil Transformation - normale Verteilung in der Variable</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qtrans_normal</span> <span class="o">=</span> <span class="n">QuantileTransformer</span><span class="p">(</span><span class="n">output_distribution</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_normal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtrans_normal</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_df_fe</span><span class="p">[[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]])</span>
<span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_normal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">qtrans_normal</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test_df_fe</span><span class="p">[[</span><span class="s1">&#39;annual_premium&#39;</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train-Batch&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_normal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard Deviation:&#39;</span><span class="p">,</span> <span class="n">X_train_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_normal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test-Batch&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_normal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Standard Deviation:&#39;</span><span class="p">,</span> <span class="n">X_test_df_fe</span><span class="p">[</span><span class="s1">&#39;annual_premium_q_trans_normal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Train-Batch
Mean: -0.6329820229598511
Standard Deviation: 2.1858256477000153
Test-Batch
Mean: -0.6353111667377621
Standard Deviation: 2.195035813305953
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Korrelationsplot erstellen</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">X_train_df_fe</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">corr</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="p">(</span><span class="n">corr</span>
 <span class="o">.</span><span class="n">style</span>
 <span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;crest&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
 <span class="o">.</span><span class="n">highlight_null</span><span class="p">(</span><span class="n">null_color</span><span class="o">=</span><span class="s1">&#39;#f1f1f1&#39;</span><span class="p">)</span>  <span class="c1"># Color NaNs grey</span>
 <span class="o">.</span><span class="n">set_precision</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\aster\AppData\Local\Temp/ipykernel_18368/3001735163.py:6: FutureWarning:

this method is deprecated in favour of `Styler.format(precision=..)`
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_37b8f_row0_col0, #T_37b8f_row0_col1, #T_37b8f_row0_col2, #T_37b8f_row0_col3, #T_37b8f_row0_col4, #T_37b8f_row0_col5, #T_37b8f_row0_col6, #T_37b8f_row0_col7, #T_37b8f_row0_col8, #T_37b8f_row0_col9, #T_37b8f_row0_col10, #T_37b8f_row0_col11, #T_37b8f_row0_col12, #T_37b8f_row0_col13, #T_37b8f_row0_col14, #T_37b8f_row0_col15, #T_37b8f_row0_col16, #T_37b8f_row0_col17, #T_37b8f_row0_col18, #T_37b8f_row0_col19, #T_37b8f_row0_col20, #T_37b8f_row0_col21, #T_37b8f_row0_col22, #T_37b8f_row0_col23, #T_37b8f_row0_col24, #T_37b8f_row1_col1, #T_37b8f_row1_col2, #T_37b8f_row1_col3, #T_37b8f_row1_col4, #T_37b8f_row1_col5, #T_37b8f_row1_col6, #T_37b8f_row1_col7, #T_37b8f_row1_col8, #T_37b8f_row1_col9, #T_37b8f_row1_col10, #T_37b8f_row1_col11, #T_37b8f_row1_col12, #T_37b8f_row1_col13, #T_37b8f_row1_col14, #T_37b8f_row1_col15, #T_37b8f_row1_col16, #T_37b8f_row1_col17, #T_37b8f_row1_col18, #T_37b8f_row1_col19, #T_37b8f_row1_col20, #T_37b8f_row1_col21, #T_37b8f_row1_col22, #T_37b8f_row1_col23, #T_37b8f_row1_col24, #T_37b8f_row2_col2, #T_37b8f_row2_col3, #T_37b8f_row2_col4, #T_37b8f_row2_col5, #T_37b8f_row2_col6, #T_37b8f_row2_col7, #T_37b8f_row2_col8, #T_37b8f_row2_col9, #T_37b8f_row2_col10, #T_37b8f_row2_col11, #T_37b8f_row2_col12, #T_37b8f_row2_col13, #T_37b8f_row2_col14, #T_37b8f_row2_col15, #T_37b8f_row2_col16, #T_37b8f_row2_col17, #T_37b8f_row2_col18, #T_37b8f_row2_col19, #T_37b8f_row2_col20, #T_37b8f_row2_col21, #T_37b8f_row2_col22, #T_37b8f_row2_col23, #T_37b8f_row2_col24, #T_37b8f_row3_col3, #T_37b8f_row3_col4, #T_37b8f_row3_col5, #T_37b8f_row3_col6, #T_37b8f_row3_col7, #T_37b8f_row3_col8, #T_37b8f_row3_col9, #T_37b8f_row3_col10, #T_37b8f_row3_col11, #T_37b8f_row3_col12, #T_37b8f_row3_col13, #T_37b8f_row3_col14, #T_37b8f_row3_col15, #T_37b8f_row3_col16, #T_37b8f_row3_col17, #T_37b8f_row3_col18, #T_37b8f_row3_col19, #T_37b8f_row3_col20, #T_37b8f_row3_col21, #T_37b8f_row3_col22, #T_37b8f_row3_col23, #T_37b8f_row3_col24, #T_37b8f_row4_col4, #T_37b8f_row4_col5, #T_37b8f_row4_col6, #T_37b8f_row4_col7, #T_37b8f_row4_col8, #T_37b8f_row4_col9, #T_37b8f_row4_col10, #T_37b8f_row4_col11, #T_37b8f_row4_col12, #T_37b8f_row4_col13, #T_37b8f_row4_col14, #T_37b8f_row4_col15, #T_37b8f_row4_col16, #T_37b8f_row4_col17, #T_37b8f_row4_col18, #T_37b8f_row4_col19, #T_37b8f_row4_col20, #T_37b8f_row4_col21, #T_37b8f_row4_col22, #T_37b8f_row4_col23, #T_37b8f_row4_col24, #T_37b8f_row5_col5, #T_37b8f_row5_col6, #T_37b8f_row5_col7, #T_37b8f_row5_col8, #T_37b8f_row5_col9, #T_37b8f_row5_col10, #T_37b8f_row5_col11, #T_37b8f_row5_col12, #T_37b8f_row5_col13, #T_37b8f_row5_col14, #T_37b8f_row5_col15, #T_37b8f_row5_col16, #T_37b8f_row5_col17, #T_37b8f_row5_col18, #T_37b8f_row5_col19, #T_37b8f_row5_col20, #T_37b8f_row5_col21, #T_37b8f_row5_col22, #T_37b8f_row5_col23, #T_37b8f_row5_col24, #T_37b8f_row6_col6, #T_37b8f_row6_col7, #T_37b8f_row6_col8, #T_37b8f_row6_col9, #T_37b8f_row6_col10, #T_37b8f_row6_col11, #T_37b8f_row6_col12, #T_37b8f_row6_col13, #T_37b8f_row6_col14, #T_37b8f_row6_col15, #T_37b8f_row6_col16, #T_37b8f_row6_col17, #T_37b8f_row6_col18, #T_37b8f_row6_col19, #T_37b8f_row6_col20, #T_37b8f_row6_col21, #T_37b8f_row6_col22, #T_37b8f_row6_col23, #T_37b8f_row6_col24, #T_37b8f_row7_col7, #T_37b8f_row7_col8, #T_37b8f_row7_col9, #T_37b8f_row7_col10, #T_37b8f_row7_col11, #T_37b8f_row7_col12, #T_37b8f_row7_col13, #T_37b8f_row7_col14, #T_37b8f_row7_col15, #T_37b8f_row7_col16, #T_37b8f_row7_col17, #T_37b8f_row7_col18, #T_37b8f_row7_col19, #T_37b8f_row7_col20, #T_37b8f_row7_col21, #T_37b8f_row7_col22, #T_37b8f_row7_col23, #T_37b8f_row7_col24, #T_37b8f_row8_col8, #T_37b8f_row8_col9, #T_37b8f_row8_col10, #T_37b8f_row8_col11, #T_37b8f_row8_col12, #T_37b8f_row8_col13, #T_37b8f_row8_col14, #T_37b8f_row8_col15, #T_37b8f_row8_col16, #T_37b8f_row8_col17, #T_37b8f_row8_col18, #T_37b8f_row8_col19, #T_37b8f_row8_col20, #T_37b8f_row8_col21, #T_37b8f_row8_col22, #T_37b8f_row8_col23, #T_37b8f_row8_col24, #T_37b8f_row9_col9, #T_37b8f_row9_col10, #T_37b8f_row9_col11, #T_37b8f_row9_col12, #T_37b8f_row9_col13, #T_37b8f_row9_col14, #T_37b8f_row9_col15, #T_37b8f_row9_col16, #T_37b8f_row9_col17, #T_37b8f_row9_col18, #T_37b8f_row9_col19, #T_37b8f_row9_col20, #T_37b8f_row9_col21, #T_37b8f_row9_col22, #T_37b8f_row9_col23, #T_37b8f_row9_col24, #T_37b8f_row10_col10, #T_37b8f_row10_col11, #T_37b8f_row10_col12, #T_37b8f_row10_col13, #T_37b8f_row10_col14, #T_37b8f_row10_col15, #T_37b8f_row10_col16, #T_37b8f_row10_col17, #T_37b8f_row10_col18, #T_37b8f_row10_col19, #T_37b8f_row10_col20, #T_37b8f_row10_col21, #T_37b8f_row10_col22, #T_37b8f_row10_col23, #T_37b8f_row10_col24, #T_37b8f_row11_col11, #T_37b8f_row11_col12, #T_37b8f_row11_col13, #T_37b8f_row11_col14, #T_37b8f_row11_col15, #T_37b8f_row11_col16, #T_37b8f_row11_col17, #T_37b8f_row11_col18, #T_37b8f_row11_col19, #T_37b8f_row11_col20, #T_37b8f_row11_col21, #T_37b8f_row11_col22, #T_37b8f_row11_col23, #T_37b8f_row11_col24, #T_37b8f_row12_col12, #T_37b8f_row12_col13, #T_37b8f_row12_col14, #T_37b8f_row12_col15, #T_37b8f_row12_col16, #T_37b8f_row12_col17, #T_37b8f_row12_col18, #T_37b8f_row12_col19, #T_37b8f_row12_col20, #T_37b8f_row12_col21, #T_37b8f_row12_col22, #T_37b8f_row12_col23, #T_37b8f_row12_col24, #T_37b8f_row13_col13, #T_37b8f_row13_col14, #T_37b8f_row13_col15, #T_37b8f_row13_col16, #T_37b8f_row13_col17, #T_37b8f_row13_col18, #T_37b8f_row13_col19, #T_37b8f_row13_col20, #T_37b8f_row13_col21, #T_37b8f_row13_col22, #T_37b8f_row13_col23, #T_37b8f_row13_col24, #T_37b8f_row14_col14, #T_37b8f_row14_col15, #T_37b8f_row14_col16, #T_37b8f_row14_col17, #T_37b8f_row14_col18, #T_37b8f_row14_col19, #T_37b8f_row14_col20, #T_37b8f_row14_col21, #T_37b8f_row14_col22, #T_37b8f_row14_col23, #T_37b8f_row14_col24, #T_37b8f_row15_col15, #T_37b8f_row15_col16, #T_37b8f_row15_col17, #T_37b8f_row15_col18, #T_37b8f_row15_col19, #T_37b8f_row15_col20, #T_37b8f_row15_col21, #T_37b8f_row15_col22, #T_37b8f_row15_col23, #T_37b8f_row15_col24, #T_37b8f_row16_col16, #T_37b8f_row16_col17, #T_37b8f_row16_col18, #T_37b8f_row16_col19, #T_37b8f_row16_col20, #T_37b8f_row16_col21, #T_37b8f_row16_col22, #T_37b8f_row16_col23, #T_37b8f_row16_col24, #T_37b8f_row17_col17, #T_37b8f_row17_col18, #T_37b8f_row17_col19, #T_37b8f_row17_col20, #T_37b8f_row17_col21, #T_37b8f_row17_col22, #T_37b8f_row17_col23, #T_37b8f_row17_col24, #T_37b8f_row18_col18, #T_37b8f_row18_col19, #T_37b8f_row18_col20, #T_37b8f_row18_col21, #T_37b8f_row18_col22, #T_37b8f_row18_col23, #T_37b8f_row18_col24, #T_37b8f_row19_col19, #T_37b8f_row19_col20, #T_37b8f_row19_col21, #T_37b8f_row19_col22, #T_37b8f_row19_col23, #T_37b8f_row19_col24, #T_37b8f_row20_col20, #T_37b8f_row20_col21, #T_37b8f_row20_col22, #T_37b8f_row20_col23, #T_37b8f_row20_col24, #T_37b8f_row21_col21, #T_37b8f_row21_col22, #T_37b8f_row21_col23, #T_37b8f_row21_col24, #T_37b8f_row22_col22, #T_37b8f_row22_col23, #T_37b8f_row22_col24, #T_37b8f_row23_col23, #T_37b8f_row23_col24, #T_37b8f_row24_col24 {
  background-color: #000000;
  color: #f1f1f1;
  background-color: #f1f1f1;
}
#T_37b8f_row1_col0, #T_37b8f_row15_col9, #T_37b8f_row17_col0, #T_37b8f_row17_col9, #T_37b8f_row24_col8 {
  background-color: #30828d;
  color: #f1f1f1;
}
#T_37b8f_row2_col0, #T_37b8f_row9_col2, #T_37b8f_row16_col0, #T_37b8f_row16_col9, #T_37b8f_row18_col0, #T_37b8f_row18_col9, #T_37b8f_row19_col0, #T_37b8f_row19_col9, #T_37b8f_row21_col0, #T_37b8f_row21_col9, #T_37b8f_row22_col0, #T_37b8f_row22_col9 {
  background-color: #2e808d;
  color: #f1f1f1;
}
#T_37b8f_row2_col1, #T_37b8f_row10_col2, #T_37b8f_row16_col1, #T_37b8f_row16_col10, #T_37b8f_row17_col1, #T_37b8f_row17_col8, #T_37b8f_row18_col1, #T_37b8f_row18_col10, #T_37b8f_row19_col1, #T_37b8f_row19_col10, #T_37b8f_row21_col1, #T_37b8f_row21_col10, #T_37b8f_row22_col1, #T_37b8f_row22_col10, #T_37b8f_row23_col1, #T_37b8f_row23_col14, #T_37b8f_row24_col15 {
  background-color: #35868d;
  color: #f1f1f1;
}
#T_37b8f_row3_col0 {
  background-color: #6bb190;
  color: #f1f1f1;
}
#T_37b8f_row3_col1, #T_37b8f_row8_col1, #T_37b8f_row14_col9 {
  background-color: #37888e;
  color: #f1f1f1;
}
#T_37b8f_row3_col2, #T_37b8f_row15_col3, #T_37b8f_row16_col3, #T_37b8f_row18_col3, #T_37b8f_row19_col3, #T_37b8f_row21_col3, #T_37b8f_row22_col3 {
  background-color: #3d8e8e;
  color: #f1f1f1;
}
#T_37b8f_row4_col0, #T_37b8f_row6_col2, #T_37b8f_row6_col4, #T_37b8f_row8_col4, #T_37b8f_row11_col4, #T_37b8f_row13_col2, #T_37b8f_row13_col4, #T_37b8f_row14_col4, #T_37b8f_row15_col1, #T_37b8f_row15_col2, #T_37b8f_row16_col4, #T_37b8f_row16_col6, #T_37b8f_row16_col13, #T_37b8f_row16_col15, #T_37b8f_row17_col6, #T_37b8f_row17_col11, #T_37b8f_row17_col13, #T_37b8f_row17_col15, #T_37b8f_row18_col4, #T_37b8f_row18_col6, #T_37b8f_row18_col13, #T_37b8f_row18_col15, #T_37b8f_row19_col6, #T_37b8f_row19_col13, #T_37b8f_row19_col15, #T_37b8f_row20_col4, #T_37b8f_row21_col6, #T_37b8f_row21_col13, #T_37b8f_row21_col15, #T_37b8f_row22_col6, #T_37b8f_row22_col13, #T_37b8f_row22_col15 {
  background-color: #33858d;
  color: #f1f1f1;
}
#T_37b8f_row4_col1, #T_37b8f_row4_col2, #T_37b8f_row4_col3, #T_37b8f_row5_col2, #T_37b8f_row5_col4, #T_37b8f_row7_col2, #T_37b8f_row7_col4, #T_37b8f_row9_col4, #T_37b8f_row10_col4, #T_37b8f_row12_col2, #T_37b8f_row12_col4, #T_37b8f_row14_col1, #T_37b8f_row14_col2, #T_37b8f_row15_col4, #T_37b8f_row16_col5, #T_37b8f_row16_col7, #T_37b8f_row16_col12, #T_37b8f_row16_col14, #T_37b8f_row17_col5, #T_37b8f_row17_col7, #T_37b8f_row17_col10, #T_37b8f_row17_col12, #T_37b8f_row17_col14, #T_37b8f_row18_col5, #T_37b8f_row18_col7, #T_37b8f_row18_col12, #T_37b8f_row18_col14, #T_37b8f_row19_col4, #T_37b8f_row19_col5, #T_37b8f_row19_col7, #T_37b8f_row19_col12, #T_37b8f_row19_col14, #T_37b8f_row21_col4, #T_37b8f_row21_col5, #T_37b8f_row21_col7, #T_37b8f_row21_col12, #T_37b8f_row21_col14, #T_37b8f_row22_col4, #T_37b8f_row22_col5, #T_37b8f_row22_col7, #T_37b8f_row22_col12, #T_37b8f_row22_col14, #T_37b8f_row23_col4, #T_37b8f_row24_col0, #T_37b8f_row24_col1, #T_37b8f_row24_col4 {
  background-color: #34858d;
  color: #f1f1f1;
}
#T_37b8f_row5_col0, #T_37b8f_row12_col0 {
  background-color: #20718b;
  color: #f1f1f1;
}
#T_37b8f_row5_col1, #T_37b8f_row11_col1, #T_37b8f_row12_col1 {
  background-color: #31838d;
  color: #f1f1f1;
}
#T_37b8f_row5_col3, #T_37b8f_row12_col3 {
  background-color: #46968f;
  color: #f1f1f1;
}
#T_37b8f_row6_col0, #T_37b8f_row13_col0 {
  background-color: #4a9a8f;
  color: #f1f1f1;
}
#T_37b8f_row6_col1, #T_37b8f_row10_col1, #T_37b8f_row13_col1 {
  background-color: #36878d;
  color: #f1f1f1;
}
#T_37b8f_row6_col3, #T_37b8f_row9_col0, #T_37b8f_row10_col3, #T_37b8f_row13_col3, #T_37b8f_row20_col5, #T_37b8f_row20_col12 {
  background-color: #22748b;
  color: #f1f1f1;
}
#T_37b8f_row6_col5, #T_37b8f_row11_col10, #T_37b8f_row12_col6, #T_37b8f_row13_col5, #T_37b8f_row13_col12, #T_37b8f_row15_col14 {
  background-color: #a5cd90;
  color: #000000;
}
#T_37b8f_row7_col0 {
  background-color: #254c7f;
  color: #f1f1f1;
}
#T_37b8f_row7_col1, #T_37b8f_row20_col1, #T_37b8f_row23_col11, #T_37b8f_row24_col9, #T_37b8f_row24_col10 {
  background-color: #31828d;
  color: #f1f1f1;
}
#T_37b8f_row7_col3 {
  background-color: #62ac90;
  color: #f1f1f1;
}
#T_37b8f_row7_col5, #T_37b8f_row12_col7 {
  background-color: #1f6f8a;
  color: #f1f1f1;
}
#T_37b8f_row7_col6, #T_37b8f_row13_col7 {
  background-color: #4b9b90;
  color: #f1f1f1;
}
#T_37b8f_row8_col0 {
  background-color: #89bf91;
  color: #000000;
}
#T_37b8f_row8_col2, #T_37b8f_row16_col8, #T_37b8f_row18_col8, #T_37b8f_row19_col8, #T_37b8f_row21_col8, #T_37b8f_row22_col8, #T_37b8f_row23_col6, #T_37b8f_row23_col13 {
  background-color: #35878d;
  color: #f1f1f1;
}
#T_37b8f_row8_col3 {
  background-color: #205784;
  color: #f1f1f1;
}
#T_37b8f_row8_col5, #T_37b8f_row11_col8, #T_37b8f_row12_col8 {
  background-color: #53a190;
  color: #f1f1f1;
}
#T_37b8f_row8_col6, #T_37b8f_row13_col8 {
  background-color: #1c6989;
  color: #f1f1f1;
}
#T_37b8f_row8_col7 {
  background-color: #9ac791;
  color: #000000;
}
#T_37b8f_row9_col1, #T_37b8f_row11_col2, #T_37b8f_row16_col11, #T_37b8f_row18_col11, #T_37b8f_row19_col11, #T_37b8f_row21_col11, #T_37b8f_row22_col11, #T_37b8f_row23_col15, #T_37b8f_row24_col14 {
  background-color: #33848d;
  color: #f1f1f1;
}
#T_37b8f_row9_col3, #T_37b8f_row14_col0, #T_37b8f_row14_col7 {
  background-color: #40918f;
  color: #f1f1f1;
}
#T_37b8f_row9_col5, #T_37b8f_row12_col9 {
  background-color: #24778b;
  color: #f1f1f1;
}
#T_37b8f_row9_col6, #T_37b8f_row13_col9 {
  background-color: #43948f;
  color: #f1f1f1;
}
#T_37b8f_row9_col7, #T_37b8f_row10_col9 {
  background-color: #45958f;
  color: #f1f1f1;
}
#T_37b8f_row9_col8 {
  background-color: #43938f;
  color: #f1f1f1;
}
#T_37b8f_row10_col0 {
  background-color: #4b9a8f;
  color: #f1f1f1;
}
#T_37b8f_row10_col5, #T_37b8f_row11_col6, #T_37b8f_row12_col10, #T_37b8f_row13_col11 {
  background-color: #8dc191;
  color: #000000;
}
#T_37b8f_row10_col6, #T_37b8f_row11_col5, #T_37b8f_row12_col11, #T_37b8f_row13_col10 {
  background-color: #29417a;
  color: #f1f1f1;
}
#T_37b8f_row10_col7 {
  background-color: #4c9b90;
  color: #f1f1f1;
}
#T_37b8f_row10_col8 {
  background-color: #1c6889;
  color: #f1f1f1;
}
#T_37b8f_row11_col0 {
  background-color: #1f708b;
  color: #f1f1f1;
}
#T_37b8f_row11_col3, #T_37b8f_row20_col6, #T_37b8f_row20_col13 {
  background-color: #47978f;
  color: #f1f1f1;
}
#T_37b8f_row11_col7 {
  background-color: #1e6f8a;
  color: #f1f1f1;
}
#T_37b8f_row11_col9, #T_37b8f_row20_col9 {
  background-color: #23758b;
  color: #f1f1f1;
}
#T_37b8f_row12_col5, #T_37b8f_row13_col6, #T_37b8f_row16_col2, #T_37b8f_row18_col2, #T_37b8f_row18_col16, #T_37b8f_row19_col2, #T_37b8f_row19_col16, #T_37b8f_row19_col18, #T_37b8f_row21_col2, #T_37b8f_row21_col16, #T_37b8f_row21_col18, #T_37b8f_row21_col19, #T_37b8f_row22_col2, #T_37b8f_row22_col16, #T_37b8f_row22_col18, #T_37b8f_row22_col19, #T_37b8f_row22_col21 {
  background-color: #2c3172;
  color: #f1f1f1;
}
#T_37b8f_row14_col3 {
  background-color: #2a7d8c;
  color: #f1f1f1;
}
#T_37b8f_row14_col5, #T_37b8f_row14_col12, #T_37b8f_row15_col6, #T_37b8f_row15_col13, #T_37b8f_row17_col3, #T_37b8f_row24_col3 {
  background-color: #3a8b8e;
  color: #f1f1f1;
}
#T_37b8f_row14_col6, #T_37b8f_row14_col13, #T_37b8f_row15_col5, #T_37b8f_row15_col12 {
  background-color: #2d7f8c;
  color: #f1f1f1;
}
#T_37b8f_row14_col8 {
  background-color: #26788c;
  color: #f1f1f1;
}
#T_37b8f_row14_col10, #T_37b8f_row15_col11, #T_37b8f_row23_col0 {
  background-color: #2c7e8c;
  color: #f1f1f1;
}
#T_37b8f_row14_col11, #T_37b8f_row15_col10 {
  background-color: #3c8c8e;
  color: #f1f1f1;
}
#T_37b8f_row15_col0, #T_37b8f_row15_col7 {
  background-color: #277a8c;
  color: #f1f1f1;
}
#T_37b8f_row15_col8 {
  background-color: #41928f;
  color: #f1f1f1;
}
#T_37b8f_row17_col2, #T_37b8f_row17_col16, #T_37b8f_row18_col17, #T_37b8f_row19_col17, #T_37b8f_row21_col17, #T_37b8f_row22_col17 {
  background-color: #234f81;
  color: #f1f1f1;
}
#T_37b8f_row17_col4 {
  background-color: #225182;
  color: #f1f1f1;
}
#T_37b8f_row20_col0 {
  background-color: #2b3875;
  color: #f1f1f1;
}
#T_37b8f_row20_col2, #T_37b8f_row20_col16, #T_37b8f_row20_col18, #T_37b8f_row20_col19, #T_37b8f_row21_col20, #T_37b8f_row22_col20, #T_37b8f_row23_col9 {
  background-color: #2d808c;
  color: #f1f1f1;
}
#T_37b8f_row20_col3 {
  background-color: #65ad90;
  color: #f1f1f1;
}
#T_37b8f_row20_col7, #T_37b8f_row24_col17 {
  background-color: #215584;
  color: #f1f1f1;
}
#T_37b8f_row20_col8 {
  background-color: #78b891;
  color: #f1f1f1;
}
#T_37b8f_row20_col10 {
  background-color: #48988f;
  color: #f1f1f1;
}
#T_37b8f_row20_col11 {
  background-color: #21728b;
  color: #f1f1f1;
}
#T_37b8f_row20_col14, #T_37b8f_row23_col3 {
  background-color: #3f8f8e;
  color: #f1f1f1;
}
#T_37b8f_row20_col15 {
  background-color: #287b8c;
  color: #f1f1f1;
}
#T_37b8f_row20_col17, #T_37b8f_row24_col6, #T_37b8f_row24_col13 {
  background-color: #2f818d;
  color: #f1f1f1;
}
#T_37b8f_row23_col2, #T_37b8f_row23_col16, #T_37b8f_row23_col18, #T_37b8f_row23_col19, #T_37b8f_row23_col21, #T_37b8f_row23_col22 {
  background-color: #2b3975;
  color: #f1f1f1;
}
#T_37b8f_row23_col5, #T_37b8f_row23_col7, #T_37b8f_row23_col12, #T_37b8f_row24_col20 {
  background-color: #32848d;
  color: #f1f1f1;
}
#T_37b8f_row23_col8, #T_37b8f_row24_col5, #T_37b8f_row24_col12 {
  background-color: #38898e;
  color: #f1f1f1;
}
#T_37b8f_row23_col10, #T_37b8f_row24_col11 {
  background-color: #37888d;
  color: #f1f1f1;
}
#T_37b8f_row23_col17 {
  background-color: #215483;
  color: #f1f1f1;
}
#T_37b8f_row23_col20 {
  background-color: #2b7d8c;
  color: #f1f1f1;
}
#T_37b8f_row24_col2, #T_37b8f_row24_col16, #T_37b8f_row24_col18, #T_37b8f_row24_col19, #T_37b8f_row24_col21, #T_37b8f_row24_col22, #T_37b8f_row24_col23 {
  background-color: #2b3b76;
  color: #f1f1f1;
}
#T_37b8f_row24_col7 {
  background-color: #388a8e;
  color: #f1f1f1;
}
</style>
<table id="T_37b8f_">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th class="col_heading level0 col0" >age</th>
      <th class="col_heading level0 col1" >region_code</th>
      <th class="col_heading level0 col2" >annual_premium</th>
      <th class="col_heading level0 col3" >policy_sales_channel</th>
      <th class="col_heading level0 col4" >vintage</th>
      <th class="col_heading level0 col5" >driving_license_No</th>
      <th class="col_heading level0 col6" >driving_license_Yes</th>
      <th class="col_heading level0 col7" >vehicle_age_1-2 Year</th>
      <th class="col_heading level0 col8" >vehicle_age_< 1 Year</th>
      <th class="col_heading level0 col9" >vehicle_age_> 2 Years</th>
      <th class="col_heading level0 col10" >vehicle_damage_No</th>
      <th class="col_heading level0 col11" >vehicle_damage_Yes</th>
      <th class="col_heading level0 col12" >previously_insured_No</th>
      <th class="col_heading level0 col13" >previously_insured_Yes</th>
      <th class="col_heading level0 col14" >gender_Female</th>
      <th class="col_heading level0 col15" >gender_Male</th>
      <th class="col_heading level0 col16" >mean_annual_vintage</th>
      <th class="col_heading level0 col17" >prod_annual_vintage</th>
      <th class="col_heading level0 col18" >sum_annual_vintage</th>
      <th class="col_heading level0 col19" >std_annual_vintage</th>
      <th class="col_heading level0 col20" >age_bin</th>
      <th class="col_heading level0 col21" >annual_premium_scaled</th>
      <th class="col_heading level0 col22" >annual_premium_min_max_scaled</th>
      <th class="col_heading level0 col23" >annual_premium_q_trans_uniform</th>
      <th class="col_heading level0 col24" >annual_premium_q_trans_normal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_37b8f_level0_row0" class="row_heading level0 row0" >age</th>
      <td id="T_37b8f_row0_col0" class="data row0 col0" >nan</td>
      <td id="T_37b8f_row0_col1" class="data row0 col1" >nan</td>
      <td id="T_37b8f_row0_col2" class="data row0 col2" >nan</td>
      <td id="T_37b8f_row0_col3" class="data row0 col3" >nan</td>
      <td id="T_37b8f_row0_col4" class="data row0 col4" >nan</td>
      <td id="T_37b8f_row0_col5" class="data row0 col5" >nan</td>
      <td id="T_37b8f_row0_col6" class="data row0 col6" >nan</td>
      <td id="T_37b8f_row0_col7" class="data row0 col7" >nan</td>
      <td id="T_37b8f_row0_col8" class="data row0 col8" >nan</td>
      <td id="T_37b8f_row0_col9" class="data row0 col9" >nan</td>
      <td id="T_37b8f_row0_col10" class="data row0 col10" >nan</td>
      <td id="T_37b8f_row0_col11" class="data row0 col11" >nan</td>
      <td id="T_37b8f_row0_col12" class="data row0 col12" >nan</td>
      <td id="T_37b8f_row0_col13" class="data row0 col13" >nan</td>
      <td id="T_37b8f_row0_col14" class="data row0 col14" >nan</td>
      <td id="T_37b8f_row0_col15" class="data row0 col15" >nan</td>
      <td id="T_37b8f_row0_col16" class="data row0 col16" >nan</td>
      <td id="T_37b8f_row0_col17" class="data row0 col17" >nan</td>
      <td id="T_37b8f_row0_col18" class="data row0 col18" >nan</td>
      <td id="T_37b8f_row0_col19" class="data row0 col19" >nan</td>
      <td id="T_37b8f_row0_col20" class="data row0 col20" >nan</td>
      <td id="T_37b8f_row0_col21" class="data row0 col21" >nan</td>
      <td id="T_37b8f_row0_col22" class="data row0 col22" >nan</td>
      <td id="T_37b8f_row0_col23" class="data row0 col23" >nan</td>
      <td id="T_37b8f_row0_col24" class="data row0 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row1" class="row_heading level0 row1" >region_code</th>
      <td id="T_37b8f_row1_col0" class="data row1 col0" >0.04</td>
      <td id="T_37b8f_row1_col1" class="data row1 col1" >nan</td>
      <td id="T_37b8f_row1_col2" class="data row1 col2" >nan</td>
      <td id="T_37b8f_row1_col3" class="data row1 col3" >nan</td>
      <td id="T_37b8f_row1_col4" class="data row1 col4" >nan</td>
      <td id="T_37b8f_row1_col5" class="data row1 col5" >nan</td>
      <td id="T_37b8f_row1_col6" class="data row1 col6" >nan</td>
      <td id="T_37b8f_row1_col7" class="data row1 col7" >nan</td>
      <td id="T_37b8f_row1_col8" class="data row1 col8" >nan</td>
      <td id="T_37b8f_row1_col9" class="data row1 col9" >nan</td>
      <td id="T_37b8f_row1_col10" class="data row1 col10" >nan</td>
      <td id="T_37b8f_row1_col11" class="data row1 col11" >nan</td>
      <td id="T_37b8f_row1_col12" class="data row1 col12" >nan</td>
      <td id="T_37b8f_row1_col13" class="data row1 col13" >nan</td>
      <td id="T_37b8f_row1_col14" class="data row1 col14" >nan</td>
      <td id="T_37b8f_row1_col15" class="data row1 col15" >nan</td>
      <td id="T_37b8f_row1_col16" class="data row1 col16" >nan</td>
      <td id="T_37b8f_row1_col17" class="data row1 col17" >nan</td>
      <td id="T_37b8f_row1_col18" class="data row1 col18" >nan</td>
      <td id="T_37b8f_row1_col19" class="data row1 col19" >nan</td>
      <td id="T_37b8f_row1_col20" class="data row1 col20" >nan</td>
      <td id="T_37b8f_row1_col21" class="data row1 col21" >nan</td>
      <td id="T_37b8f_row1_col22" class="data row1 col22" >nan</td>
      <td id="T_37b8f_row1_col23" class="data row1 col23" >nan</td>
      <td id="T_37b8f_row1_col24" class="data row1 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row2" class="row_heading level0 row2" >annual_premium</th>
      <td id="T_37b8f_row2_col0" class="data row2 col0" >0.06</td>
      <td id="T_37b8f_row2_col1" class="data row2 col1" >-0.01</td>
      <td id="T_37b8f_row2_col2" class="data row2 col2" >nan</td>
      <td id="T_37b8f_row2_col3" class="data row2 col3" >nan</td>
      <td id="T_37b8f_row2_col4" class="data row2 col4" >nan</td>
      <td id="T_37b8f_row2_col5" class="data row2 col5" >nan</td>
      <td id="T_37b8f_row2_col6" class="data row2 col6" >nan</td>
      <td id="T_37b8f_row2_col7" class="data row2 col7" >nan</td>
      <td id="T_37b8f_row2_col8" class="data row2 col8" >nan</td>
      <td id="T_37b8f_row2_col9" class="data row2 col9" >nan</td>
      <td id="T_37b8f_row2_col10" class="data row2 col10" >nan</td>
      <td id="T_37b8f_row2_col11" class="data row2 col11" >nan</td>
      <td id="T_37b8f_row2_col12" class="data row2 col12" >nan</td>
      <td id="T_37b8f_row2_col13" class="data row2 col13" >nan</td>
      <td id="T_37b8f_row2_col14" class="data row2 col14" >nan</td>
      <td id="T_37b8f_row2_col15" class="data row2 col15" >nan</td>
      <td id="T_37b8f_row2_col16" class="data row2 col16" >nan</td>
      <td id="T_37b8f_row2_col17" class="data row2 col17" >nan</td>
      <td id="T_37b8f_row2_col18" class="data row2 col18" >nan</td>
      <td id="T_37b8f_row2_col19" class="data row2 col19" >nan</td>
      <td id="T_37b8f_row2_col20" class="data row2 col20" >nan</td>
      <td id="T_37b8f_row2_col21" class="data row2 col21" >nan</td>
      <td id="T_37b8f_row2_col22" class="data row2 col22" >nan</td>
      <td id="T_37b8f_row2_col23" class="data row2 col23" >nan</td>
      <td id="T_37b8f_row2_col24" class="data row2 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row3" class="row_heading level0 row3" >policy_sales_channel</th>
      <td id="T_37b8f_row3_col0" class="data row3 col0" >-0.59</td>
      <td id="T_37b8f_row3_col1" class="data row3 col1" >-0.04</td>
      <td id="T_37b8f_row3_col2" class="data row3 col2" >-0.11</td>
      <td id="T_37b8f_row3_col3" class="data row3 col3" >nan</td>
      <td id="T_37b8f_row3_col4" class="data row3 col4" >nan</td>
      <td id="T_37b8f_row3_col5" class="data row3 col5" >nan</td>
      <td id="T_37b8f_row3_col6" class="data row3 col6" >nan</td>
      <td id="T_37b8f_row3_col7" class="data row3 col7" >nan</td>
      <td id="T_37b8f_row3_col8" class="data row3 col8" >nan</td>
      <td id="T_37b8f_row3_col9" class="data row3 col9" >nan</td>
      <td id="T_37b8f_row3_col10" class="data row3 col10" >nan</td>
      <td id="T_37b8f_row3_col11" class="data row3 col11" >nan</td>
      <td id="T_37b8f_row3_col12" class="data row3 col12" >nan</td>
      <td id="T_37b8f_row3_col13" class="data row3 col13" >nan</td>
      <td id="T_37b8f_row3_col14" class="data row3 col14" >nan</td>
      <td id="T_37b8f_row3_col15" class="data row3 col15" >nan</td>
      <td id="T_37b8f_row3_col16" class="data row3 col16" >nan</td>
      <td id="T_37b8f_row3_col17" class="data row3 col17" >nan</td>
      <td id="T_37b8f_row3_col18" class="data row3 col18" >nan</td>
      <td id="T_37b8f_row3_col19" class="data row3 col19" >nan</td>
      <td id="T_37b8f_row3_col20" class="data row3 col20" >nan</td>
      <td id="T_37b8f_row3_col21" class="data row3 col21" >nan</td>
      <td id="T_37b8f_row3_col22" class="data row3 col22" >nan</td>
      <td id="T_37b8f_row3_col23" class="data row3 col23" >nan</td>
      <td id="T_37b8f_row3_col24" class="data row3 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row4" class="row_heading level0 row4" >vintage</th>
      <td id="T_37b8f_row4_col0" class="data row4 col0" >0.00</td>
      <td id="T_37b8f_row4_col1" class="data row4 col1" >-0.00</td>
      <td id="T_37b8f_row4_col2" class="data row4 col2" >-0.00</td>
      <td id="T_37b8f_row4_col3" class="data row4 col3" >-0.00</td>
      <td id="T_37b8f_row4_col4" class="data row4 col4" >nan</td>
      <td id="T_37b8f_row4_col5" class="data row4 col5" >nan</td>
      <td id="T_37b8f_row4_col6" class="data row4 col6" >nan</td>
      <td id="T_37b8f_row4_col7" class="data row4 col7" >nan</td>
      <td id="T_37b8f_row4_col8" class="data row4 col8" >nan</td>
      <td id="T_37b8f_row4_col9" class="data row4 col9" >nan</td>
      <td id="T_37b8f_row4_col10" class="data row4 col10" >nan</td>
      <td id="T_37b8f_row4_col11" class="data row4 col11" >nan</td>
      <td id="T_37b8f_row4_col12" class="data row4 col12" >nan</td>
      <td id="T_37b8f_row4_col13" class="data row4 col13" >nan</td>
      <td id="T_37b8f_row4_col14" class="data row4 col14" >nan</td>
      <td id="T_37b8f_row4_col15" class="data row4 col15" >nan</td>
      <td id="T_37b8f_row4_col16" class="data row4 col16" >nan</td>
      <td id="T_37b8f_row4_col17" class="data row4 col17" >nan</td>
      <td id="T_37b8f_row4_col18" class="data row4 col18" >nan</td>
      <td id="T_37b8f_row4_col19" class="data row4 col19" >nan</td>
      <td id="T_37b8f_row4_col20" class="data row4 col20" >nan</td>
      <td id="T_37b8f_row4_col21" class="data row4 col21" >nan</td>
      <td id="T_37b8f_row4_col22" class="data row4 col22" >nan</td>
      <td id="T_37b8f_row4_col23" class="data row4 col23" >nan</td>
      <td id="T_37b8f_row4_col24" class="data row4 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row5" class="row_heading level0 row5" >driving_license_No</th>
      <td id="T_37b8f_row5_col0" class="data row5 col0" >0.27</td>
      <td id="T_37b8f_row5_col1" class="data row5 col1" >0.02</td>
      <td id="T_37b8f_row5_col2" class="data row5 col2" >-0.00</td>
      <td id="T_37b8f_row5_col3" class="data row5 col3" >-0.23</td>
      <td id="T_37b8f_row5_col4" class="data row5 col4" >-0.00</td>
      <td id="T_37b8f_row5_col5" class="data row5 col5" >nan</td>
      <td id="T_37b8f_row5_col6" class="data row5 col6" >nan</td>
      <td id="T_37b8f_row5_col7" class="data row5 col7" >nan</td>
      <td id="T_37b8f_row5_col8" class="data row5 col8" >nan</td>
      <td id="T_37b8f_row5_col9" class="data row5 col9" >nan</td>
      <td id="T_37b8f_row5_col10" class="data row5 col10" >nan</td>
      <td id="T_37b8f_row5_col11" class="data row5 col11" >nan</td>
      <td id="T_37b8f_row5_col12" class="data row5 col12" >nan</td>
      <td id="T_37b8f_row5_col13" class="data row5 col13" >nan</td>
      <td id="T_37b8f_row5_col14" class="data row5 col14" >nan</td>
      <td id="T_37b8f_row5_col15" class="data row5 col15" >nan</td>
      <td id="T_37b8f_row5_col16" class="data row5 col16" >nan</td>
      <td id="T_37b8f_row5_col17" class="data row5 col17" >nan</td>
      <td id="T_37b8f_row5_col18" class="data row5 col18" >nan</td>
      <td id="T_37b8f_row5_col19" class="data row5 col19" >nan</td>
      <td id="T_37b8f_row5_col20" class="data row5 col20" >nan</td>
      <td id="T_37b8f_row5_col21" class="data row5 col21" >nan</td>
      <td id="T_37b8f_row5_col22" class="data row5 col22" >nan</td>
      <td id="T_37b8f_row5_col23" class="data row5 col23" >nan</td>
      <td id="T_37b8f_row5_col24" class="data row5 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row6" class="row_heading level0 row6" >driving_license_Yes</th>
      <td id="T_37b8f_row6_col0" class="data row6 col0" >-0.27</td>
      <td id="T_37b8f_row6_col1" class="data row6 col1" >-0.02</td>
      <td id="T_37b8f_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_37b8f_row6_col3" class="data row6 col3" >0.23</td>
      <td id="T_37b8f_row6_col4" class="data row6 col4" >0.00</td>
      <td id="T_37b8f_row6_col5" class="data row6 col5" >-1.00</td>
      <td id="T_37b8f_row6_col6" class="data row6 col6" >nan</td>
      <td id="T_37b8f_row6_col7" class="data row6 col7" >nan</td>
      <td id="T_37b8f_row6_col8" class="data row6 col8" >nan</td>
      <td id="T_37b8f_row6_col9" class="data row6 col9" >nan</td>
      <td id="T_37b8f_row6_col10" class="data row6 col10" >nan</td>
      <td id="T_37b8f_row6_col11" class="data row6 col11" >nan</td>
      <td id="T_37b8f_row6_col12" class="data row6 col12" >nan</td>
      <td id="T_37b8f_row6_col13" class="data row6 col13" >nan</td>
      <td id="T_37b8f_row6_col14" class="data row6 col14" >nan</td>
      <td id="T_37b8f_row6_col15" class="data row6 col15" >nan</td>
      <td id="T_37b8f_row6_col16" class="data row6 col16" >nan</td>
      <td id="T_37b8f_row6_col17" class="data row6 col17" >nan</td>
      <td id="T_37b8f_row6_col18" class="data row6 col18" >nan</td>
      <td id="T_37b8f_row6_col19" class="data row6 col19" >nan</td>
      <td id="T_37b8f_row6_col20" class="data row6 col20" >nan</td>
      <td id="T_37b8f_row6_col21" class="data row6 col21" >nan</td>
      <td id="T_37b8f_row6_col22" class="data row6 col22" >nan</td>
      <td id="T_37b8f_row6_col23" class="data row6 col23" >nan</td>
      <td id="T_37b8f_row6_col24" class="data row6 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row7" class="row_heading level0 row7" >vehicle_age_1-2 Year</th>
      <td id="T_37b8f_row7_col0" class="data row7 col0" >0.71</td>
      <td id="T_37b8f_row7_col1" class="data row7 col1" >0.04</td>
      <td id="T_37b8f_row7_col2" class="data row7 col2" >-0.01</td>
      <td id="T_37b8f_row7_col3" class="data row7 col3" >-0.51</td>
      <td id="T_37b8f_row7_col4" class="data row7 col4" >-0.00</td>
      <td id="T_37b8f_row7_col5" class="data row7 col5" >0.29</td>
      <td id="T_37b8f_row7_col6" class="data row7 col6" >-0.29</td>
      <td id="T_37b8f_row7_col7" class="data row7 col7" >nan</td>
      <td id="T_37b8f_row7_col8" class="data row7 col8" >nan</td>
      <td id="T_37b8f_row7_col9" class="data row7 col9" >nan</td>
      <td id="T_37b8f_row7_col10" class="data row7 col10" >nan</td>
      <td id="T_37b8f_row7_col11" class="data row7 col11" >nan</td>
      <td id="T_37b8f_row7_col12" class="data row7 col12" >nan</td>
      <td id="T_37b8f_row7_col13" class="data row7 col13" >nan</td>
      <td id="T_37b8f_row7_col14" class="data row7 col14" >nan</td>
      <td id="T_37b8f_row7_col15" class="data row7 col15" >nan</td>
      <td id="T_37b8f_row7_col16" class="data row7 col16" >nan</td>
      <td id="T_37b8f_row7_col17" class="data row7 col17" >nan</td>
      <td id="T_37b8f_row7_col18" class="data row7 col18" >nan</td>
      <td id="T_37b8f_row7_col19" class="data row7 col19" >nan</td>
      <td id="T_37b8f_row7_col20" class="data row7 col20" >nan</td>
      <td id="T_37b8f_row7_col21" class="data row7 col21" >nan</td>
      <td id="T_37b8f_row7_col22" class="data row7 col22" >nan</td>
      <td id="T_37b8f_row7_col23" class="data row7 col23" >nan</td>
      <td id="T_37b8f_row7_col24" class="data row7 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row8" class="row_heading level0 row8" >vehicle_age_< 1 Year</th>
      <td id="T_37b8f_row8_col0" class="data row8 col0" >-0.80</td>
      <td id="T_37b8f_row8_col1" class="data row8 col1" >-0.04</td>
      <td id="T_37b8f_row8_col2" class="data row8 col2" >-0.02</td>
      <td id="T_37b8f_row8_col3" class="data row8 col3" >0.57</td>
      <td id="T_37b8f_row8_col4" class="data row8 col4" >0.00</td>
      <td id="T_37b8f_row8_col5" class="data row8 col5" >-0.36</td>
      <td id="T_37b8f_row8_col6" class="data row8 col6" >0.36</td>
      <td id="T_37b8f_row8_col7" class="data row8 col7" >-0.92</td>
      <td id="T_37b8f_row8_col8" class="data row8 col8" >nan</td>
      <td id="T_37b8f_row8_col9" class="data row8 col9" >nan</td>
      <td id="T_37b8f_row8_col10" class="data row8 col10" >nan</td>
      <td id="T_37b8f_row8_col11" class="data row8 col11" >nan</td>
      <td id="T_37b8f_row8_col12" class="data row8 col12" >nan</td>
      <td id="T_37b8f_row8_col13" class="data row8 col13" >nan</td>
      <td id="T_37b8f_row8_col14" class="data row8 col14" >nan</td>
      <td id="T_37b8f_row8_col15" class="data row8 col15" >nan</td>
      <td id="T_37b8f_row8_col16" class="data row8 col16" >nan</td>
      <td id="T_37b8f_row8_col17" class="data row8 col17" >nan</td>
      <td id="T_37b8f_row8_col18" class="data row8 col18" >nan</td>
      <td id="T_37b8f_row8_col19" class="data row8 col19" >nan</td>
      <td id="T_37b8f_row8_col20" class="data row8 col20" >nan</td>
      <td id="T_37b8f_row8_col21" class="data row8 col21" >nan</td>
      <td id="T_37b8f_row8_col22" class="data row8 col22" >nan</td>
      <td id="T_37b8f_row8_col23" class="data row8 col23" >nan</td>
      <td id="T_37b8f_row8_col24" class="data row8 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row9" class="row_heading level0 row9" >vehicle_age_> 2 Years</th>
      <td id="T_37b8f_row9_col0" class="data row9 col0" >0.22</td>
      <td id="T_37b8f_row9_col1" class="data row9 col1" >0.01</td>
      <td id="T_37b8f_row9_col2" class="data row9 col2" >0.06</td>
      <td id="T_37b8f_row9_col3" class="data row9 col3" >-0.15</td>
      <td id="T_37b8f_row9_col4" class="data row9 col4" >-0.00</td>
      <td id="T_37b8f_row9_col5" class="data row9 col5" >0.19</td>
      <td id="T_37b8f_row9_col6" class="data row9 col6" >-0.19</td>
      <td id="T_37b8f_row9_col7" class="data row9 col7" >-0.21</td>
      <td id="T_37b8f_row9_col8" class="data row9 col8" >-0.18</td>
      <td id="T_37b8f_row9_col9" class="data row9 col9" >nan</td>
      <td id="T_37b8f_row9_col10" class="data row9 col10" >nan</td>
      <td id="T_37b8f_row9_col11" class="data row9 col11" >nan</td>
      <td id="T_37b8f_row9_col12" class="data row9 col12" >nan</td>
      <td id="T_37b8f_row9_col13" class="data row9 col13" >nan</td>
      <td id="T_37b8f_row9_col14" class="data row9 col14" >nan</td>
      <td id="T_37b8f_row9_col15" class="data row9 col15" >nan</td>
      <td id="T_37b8f_row9_col16" class="data row9 col16" >nan</td>
      <td id="T_37b8f_row9_col17" class="data row9 col17" >nan</td>
      <td id="T_37b8f_row9_col18" class="data row9 col18" >nan</td>
      <td id="T_37b8f_row9_col19" class="data row9 col19" >nan</td>
      <td id="T_37b8f_row9_col20" class="data row9 col20" >nan</td>
      <td id="T_37b8f_row9_col21" class="data row9 col21" >nan</td>
      <td id="T_37b8f_row9_col22" class="data row9 col22" >nan</td>
      <td id="T_37b8f_row9_col23" class="data row9 col23" >nan</td>
      <td id="T_37b8f_row9_col24" class="data row9 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row10" class="row_heading level0 row10" >vehicle_damage_No</th>
      <td id="T_37b8f_row10_col0" class="data row10 col0" >-0.28</td>
      <td id="T_37b8f_row10_col1" class="data row10 col1" >-0.03</td>
      <td id="T_37b8f_row10_col2" class="data row10 col2" >-0.01</td>
      <td id="T_37b8f_row10_col3" class="data row10 col3" >0.23</td>
      <td id="T_37b8f_row10_col4" class="data row10 col4" >-0.00</td>
      <td id="T_37b8f_row10_col5" class="data row10 col5" >-0.82</td>
      <td id="T_37b8f_row10_col6" class="data row10 col6" >0.82</td>
      <td id="T_37b8f_row10_col7" class="data row10 col7" >-0.29</td>
      <td id="T_37b8f_row10_col8" class="data row10 col8" >0.37</td>
      <td id="T_37b8f_row10_col9" class="data row10 col9" >-0.20</td>
      <td id="T_37b8f_row10_col10" class="data row10 col10" >nan</td>
      <td id="T_37b8f_row10_col11" class="data row10 col11" >nan</td>
      <td id="T_37b8f_row10_col12" class="data row10 col12" >nan</td>
      <td id="T_37b8f_row10_col13" class="data row10 col13" >nan</td>
      <td id="T_37b8f_row10_col14" class="data row10 col14" >nan</td>
      <td id="T_37b8f_row10_col15" class="data row10 col15" >nan</td>
      <td id="T_37b8f_row10_col16" class="data row10 col16" >nan</td>
      <td id="T_37b8f_row10_col17" class="data row10 col17" >nan</td>
      <td id="T_37b8f_row10_col18" class="data row10 col18" >nan</td>
      <td id="T_37b8f_row10_col19" class="data row10 col19" >nan</td>
      <td id="T_37b8f_row10_col20" class="data row10 col20" >nan</td>
      <td id="T_37b8f_row10_col21" class="data row10 col21" >nan</td>
      <td id="T_37b8f_row10_col22" class="data row10 col22" >nan</td>
      <td id="T_37b8f_row10_col23" class="data row10 col23" >nan</td>
      <td id="T_37b8f_row10_col24" class="data row10 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row11" class="row_heading level0 row11" >vehicle_damage_Yes</th>
      <td id="T_37b8f_row11_col0" class="data row11 col0" >0.28</td>
      <td id="T_37b8f_row11_col1" class="data row11 col1" >0.03</td>
      <td id="T_37b8f_row11_col2" class="data row11 col2" >0.01</td>
      <td id="T_37b8f_row11_col3" class="data row11 col3" >-0.23</td>
      <td id="T_37b8f_row11_col4" class="data row11 col4" >0.00</td>
      <td id="T_37b8f_row11_col5" class="data row11 col5" >0.82</td>
      <td id="T_37b8f_row11_col6" class="data row11 col6" >-0.82</td>
      <td id="T_37b8f_row11_col7" class="data row11 col7" >0.29</td>
      <td id="T_37b8f_row11_col8" class="data row11 col8" >-0.37</td>
      <td id="T_37b8f_row11_col9" class="data row11 col9" >0.20</td>
      <td id="T_37b8f_row11_col10" class="data row11 col10" >-1.00</td>
      <td id="T_37b8f_row11_col11" class="data row11 col11" >nan</td>
      <td id="T_37b8f_row11_col12" class="data row11 col12" >nan</td>
      <td id="T_37b8f_row11_col13" class="data row11 col13" >nan</td>
      <td id="T_37b8f_row11_col14" class="data row11 col14" >nan</td>
      <td id="T_37b8f_row11_col15" class="data row11 col15" >nan</td>
      <td id="T_37b8f_row11_col16" class="data row11 col16" >nan</td>
      <td id="T_37b8f_row11_col17" class="data row11 col17" >nan</td>
      <td id="T_37b8f_row11_col18" class="data row11 col18" >nan</td>
      <td id="T_37b8f_row11_col19" class="data row11 col19" >nan</td>
      <td id="T_37b8f_row11_col20" class="data row11 col20" >nan</td>
      <td id="T_37b8f_row11_col21" class="data row11 col21" >nan</td>
      <td id="T_37b8f_row11_col22" class="data row11 col22" >nan</td>
      <td id="T_37b8f_row11_col23" class="data row11 col23" >nan</td>
      <td id="T_37b8f_row11_col24" class="data row11 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row12" class="row_heading level0 row12" >previously_insured_No</th>
      <td id="T_37b8f_row12_col0" class="data row12 col0" >0.27</td>
      <td id="T_37b8f_row12_col1" class="data row12 col1" >0.02</td>
      <td id="T_37b8f_row12_col2" class="data row12 col2" >-0.00</td>
      <td id="T_37b8f_row12_col3" class="data row12 col3" >-0.23</td>
      <td id="T_37b8f_row12_col4" class="data row12 col4" >-0.00</td>
      <td id="T_37b8f_row12_col5" class="data row12 col5" >1.00</td>
      <td id="T_37b8f_row12_col6" class="data row12 col6" >-1.00</td>
      <td id="T_37b8f_row12_col7" class="data row12 col7" >0.29</td>
      <td id="T_37b8f_row12_col8" class="data row12 col8" >-0.36</td>
      <td id="T_37b8f_row12_col9" class="data row12 col9" >0.19</td>
      <td id="T_37b8f_row12_col10" class="data row12 col10" >-0.82</td>
      <td id="T_37b8f_row12_col11" class="data row12 col11" >0.82</td>
      <td id="T_37b8f_row12_col12" class="data row12 col12" >nan</td>
      <td id="T_37b8f_row12_col13" class="data row12 col13" >nan</td>
      <td id="T_37b8f_row12_col14" class="data row12 col14" >nan</td>
      <td id="T_37b8f_row12_col15" class="data row12 col15" >nan</td>
      <td id="T_37b8f_row12_col16" class="data row12 col16" >nan</td>
      <td id="T_37b8f_row12_col17" class="data row12 col17" >nan</td>
      <td id="T_37b8f_row12_col18" class="data row12 col18" >nan</td>
      <td id="T_37b8f_row12_col19" class="data row12 col19" >nan</td>
      <td id="T_37b8f_row12_col20" class="data row12 col20" >nan</td>
      <td id="T_37b8f_row12_col21" class="data row12 col21" >nan</td>
      <td id="T_37b8f_row12_col22" class="data row12 col22" >nan</td>
      <td id="T_37b8f_row12_col23" class="data row12 col23" >nan</td>
      <td id="T_37b8f_row12_col24" class="data row12 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row13" class="row_heading level0 row13" >previously_insured_Yes</th>
      <td id="T_37b8f_row13_col0" class="data row13 col0" >-0.27</td>
      <td id="T_37b8f_row13_col1" class="data row13 col1" >-0.02</td>
      <td id="T_37b8f_row13_col2" class="data row13 col2" >0.00</td>
      <td id="T_37b8f_row13_col3" class="data row13 col3" >0.23</td>
      <td id="T_37b8f_row13_col4" class="data row13 col4" >0.00</td>
      <td id="T_37b8f_row13_col5" class="data row13 col5" >-1.00</td>
      <td id="T_37b8f_row13_col6" class="data row13 col6" >1.00</td>
      <td id="T_37b8f_row13_col7" class="data row13 col7" >-0.29</td>
      <td id="T_37b8f_row13_col8" class="data row13 col8" >0.36</td>
      <td id="T_37b8f_row13_col9" class="data row13 col9" >-0.19</td>
      <td id="T_37b8f_row13_col10" class="data row13 col10" >0.82</td>
      <td id="T_37b8f_row13_col11" class="data row13 col11" >-0.82</td>
      <td id="T_37b8f_row13_col12" class="data row13 col12" >-1.00</td>
      <td id="T_37b8f_row13_col13" class="data row13 col13" >nan</td>
      <td id="T_37b8f_row13_col14" class="data row13 col14" >nan</td>
      <td id="T_37b8f_row13_col15" class="data row13 col15" >nan</td>
      <td id="T_37b8f_row13_col16" class="data row13 col16" >nan</td>
      <td id="T_37b8f_row13_col17" class="data row13 col17" >nan</td>
      <td id="T_37b8f_row13_col18" class="data row13 col18" >nan</td>
      <td id="T_37b8f_row13_col19" class="data row13 col19" >nan</td>
      <td id="T_37b8f_row13_col20" class="data row13 col20" >nan</td>
      <td id="T_37b8f_row13_col21" class="data row13 col21" >nan</td>
      <td id="T_37b8f_row13_col22" class="data row13 col22" >nan</td>
      <td id="T_37b8f_row13_col23" class="data row13 col23" >nan</td>
      <td id="T_37b8f_row13_col24" class="data row13 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row14" class="row_heading level0 row14" >gender_Female</th>
      <td id="T_37b8f_row14_col0" class="data row14 col0" >-0.15</td>
      <td id="T_37b8f_row14_col1" class="data row14 col1" >-0.00</td>
      <td id="T_37b8f_row14_col2" class="data row14 col2" >-0.00</td>
      <td id="T_37b8f_row14_col3" class="data row14 col3" >0.11</td>
      <td id="T_37b8f_row14_col4" class="data row14 col4" >0.00</td>
      <td id="T_37b8f_row14_col5" class="data row14 col5" >-0.08</td>
      <td id="T_37b8f_row14_col6" class="data row14 col6" >0.08</td>
      <td id="T_37b8f_row14_col7" class="data row14 col7" >-0.15</td>
      <td id="T_37b8f_row14_col8" class="data row14 col8" >0.17</td>
      <td id="T_37b8f_row14_col9" class="data row14 col9" >-0.04</td>
      <td id="T_37b8f_row14_col10" class="data row14 col10" >0.10</td>
      <td id="T_37b8f_row14_col11" class="data row14 col11" >-0.10</td>
      <td id="T_37b8f_row14_col12" class="data row14 col12" >-0.08</td>
      <td id="T_37b8f_row14_col13" class="data row14 col13" >0.08</td>
      <td id="T_37b8f_row14_col14" class="data row14 col14" >nan</td>
      <td id="T_37b8f_row14_col15" class="data row14 col15" >nan</td>
      <td id="T_37b8f_row14_col16" class="data row14 col16" >nan</td>
      <td id="T_37b8f_row14_col17" class="data row14 col17" >nan</td>
      <td id="T_37b8f_row14_col18" class="data row14 col18" >nan</td>
      <td id="T_37b8f_row14_col19" class="data row14 col19" >nan</td>
      <td id="T_37b8f_row14_col20" class="data row14 col20" >nan</td>
      <td id="T_37b8f_row14_col21" class="data row14 col21" >nan</td>
      <td id="T_37b8f_row14_col22" class="data row14 col22" >nan</td>
      <td id="T_37b8f_row14_col23" class="data row14 col23" >nan</td>
      <td id="T_37b8f_row14_col24" class="data row14 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row15" class="row_heading level0 row15" >gender_Male</th>
      <td id="T_37b8f_row15_col0" class="data row15 col0" >0.15</td>
      <td id="T_37b8f_row15_col1" class="data row15 col1" >0.00</td>
      <td id="T_37b8f_row15_col2" class="data row15 col2" >0.00</td>
      <td id="T_37b8f_row15_col3" class="data row15 col3" >-0.11</td>
      <td id="T_37b8f_row15_col4" class="data row15 col4" >-0.00</td>
      <td id="T_37b8f_row15_col5" class="data row15 col5" >0.08</td>
      <td id="T_37b8f_row15_col6" class="data row15 col6" >-0.08</td>
      <td id="T_37b8f_row15_col7" class="data row15 col7" >0.15</td>
      <td id="T_37b8f_row15_col8" class="data row15 col8" >-0.17</td>
      <td id="T_37b8f_row15_col9" class="data row15 col9" >0.04</td>
      <td id="T_37b8f_row15_col10" class="data row15 col10" >-0.10</td>
      <td id="T_37b8f_row15_col11" class="data row15 col11" >0.10</td>
      <td id="T_37b8f_row15_col12" class="data row15 col12" >0.08</td>
      <td id="T_37b8f_row15_col13" class="data row15 col13" >-0.08</td>
      <td id="T_37b8f_row15_col14" class="data row15 col14" >-1.00</td>
      <td id="T_37b8f_row15_col15" class="data row15 col15" >nan</td>
      <td id="T_37b8f_row15_col16" class="data row15 col16" >nan</td>
      <td id="T_37b8f_row15_col17" class="data row15 col17" >nan</td>
      <td id="T_37b8f_row15_col18" class="data row15 col18" >nan</td>
      <td id="T_37b8f_row15_col19" class="data row15 col19" >nan</td>
      <td id="T_37b8f_row15_col20" class="data row15 col20" >nan</td>
      <td id="T_37b8f_row15_col21" class="data row15 col21" >nan</td>
      <td id="T_37b8f_row15_col22" class="data row15 col22" >nan</td>
      <td id="T_37b8f_row15_col23" class="data row15 col23" >nan</td>
      <td id="T_37b8f_row15_col24" class="data row15 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row16" class="row_heading level0 row16" >mean_annual_vintage</th>
      <td id="T_37b8f_row16_col0" class="data row16 col0" >0.06</td>
      <td id="T_37b8f_row16_col1" class="data row16 col1" >-0.01</td>
      <td id="T_37b8f_row16_col2" class="data row16 col2" >1.00</td>
      <td id="T_37b8f_row16_col3" class="data row16 col3" >-0.11</td>
      <td id="T_37b8f_row16_col4" class="data row16 col4" >0.00</td>
      <td id="T_37b8f_row16_col5" class="data row16 col5" >-0.00</td>
      <td id="T_37b8f_row16_col6" class="data row16 col6" >0.00</td>
      <td id="T_37b8f_row16_col7" class="data row16 col7" >-0.01</td>
      <td id="T_37b8f_row16_col8" class="data row16 col8" >-0.02</td>
      <td id="T_37b8f_row16_col9" class="data row16 col9" >0.06</td>
      <td id="T_37b8f_row16_col10" class="data row16 col10" >-0.01</td>
      <td id="T_37b8f_row16_col11" class="data row16 col11" >0.01</td>
      <td id="T_37b8f_row16_col12" class="data row16 col12" >-0.00</td>
      <td id="T_37b8f_row16_col13" class="data row16 col13" >0.00</td>
      <td id="T_37b8f_row16_col14" class="data row16 col14" >-0.00</td>
      <td id="T_37b8f_row16_col15" class="data row16 col15" >0.00</td>
      <td id="T_37b8f_row16_col16" class="data row16 col16" >nan</td>
      <td id="T_37b8f_row16_col17" class="data row16 col17" >nan</td>
      <td id="T_37b8f_row16_col18" class="data row16 col18" >nan</td>
      <td id="T_37b8f_row16_col19" class="data row16 col19" >nan</td>
      <td id="T_37b8f_row16_col20" class="data row16 col20" >nan</td>
      <td id="T_37b8f_row16_col21" class="data row16 col21" >nan</td>
      <td id="T_37b8f_row16_col22" class="data row16 col22" >nan</td>
      <td id="T_37b8f_row16_col23" class="data row16 col23" >nan</td>
      <td id="T_37b8f_row16_col24" class="data row16 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row17" class="row_heading level0 row17" >prod_annual_vintage</th>
      <td id="T_37b8f_row17_col0" class="data row17 col0" >0.04</td>
      <td id="T_37b8f_row17_col1" class="data row17 col1" >-0.01</td>
      <td id="T_37b8f_row17_col2" class="data row17 col2" >0.67</td>
      <td id="T_37b8f_row17_col3" class="data row17 col3" >-0.07</td>
      <td id="T_37b8f_row17_col4" class="data row17 col4" >0.65</td>
      <td id="T_37b8f_row17_col5" class="data row17 col5" >-0.00</td>
      <td id="T_37b8f_row17_col6" class="data row17 col6" >0.00</td>
      <td id="T_37b8f_row17_col7" class="data row17 col7" >-0.00</td>
      <td id="T_37b8f_row17_col8" class="data row17 col8" >-0.01</td>
      <td id="T_37b8f_row17_col9" class="data row17 col9" >0.04</td>
      <td id="T_37b8f_row17_col10" class="data row17 col10" >-0.01</td>
      <td id="T_37b8f_row17_col11" class="data row17 col11" >0.01</td>
      <td id="T_37b8f_row17_col12" class="data row17 col12" >-0.00</td>
      <td id="T_37b8f_row17_col13" class="data row17 col13" >0.00</td>
      <td id="T_37b8f_row17_col14" class="data row17 col14" >-0.00</td>
      <td id="T_37b8f_row17_col15" class="data row17 col15" >0.00</td>
      <td id="T_37b8f_row17_col16" class="data row17 col16" >0.67</td>
      <td id="T_37b8f_row17_col17" class="data row17 col17" >nan</td>
      <td id="T_37b8f_row17_col18" class="data row17 col18" >nan</td>
      <td id="T_37b8f_row17_col19" class="data row17 col19" >nan</td>
      <td id="T_37b8f_row17_col20" class="data row17 col20" >nan</td>
      <td id="T_37b8f_row17_col21" class="data row17 col21" >nan</td>
      <td id="T_37b8f_row17_col22" class="data row17 col22" >nan</td>
      <td id="T_37b8f_row17_col23" class="data row17 col23" >nan</td>
      <td id="T_37b8f_row17_col24" class="data row17 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row18" class="row_heading level0 row18" >sum_annual_vintage</th>
      <td id="T_37b8f_row18_col0" class="data row18 col0" >0.06</td>
      <td id="T_37b8f_row18_col1" class="data row18 col1" >-0.01</td>
      <td id="T_37b8f_row18_col2" class="data row18 col2" >1.00</td>
      <td id="T_37b8f_row18_col3" class="data row18 col3" >-0.11</td>
      <td id="T_37b8f_row18_col4" class="data row18 col4" >0.00</td>
      <td id="T_37b8f_row18_col5" class="data row18 col5" >-0.00</td>
      <td id="T_37b8f_row18_col6" class="data row18 col6" >0.00</td>
      <td id="T_37b8f_row18_col7" class="data row18 col7" >-0.01</td>
      <td id="T_37b8f_row18_col8" class="data row18 col8" >-0.02</td>
      <td id="T_37b8f_row18_col9" class="data row18 col9" >0.06</td>
      <td id="T_37b8f_row18_col10" class="data row18 col10" >-0.01</td>
      <td id="T_37b8f_row18_col11" class="data row18 col11" >0.01</td>
      <td id="T_37b8f_row18_col12" class="data row18 col12" >-0.00</td>
      <td id="T_37b8f_row18_col13" class="data row18 col13" >0.00</td>
      <td id="T_37b8f_row18_col14" class="data row18 col14" >-0.00</td>
      <td id="T_37b8f_row18_col15" class="data row18 col15" >0.00</td>
      <td id="T_37b8f_row18_col16" class="data row18 col16" >1.00</td>
      <td id="T_37b8f_row18_col17" class="data row18 col17" >0.67</td>
      <td id="T_37b8f_row18_col18" class="data row18 col18" >nan</td>
      <td id="T_37b8f_row18_col19" class="data row18 col19" >nan</td>
      <td id="T_37b8f_row18_col20" class="data row18 col20" >nan</td>
      <td id="T_37b8f_row18_col21" class="data row18 col21" >nan</td>
      <td id="T_37b8f_row18_col22" class="data row18 col22" >nan</td>
      <td id="T_37b8f_row18_col23" class="data row18 col23" >nan</td>
      <td id="T_37b8f_row18_col24" class="data row18 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row19" class="row_heading level0 row19" >std_annual_vintage</th>
      <td id="T_37b8f_row19_col0" class="data row19 col0" >0.06</td>
      <td id="T_37b8f_row19_col1" class="data row19 col1" >-0.01</td>
      <td id="T_37b8f_row19_col2" class="data row19 col2" >1.00</td>
      <td id="T_37b8f_row19_col3" class="data row19 col3" >-0.11</td>
      <td id="T_37b8f_row19_col4" class="data row19 col4" >-0.01</td>
      <td id="T_37b8f_row19_col5" class="data row19 col5" >-0.00</td>
      <td id="T_37b8f_row19_col6" class="data row19 col6" >0.00</td>
      <td id="T_37b8f_row19_col7" class="data row19 col7" >-0.01</td>
      <td id="T_37b8f_row19_col8" class="data row19 col8" >-0.02</td>
      <td id="T_37b8f_row19_col9" class="data row19 col9" >0.06</td>
      <td id="T_37b8f_row19_col10" class="data row19 col10" >-0.01</td>
      <td id="T_37b8f_row19_col11" class="data row19 col11" >0.01</td>
      <td id="T_37b8f_row19_col12" class="data row19 col12" >-0.00</td>
      <td id="T_37b8f_row19_col13" class="data row19 col13" >0.00</td>
      <td id="T_37b8f_row19_col14" class="data row19 col14" >-0.00</td>
      <td id="T_37b8f_row19_col15" class="data row19 col15" >0.00</td>
      <td id="T_37b8f_row19_col16" class="data row19 col16" >1.00</td>
      <td id="T_37b8f_row19_col17" class="data row19 col17" >0.67</td>
      <td id="T_37b8f_row19_col18" class="data row19 col18" >1.00</td>
      <td id="T_37b8f_row19_col19" class="data row19 col19" >nan</td>
      <td id="T_37b8f_row19_col20" class="data row19 col20" >nan</td>
      <td id="T_37b8f_row19_col21" class="data row19 col21" >nan</td>
      <td id="T_37b8f_row19_col22" class="data row19 col22" >nan</td>
      <td id="T_37b8f_row19_col23" class="data row19 col23" >nan</td>
      <td id="T_37b8f_row19_col24" class="data row19 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row20" class="row_heading level0 row20" >age_bin</th>
      <td id="T_37b8f_row20_col0" class="data row20 col0" >0.93</td>
      <td id="T_37b8f_row20_col1" class="data row20 col1" >0.04</td>
      <td id="T_37b8f_row20_col2" class="data row20 col2" >0.08</td>
      <td id="T_37b8f_row20_col3" class="data row20 col3" >-0.54</td>
      <td id="T_37b8f_row20_col4" class="data row20 col4" >0.00</td>
      <td id="T_37b8f_row20_col5" class="data row20 col5" >0.23</td>
      <td id="T_37b8f_row20_col6" class="data row20 col6" >-0.23</td>
      <td id="T_37b8f_row20_col7" class="data row20 col7" >0.60</td>
      <td id="T_37b8f_row20_col8" class="data row20 col8" >-0.68</td>
      <td id="T_37b8f_row20_col9" class="data row20 col9" >0.21</td>
      <td id="T_37b8f_row20_col10" class="data row20 col10" >-0.24</td>
      <td id="T_37b8f_row20_col11" class="data row20 col11" >0.24</td>
      <td id="T_37b8f_row20_col12" class="data row20 col12" >0.23</td>
      <td id="T_37b8f_row20_col13" class="data row20 col13" >-0.23</td>
      <td id="T_37b8f_row20_col14" class="data row20 col14" >-0.13</td>
      <td id="T_37b8f_row20_col15" class="data row20 col15" >0.13</td>
      <td id="T_37b8f_row20_col16" class="data row20 col16" >0.08</td>
      <td id="T_37b8f_row20_col17" class="data row20 col17" >0.05</td>
      <td id="T_37b8f_row20_col18" class="data row20 col18" >0.08</td>
      <td id="T_37b8f_row20_col19" class="data row20 col19" >0.08</td>
      <td id="T_37b8f_row20_col20" class="data row20 col20" >nan</td>
      <td id="T_37b8f_row20_col21" class="data row20 col21" >nan</td>
      <td id="T_37b8f_row20_col22" class="data row20 col22" >nan</td>
      <td id="T_37b8f_row20_col23" class="data row20 col23" >nan</td>
      <td id="T_37b8f_row20_col24" class="data row20 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row21" class="row_heading level0 row21" >annual_premium_scaled</th>
      <td id="T_37b8f_row21_col0" class="data row21 col0" >0.06</td>
      <td id="T_37b8f_row21_col1" class="data row21 col1" >-0.01</td>
      <td id="T_37b8f_row21_col2" class="data row21 col2" >1.00</td>
      <td id="T_37b8f_row21_col3" class="data row21 col3" >-0.11</td>
      <td id="T_37b8f_row21_col4" class="data row21 col4" >-0.00</td>
      <td id="T_37b8f_row21_col5" class="data row21 col5" >-0.00</td>
      <td id="T_37b8f_row21_col6" class="data row21 col6" >0.00</td>
      <td id="T_37b8f_row21_col7" class="data row21 col7" >-0.01</td>
      <td id="T_37b8f_row21_col8" class="data row21 col8" >-0.02</td>
      <td id="T_37b8f_row21_col9" class="data row21 col9" >0.06</td>
      <td id="T_37b8f_row21_col10" class="data row21 col10" >-0.01</td>
      <td id="T_37b8f_row21_col11" class="data row21 col11" >0.01</td>
      <td id="T_37b8f_row21_col12" class="data row21 col12" >-0.00</td>
      <td id="T_37b8f_row21_col13" class="data row21 col13" >0.00</td>
      <td id="T_37b8f_row21_col14" class="data row21 col14" >-0.00</td>
      <td id="T_37b8f_row21_col15" class="data row21 col15" >0.00</td>
      <td id="T_37b8f_row21_col16" class="data row21 col16" >1.00</td>
      <td id="T_37b8f_row21_col17" class="data row21 col17" >0.67</td>
      <td id="T_37b8f_row21_col18" class="data row21 col18" >1.00</td>
      <td id="T_37b8f_row21_col19" class="data row21 col19" >1.00</td>
      <td id="T_37b8f_row21_col20" class="data row21 col20" >0.08</td>
      <td id="T_37b8f_row21_col21" class="data row21 col21" >nan</td>
      <td id="T_37b8f_row21_col22" class="data row21 col22" >nan</td>
      <td id="T_37b8f_row21_col23" class="data row21 col23" >nan</td>
      <td id="T_37b8f_row21_col24" class="data row21 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row22" class="row_heading level0 row22" >annual_premium_min_max_scaled</th>
      <td id="T_37b8f_row22_col0" class="data row22 col0" >0.06</td>
      <td id="T_37b8f_row22_col1" class="data row22 col1" >-0.01</td>
      <td id="T_37b8f_row22_col2" class="data row22 col2" >1.00</td>
      <td id="T_37b8f_row22_col3" class="data row22 col3" >-0.11</td>
      <td id="T_37b8f_row22_col4" class="data row22 col4" >-0.00</td>
      <td id="T_37b8f_row22_col5" class="data row22 col5" >-0.00</td>
      <td id="T_37b8f_row22_col6" class="data row22 col6" >0.00</td>
      <td id="T_37b8f_row22_col7" class="data row22 col7" >-0.01</td>
      <td id="T_37b8f_row22_col8" class="data row22 col8" >-0.02</td>
      <td id="T_37b8f_row22_col9" class="data row22 col9" >0.06</td>
      <td id="T_37b8f_row22_col10" class="data row22 col10" >-0.01</td>
      <td id="T_37b8f_row22_col11" class="data row22 col11" >0.01</td>
      <td id="T_37b8f_row22_col12" class="data row22 col12" >-0.00</td>
      <td id="T_37b8f_row22_col13" class="data row22 col13" >0.00</td>
      <td id="T_37b8f_row22_col14" class="data row22 col14" >-0.00</td>
      <td id="T_37b8f_row22_col15" class="data row22 col15" >0.00</td>
      <td id="T_37b8f_row22_col16" class="data row22 col16" >1.00</td>
      <td id="T_37b8f_row22_col17" class="data row22 col17" >0.67</td>
      <td id="T_37b8f_row22_col18" class="data row22 col18" >1.00</td>
      <td id="T_37b8f_row22_col19" class="data row22 col19" >1.00</td>
      <td id="T_37b8f_row22_col20" class="data row22 col20" >0.08</td>
      <td id="T_37b8f_row22_col21" class="data row22 col21" >1.00</td>
      <td id="T_37b8f_row22_col22" class="data row22 col22" >nan</td>
      <td id="T_37b8f_row22_col23" class="data row22 col23" >nan</td>
      <td id="T_37b8f_row22_col24" class="data row22 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row23" class="row_heading level0 row23" >annual_premium_q_trans_uniform</th>
      <td id="T_37b8f_row23_col0" class="data row23 col0" >0.09</td>
      <td id="T_37b8f_row23_col1" class="data row23 col1" >-0.01</td>
      <td id="T_37b8f_row23_col2" class="data row23 col2" >0.91</td>
      <td id="T_37b8f_row23_col3" class="data row23 col3" >-0.14</td>
      <td id="T_37b8f_row23_col4" class="data row23 col4" >-0.00</td>
      <td id="T_37b8f_row23_col5" class="data row23 col5" >0.02</td>
      <td id="T_37b8f_row23_col6" class="data row23 col6" >-0.02</td>
      <td id="T_37b8f_row23_col7" class="data row23 col7" >0.02</td>
      <td id="T_37b8f_row23_col8" class="data row23 col8" >-0.05</td>
      <td id="T_37b8f_row23_col9" class="data row23 col9" >0.08</td>
      <td id="T_37b8f_row23_col10" class="data row23 col10" >-0.03</td>
      <td id="T_37b8f_row23_col11" class="data row23 col11" >0.03</td>
      <td id="T_37b8f_row23_col12" class="data row23 col12" >0.02</td>
      <td id="T_37b8f_row23_col13" class="data row23 col13" >-0.02</td>
      <td id="T_37b8f_row23_col14" class="data row23 col14" >-0.02</td>
      <td id="T_37b8f_row23_col15" class="data row23 col15" >0.02</td>
      <td id="T_37b8f_row23_col16" class="data row23 col16" >0.91</td>
      <td id="T_37b8f_row23_col17" class="data row23 col17" >0.61</td>
      <td id="T_37b8f_row23_col18" class="data row23 col18" >0.91</td>
      <td id="T_37b8f_row23_col19" class="data row23 col19" >0.91</td>
      <td id="T_37b8f_row23_col20" class="data row23 col20" >0.10</td>
      <td id="T_37b8f_row23_col21" class="data row23 col21" >0.91</td>
      <td id="T_37b8f_row23_col22" class="data row23 col22" >0.91</td>
      <td id="T_37b8f_row23_col23" class="data row23 col23" >nan</td>
      <td id="T_37b8f_row23_col24" class="data row23 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_37b8f_level0_row24" class="row_heading level0 row24" >annual_premium_q_trans_normal</th>
      <td id="T_37b8f_row24_col0" class="data row24 col0" >-0.00</td>
      <td id="T_37b8f_row24_col1" class="data row24 col1" >-0.00</td>
      <td id="T_37b8f_row24_col2" class="data row24 col2" >0.89</td>
      <td id="T_37b8f_row24_col3" class="data row24 col3" >-0.07</td>
      <td id="T_37b8f_row24_col4" class="data row24 col4" >-0.00</td>
      <td id="T_37b8f_row24_col5" class="data row24 col5" >-0.05</td>
      <td id="T_37b8f_row24_col6" class="data row24 col6" >0.05</td>
      <td id="T_37b8f_row24_col7" class="data row24 col7" >-0.06</td>
      <td id="T_37b8f_row24_col8" class="data row24 col8" >0.04</td>
      <td id="T_37b8f_row24_col9" class="data row24 col9" >0.03</td>
      <td id="T_37b8f_row24_col10" class="data row24 col10" >0.03</td>
      <td id="T_37b8f_row24_col11" class="data row24 col11" >-0.03</td>
      <td id="T_37b8f_row24_col12" class="data row24 col12" >-0.05</td>
      <td id="T_37b8f_row24_col13" class="data row24 col13" >0.05</td>
      <td id="T_37b8f_row24_col14" class="data row24 col14" >0.01</td>
      <td id="T_37b8f_row24_col15" class="data row24 col15" >-0.01</td>
      <td id="T_37b8f_row24_col16" class="data row24 col16" >0.89</td>
      <td id="T_37b8f_row24_col17" class="data row24 col17" >0.60</td>
      <td id="T_37b8f_row24_col18" class="data row24 col18" >0.89</td>
      <td id="T_37b8f_row24_col19" class="data row24 col19" >0.89</td>
      <td id="T_37b8f_row24_col20" class="data row24 col20" >0.02</td>
      <td id="T_37b8f_row24_col21" class="data row24 col21" >0.89</td>
      <td id="T_37b8f_row24_col22" class="data row24 col22" >0.89</td>
      <td id="T_37b8f_row24_col23" class="data row24 col23" >0.89</td>
      <td id="T_37b8f_row24_col24" class="data row24 col24" >nan</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Korrelationsplot erstellen</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">X_test_df_fe</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">corr</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="p">(</span><span class="n">corr</span>
 <span class="o">.</span><span class="n">style</span>
 <span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;crest&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
 <span class="o">.</span><span class="n">highlight_null</span><span class="p">(</span><span class="n">null_color</span><span class="o">=</span><span class="s1">&#39;#f1f1f1&#39;</span><span class="p">)</span>  <span class="c1"># Color NaNs grey</span>
 <span class="o">.</span><span class="n">set_precision</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\aster\AppData\Local\Temp/ipykernel_18368/4252982992.py:6: FutureWarning:

this method is deprecated in favour of `Styler.format(precision=..)`
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_8d113_row0_col0, #T_8d113_row0_col1, #T_8d113_row0_col2, #T_8d113_row0_col3, #T_8d113_row0_col4, #T_8d113_row0_col5, #T_8d113_row0_col6, #T_8d113_row0_col7, #T_8d113_row0_col8, #T_8d113_row0_col9, #T_8d113_row0_col10, #T_8d113_row0_col11, #T_8d113_row0_col12, #T_8d113_row0_col13, #T_8d113_row0_col14, #T_8d113_row0_col15, #T_8d113_row0_col16, #T_8d113_row0_col17, #T_8d113_row0_col18, #T_8d113_row0_col19, #T_8d113_row0_col20, #T_8d113_row0_col21, #T_8d113_row0_col22, #T_8d113_row0_col23, #T_8d113_row0_col24, #T_8d113_row1_col1, #T_8d113_row1_col2, #T_8d113_row1_col3, #T_8d113_row1_col4, #T_8d113_row1_col5, #T_8d113_row1_col6, #T_8d113_row1_col7, #T_8d113_row1_col8, #T_8d113_row1_col9, #T_8d113_row1_col10, #T_8d113_row1_col11, #T_8d113_row1_col12, #T_8d113_row1_col13, #T_8d113_row1_col14, #T_8d113_row1_col15, #T_8d113_row1_col16, #T_8d113_row1_col17, #T_8d113_row1_col18, #T_8d113_row1_col19, #T_8d113_row1_col20, #T_8d113_row1_col21, #T_8d113_row1_col22, #T_8d113_row1_col23, #T_8d113_row1_col24, #T_8d113_row2_col2, #T_8d113_row2_col3, #T_8d113_row2_col4, #T_8d113_row2_col5, #T_8d113_row2_col6, #T_8d113_row2_col7, #T_8d113_row2_col8, #T_8d113_row2_col9, #T_8d113_row2_col10, #T_8d113_row2_col11, #T_8d113_row2_col12, #T_8d113_row2_col13, #T_8d113_row2_col14, #T_8d113_row2_col15, #T_8d113_row2_col16, #T_8d113_row2_col17, #T_8d113_row2_col18, #T_8d113_row2_col19, #T_8d113_row2_col20, #T_8d113_row2_col21, #T_8d113_row2_col22, #T_8d113_row2_col23, #T_8d113_row2_col24, #T_8d113_row3_col3, #T_8d113_row3_col4, #T_8d113_row3_col5, #T_8d113_row3_col6, #T_8d113_row3_col7, #T_8d113_row3_col8, #T_8d113_row3_col9, #T_8d113_row3_col10, #T_8d113_row3_col11, #T_8d113_row3_col12, #T_8d113_row3_col13, #T_8d113_row3_col14, #T_8d113_row3_col15, #T_8d113_row3_col16, #T_8d113_row3_col17, #T_8d113_row3_col18, #T_8d113_row3_col19, #T_8d113_row3_col20, #T_8d113_row3_col21, #T_8d113_row3_col22, #T_8d113_row3_col23, #T_8d113_row3_col24, #T_8d113_row4_col4, #T_8d113_row4_col5, #T_8d113_row4_col6, #T_8d113_row4_col7, #T_8d113_row4_col8, #T_8d113_row4_col9, #T_8d113_row4_col10, #T_8d113_row4_col11, #T_8d113_row4_col12, #T_8d113_row4_col13, #T_8d113_row4_col14, #T_8d113_row4_col15, #T_8d113_row4_col16, #T_8d113_row4_col17, #T_8d113_row4_col18, #T_8d113_row4_col19, #T_8d113_row4_col20, #T_8d113_row4_col21, #T_8d113_row4_col22, #T_8d113_row4_col23, #T_8d113_row4_col24, #T_8d113_row5_col5, #T_8d113_row5_col6, #T_8d113_row5_col7, #T_8d113_row5_col8, #T_8d113_row5_col9, #T_8d113_row5_col10, #T_8d113_row5_col11, #T_8d113_row5_col12, #T_8d113_row5_col13, #T_8d113_row5_col14, #T_8d113_row5_col15, #T_8d113_row5_col16, #T_8d113_row5_col17, #T_8d113_row5_col18, #T_8d113_row5_col19, #T_8d113_row5_col20, #T_8d113_row5_col21, #T_8d113_row5_col22, #T_8d113_row5_col23, #T_8d113_row5_col24, #T_8d113_row6_col6, #T_8d113_row6_col7, #T_8d113_row6_col8, #T_8d113_row6_col9, #T_8d113_row6_col10, #T_8d113_row6_col11, #T_8d113_row6_col12, #T_8d113_row6_col13, #T_8d113_row6_col14, #T_8d113_row6_col15, #T_8d113_row6_col16, #T_8d113_row6_col17, #T_8d113_row6_col18, #T_8d113_row6_col19, #T_8d113_row6_col20, #T_8d113_row6_col21, #T_8d113_row6_col22, #T_8d113_row6_col23, #T_8d113_row6_col24, #T_8d113_row7_col7, #T_8d113_row7_col8, #T_8d113_row7_col9, #T_8d113_row7_col10, #T_8d113_row7_col11, #T_8d113_row7_col12, #T_8d113_row7_col13, #T_8d113_row7_col14, #T_8d113_row7_col15, #T_8d113_row7_col16, #T_8d113_row7_col17, #T_8d113_row7_col18, #T_8d113_row7_col19, #T_8d113_row7_col20, #T_8d113_row7_col21, #T_8d113_row7_col22, #T_8d113_row7_col23, #T_8d113_row7_col24, #T_8d113_row8_col8, #T_8d113_row8_col9, #T_8d113_row8_col10, #T_8d113_row8_col11, #T_8d113_row8_col12, #T_8d113_row8_col13, #T_8d113_row8_col14, #T_8d113_row8_col15, #T_8d113_row8_col16, #T_8d113_row8_col17, #T_8d113_row8_col18, #T_8d113_row8_col19, #T_8d113_row8_col20, #T_8d113_row8_col21, #T_8d113_row8_col22, #T_8d113_row8_col23, #T_8d113_row8_col24, #T_8d113_row9_col9, #T_8d113_row9_col10, #T_8d113_row9_col11, #T_8d113_row9_col12, #T_8d113_row9_col13, #T_8d113_row9_col14, #T_8d113_row9_col15, #T_8d113_row9_col16, #T_8d113_row9_col17, #T_8d113_row9_col18, #T_8d113_row9_col19, #T_8d113_row9_col20, #T_8d113_row9_col21, #T_8d113_row9_col22, #T_8d113_row9_col23, #T_8d113_row9_col24, #T_8d113_row10_col10, #T_8d113_row10_col11, #T_8d113_row10_col12, #T_8d113_row10_col13, #T_8d113_row10_col14, #T_8d113_row10_col15, #T_8d113_row10_col16, #T_8d113_row10_col17, #T_8d113_row10_col18, #T_8d113_row10_col19, #T_8d113_row10_col20, #T_8d113_row10_col21, #T_8d113_row10_col22, #T_8d113_row10_col23, #T_8d113_row10_col24, #T_8d113_row11_col11, #T_8d113_row11_col12, #T_8d113_row11_col13, #T_8d113_row11_col14, #T_8d113_row11_col15, #T_8d113_row11_col16, #T_8d113_row11_col17, #T_8d113_row11_col18, #T_8d113_row11_col19, #T_8d113_row11_col20, #T_8d113_row11_col21, #T_8d113_row11_col22, #T_8d113_row11_col23, #T_8d113_row11_col24, #T_8d113_row12_col12, #T_8d113_row12_col13, #T_8d113_row12_col14, #T_8d113_row12_col15, #T_8d113_row12_col16, #T_8d113_row12_col17, #T_8d113_row12_col18, #T_8d113_row12_col19, #T_8d113_row12_col20, #T_8d113_row12_col21, #T_8d113_row12_col22, #T_8d113_row12_col23, #T_8d113_row12_col24, #T_8d113_row13_col13, #T_8d113_row13_col14, #T_8d113_row13_col15, #T_8d113_row13_col16, #T_8d113_row13_col17, #T_8d113_row13_col18, #T_8d113_row13_col19, #T_8d113_row13_col20, #T_8d113_row13_col21, #T_8d113_row13_col22, #T_8d113_row13_col23, #T_8d113_row13_col24, #T_8d113_row14_col14, #T_8d113_row14_col15, #T_8d113_row14_col16, #T_8d113_row14_col17, #T_8d113_row14_col18, #T_8d113_row14_col19, #T_8d113_row14_col20, #T_8d113_row14_col21, #T_8d113_row14_col22, #T_8d113_row14_col23, #T_8d113_row14_col24, #T_8d113_row15_col15, #T_8d113_row15_col16, #T_8d113_row15_col17, #T_8d113_row15_col18, #T_8d113_row15_col19, #T_8d113_row15_col20, #T_8d113_row15_col21, #T_8d113_row15_col22, #T_8d113_row15_col23, #T_8d113_row15_col24, #T_8d113_row16_col16, #T_8d113_row16_col17, #T_8d113_row16_col18, #T_8d113_row16_col19, #T_8d113_row16_col20, #T_8d113_row16_col21, #T_8d113_row16_col22, #T_8d113_row16_col23, #T_8d113_row16_col24, #T_8d113_row17_col17, #T_8d113_row17_col18, #T_8d113_row17_col19, #T_8d113_row17_col20, #T_8d113_row17_col21, #T_8d113_row17_col22, #T_8d113_row17_col23, #T_8d113_row17_col24, #T_8d113_row18_col18, #T_8d113_row18_col19, #T_8d113_row18_col20, #T_8d113_row18_col21, #T_8d113_row18_col22, #T_8d113_row18_col23, #T_8d113_row18_col24, #T_8d113_row19_col19, #T_8d113_row19_col20, #T_8d113_row19_col21, #T_8d113_row19_col22, #T_8d113_row19_col23, #T_8d113_row19_col24, #T_8d113_row20_col20, #T_8d113_row20_col21, #T_8d113_row20_col22, #T_8d113_row20_col23, #T_8d113_row20_col24, #T_8d113_row21_col21, #T_8d113_row21_col22, #T_8d113_row21_col23, #T_8d113_row21_col24, #T_8d113_row22_col22, #T_8d113_row22_col23, #T_8d113_row22_col24, #T_8d113_row23_col23, #T_8d113_row23_col24, #T_8d113_row24_col24 {
  background-color: #000000;
  color: #f1f1f1;
  background-color: #f1f1f1;
}
#T_8d113_row1_col0, #T_8d113_row7_col1, #T_8d113_row17_col0, #T_8d113_row17_col9, #T_8d113_row20_col1, #T_8d113_row24_col10 {
  background-color: #31828d;
  color: #f1f1f1;
}
#T_8d113_row2_col0, #T_8d113_row9_col2, #T_8d113_row16_col0, #T_8d113_row16_col9, #T_8d113_row18_col0, #T_8d113_row18_col9, #T_8d113_row19_col0, #T_8d113_row19_col9, #T_8d113_row21_col0, #T_8d113_row21_col9, #T_8d113_row22_col0, #T_8d113_row22_col9, #T_8d113_row24_col6, #T_8d113_row24_col13 {
  background-color: #2f818d;
  color: #f1f1f1;
}
#T_8d113_row2_col1, #T_8d113_row16_col1, #T_8d113_row17_col5, #T_8d113_row17_col7, #T_8d113_row17_col12, #T_8d113_row18_col1, #T_8d113_row19_col1, #T_8d113_row21_col1, #T_8d113_row22_col1, #T_8d113_row23_col1, #T_8d113_row23_col6, #T_8d113_row23_col13, #T_8d113_row23_col14, #T_8d113_row24_col15 {
  background-color: #35868d;
  color: #f1f1f1;
}
#T_8d113_row3_col0 {
  background-color: #6bb190;
  color: #f1f1f1;
}
#T_8d113_row3_col1, #T_8d113_row8_col1, #T_8d113_row14_col9 {
  background-color: #37888e;
  color: #f1f1f1;
}
#T_8d113_row3_col2, #T_8d113_row15_col3, #T_8d113_row16_col3, #T_8d113_row18_col3, #T_8d113_row19_col3, #T_8d113_row21_col3, #T_8d113_row22_col3 {
  background-color: #3d8e8e;
  color: #f1f1f1;
}
#T_8d113_row4_col0, #T_8d113_row4_col1, #T_8d113_row5_col2, #T_8d113_row5_col4, #T_8d113_row7_col2, #T_8d113_row7_col4, #T_8d113_row10_col2, #T_8d113_row11_col4, #T_8d113_row12_col2, #T_8d113_row12_col4, #T_8d113_row14_col1, #T_8d113_row14_col2, #T_8d113_row15_col4, #T_8d113_row16_col5, #T_8d113_row16_col7, #T_8d113_row16_col10, #T_8d113_row16_col12, #T_8d113_row16_col14, #T_8d113_row17_col1, #T_8d113_row17_col8, #T_8d113_row17_col11, #T_8d113_row17_col14, #T_8d113_row18_col5, #T_8d113_row18_col7, #T_8d113_row18_col10, #T_8d113_row18_col12, #T_8d113_row18_col14, #T_8d113_row19_col4, #T_8d113_row19_col5, #T_8d113_row19_col7, #T_8d113_row19_col10, #T_8d113_row19_col12, #T_8d113_row19_col14, #T_8d113_row20_col4, #T_8d113_row21_col5, #T_8d113_row21_col7, #T_8d113_row21_col10, #T_8d113_row21_col12, #T_8d113_row21_col14, #T_8d113_row22_col5, #T_8d113_row22_col7, #T_8d113_row22_col10, #T_8d113_row22_col12, #T_8d113_row22_col14, #T_8d113_row24_col0, #T_8d113_row24_col1 {
  background-color: #34858d;
  color: #f1f1f1;
}
#T_8d113_row4_col2, #T_8d113_row4_col3, #T_8d113_row6_col2, #T_8d113_row6_col4, #T_8d113_row8_col4, #T_8d113_row9_col4, #T_8d113_row10_col4, #T_8d113_row11_col2, #T_8d113_row13_col2, #T_8d113_row13_col4, #T_8d113_row14_col4, #T_8d113_row15_col1, #T_8d113_row15_col2, #T_8d113_row16_col6, #T_8d113_row16_col11, #T_8d113_row16_col13, #T_8d113_row16_col15, #T_8d113_row17_col10, #T_8d113_row17_col15, #T_8d113_row18_col6, #T_8d113_row18_col11, #T_8d113_row18_col13, #T_8d113_row18_col15, #T_8d113_row19_col6, #T_8d113_row19_col11, #T_8d113_row19_col13, #T_8d113_row19_col15, #T_8d113_row21_col4, #T_8d113_row21_col6, #T_8d113_row21_col11, #T_8d113_row21_col13, #T_8d113_row21_col15, #T_8d113_row22_col4, #T_8d113_row22_col6, #T_8d113_row22_col11, #T_8d113_row22_col13, #T_8d113_row22_col15, #T_8d113_row23_col4, #T_8d113_row24_col4 {
  background-color: #33858d;
  color: #f1f1f1;
}
#T_8d113_row5_col0, #T_8d113_row12_col0 {
  background-color: #20718b;
  color: #f1f1f1;
}
#T_8d113_row5_col1, #T_8d113_row11_col1, #T_8d113_row12_col1, #T_8d113_row23_col11, #T_8d113_row24_col9 {
  background-color: #31838d;
  color: #f1f1f1;
}
#T_8d113_row5_col3, #T_8d113_row11_col3, #T_8d113_row12_col3 {
  background-color: #46968f;
  color: #f1f1f1;
}
#T_8d113_row6_col0, #T_8d113_row13_col0 {
  background-color: #4a9a8f;
  color: #f1f1f1;
}
#T_8d113_row6_col1, #T_8d113_row10_col1, #T_8d113_row13_col1, #T_8d113_row23_col10 {
  background-color: #36878d;
  color: #f1f1f1;
}
#T_8d113_row6_col3, #T_8d113_row9_col0, #T_8d113_row10_col3, #T_8d113_row13_col3, #T_8d113_row20_col5, #T_8d113_row20_col12 {
  background-color: #22748b;
  color: #f1f1f1;
}
#T_8d113_row6_col5, #T_8d113_row11_col10, #T_8d113_row12_col6, #T_8d113_row13_col5, #T_8d113_row13_col12, #T_8d113_row15_col14 {
  background-color: #a5cd90;
  color: #000000;
}
#T_8d113_row7_col0 {
  background-color: #254c7f;
  color: #f1f1f1;
}
#T_8d113_row7_col3 {
  background-color: #62ac90;
  color: #f1f1f1;
}
#T_8d113_row7_col5, #T_8d113_row12_col7 {
  background-color: #1f6f8a;
  color: #f1f1f1;
}
#T_8d113_row7_col6, #T_8d113_row13_col7 {
  background-color: #4b9b90;
  color: #f1f1f1;
}
#T_8d113_row8_col0 {
  background-color: #89bf91;
  color: #000000;
}
#T_8d113_row8_col2, #T_8d113_row16_col8, #T_8d113_row18_col8, #T_8d113_row19_col8, #T_8d113_row21_col8, #T_8d113_row22_col8 {
  background-color: #35878d;
  color: #f1f1f1;
}
#T_8d113_row8_col3 {
  background-color: #205885;
  color: #f1f1f1;
}
#T_8d113_row8_col5, #T_8d113_row11_col8, #T_8d113_row12_col8 {
  background-color: #53a190;
  color: #f1f1f1;
}
#T_8d113_row8_col6, #T_8d113_row13_col8 {
  background-color: #1c6989;
  color: #f1f1f1;
}
#T_8d113_row8_col7 {
  background-color: #9ac791;
  color: #000000;
}
#T_8d113_row9_col1, #T_8d113_row16_col4, #T_8d113_row17_col6, #T_8d113_row17_col13, #T_8d113_row18_col4, #T_8d113_row23_col5, #T_8d113_row23_col12, #T_8d113_row23_col15, #T_8d113_row24_col14 {
  background-color: #33848d;
  color: #f1f1f1;
}
#T_8d113_row9_col3 {
  background-color: #40908e;
  color: #f1f1f1;
}
#T_8d113_row9_col5, #T_8d113_row12_col9 {
  background-color: #25778c;
  color: #f1f1f1;
}
#T_8d113_row9_col6, #T_8d113_row9_col8, #T_8d113_row13_col9 {
  background-color: #43938f;
  color: #f1f1f1;
}
#T_8d113_row9_col7, #T_8d113_row10_col9 {
  background-color: #45958f;
  color: #f1f1f1;
}
#T_8d113_row10_col0 {
  background-color: #4b9a8f;
  color: #f1f1f1;
}
#T_8d113_row10_col5, #T_8d113_row11_col6, #T_8d113_row12_col10, #T_8d113_row13_col11 {
  background-color: #8dc191;
  color: #000000;
}
#T_8d113_row10_col6, #T_8d113_row11_col5, #T_8d113_row12_col11, #T_8d113_row13_col10 {
  background-color: #29417a;
  color: #f1f1f1;
}
#T_8d113_row10_col7 {
  background-color: #4c9b90;
  color: #f1f1f1;
}
#T_8d113_row10_col8 {
  background-color: #1c6889;
  color: #f1f1f1;
}
#T_8d113_row11_col0 {
  background-color: #1f708b;
  color: #f1f1f1;
}
#T_8d113_row11_col7 {
  background-color: #1e6f8a;
  color: #f1f1f1;
}
#T_8d113_row11_col9, #T_8d113_row20_col9 {
  background-color: #23758b;
  color: #f1f1f1;
}
#T_8d113_row12_col5, #T_8d113_row13_col6, #T_8d113_row16_col2, #T_8d113_row18_col2, #T_8d113_row18_col16, #T_8d113_row19_col2, #T_8d113_row19_col16, #T_8d113_row19_col18, #T_8d113_row21_col2, #T_8d113_row21_col16, #T_8d113_row21_col18, #T_8d113_row21_col19, #T_8d113_row22_col2, #T_8d113_row22_col16, #T_8d113_row22_col18, #T_8d113_row22_col19, #T_8d113_row22_col21 {
  background-color: #2c3172;
  color: #f1f1f1;
}
#T_8d113_row14_col0 {
  background-color: #41918f;
  color: #f1f1f1;
}
#T_8d113_row14_col3 {
  background-color: #2a7d8c;
  color: #f1f1f1;
}
#T_8d113_row14_col5, #T_8d113_row14_col12, #T_8d113_row15_col6, #T_8d113_row15_col13, #T_8d113_row17_col3, #T_8d113_row24_col3 {
  background-color: #3a8b8e;
  color: #f1f1f1;
}
#T_8d113_row14_col6, #T_8d113_row14_col13, #T_8d113_row15_col5, #T_8d113_row15_col12 {
  background-color: #2d7f8c;
  color: #f1f1f1;
}
#T_8d113_row14_col7 {
  background-color: #40918f;
  color: #f1f1f1;
}
#T_8d113_row14_col8 {
  background-color: #26788c;
  color: #f1f1f1;
}
#T_8d113_row14_col10, #T_8d113_row15_col11, #T_8d113_row23_col0, #T_8d113_row23_col20 {
  background-color: #2c7e8c;
  color: #f1f1f1;
}
#T_8d113_row14_col11, #T_8d113_row15_col10 {
  background-color: #3b8c8e;
  color: #f1f1f1;
}
#T_8d113_row15_col0 {
  background-color: #27798c;
  color: #f1f1f1;
}
#T_8d113_row15_col7 {
  background-color: #277a8c;
  color: #f1f1f1;
}
#T_8d113_row15_col8 {
  background-color: #41928f;
  color: #f1f1f1;
}
#T_8d113_row15_col9, #T_8d113_row20_col17, #T_8d113_row24_col8 {
  background-color: #30828d;
  color: #f1f1f1;
}
#T_8d113_row17_col2, #T_8d113_row17_col16, #T_8d113_row18_col17, #T_8d113_row21_col17, #T_8d113_row22_col17 {
  background-color: #244e81;
  color: #f1f1f1;
}
#T_8d113_row17_col4 {
  background-color: #225182;
  color: #f1f1f1;
}
#T_8d113_row19_col17 {
  background-color: #234f81;
  color: #f1f1f1;
}
#T_8d113_row20_col0, #T_8d113_row23_col2, #T_8d113_row23_col16, #T_8d113_row23_col18, #T_8d113_row23_col19, #T_8d113_row23_col21, #T_8d113_row23_col22 {
  background-color: #2b3875;
  color: #f1f1f1;
}
#T_8d113_row20_col2, #T_8d113_row20_col16, #T_8d113_row20_col18, #T_8d113_row20_col19, #T_8d113_row21_col20, #T_8d113_row22_col20 {
  background-color: #2d808c;
  color: #f1f1f1;
}
#T_8d113_row20_col3 {
  background-color: #65ad90;
  color: #f1f1f1;
}
#T_8d113_row20_col6, #T_8d113_row20_col10, #T_8d113_row20_col13 {
  background-color: #47978f;
  color: #f1f1f1;
}
#T_8d113_row20_col7 {
  background-color: #215584;
  color: #f1f1f1;
}
#T_8d113_row20_col8 {
  background-color: #78b891;
  color: #f1f1f1;
}
#T_8d113_row20_col11 {
  background-color: #21738b;
  color: #f1f1f1;
}
#T_8d113_row20_col14, #T_8d113_row23_col3 {
  background-color: #3f8f8e;
  color: #f1f1f1;
}
#T_8d113_row20_col15 {
  background-color: #287b8c;
  color: #f1f1f1;
}
#T_8d113_row23_col7, #T_8d113_row24_col20 {
  background-color: #32848d;
  color: #f1f1f1;
}
#T_8d113_row23_col8, #T_8d113_row24_col5, #T_8d113_row24_col12 {
  background-color: #38898e;
  color: #f1f1f1;
}
#T_8d113_row23_col9 {
  background-color: #2e808d;
  color: #f1f1f1;
}
#T_8d113_row23_col17 {
  background-color: #215483;
  color: #f1f1f1;
}
#T_8d113_row24_col2, #T_8d113_row24_col16, #T_8d113_row24_col18, #T_8d113_row24_col19, #T_8d113_row24_col21, #T_8d113_row24_col22 {
  background-color: #2b3a76;
  color: #f1f1f1;
}
#T_8d113_row24_col7 {
  background-color: #388a8e;
  color: #f1f1f1;
}
#T_8d113_row24_col11 {
  background-color: #37888d;
  color: #f1f1f1;
}
#T_8d113_row24_col17 {
  background-color: #215583;
  color: #f1f1f1;
}
#T_8d113_row24_col23 {
  background-color: #2b3b76;
  color: #f1f1f1;
}
</style>
<table id="T_8d113_">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th class="col_heading level0 col0" >age</th>
      <th class="col_heading level0 col1" >region_code</th>
      <th class="col_heading level0 col2" >annual_premium</th>
      <th class="col_heading level0 col3" >policy_sales_channel</th>
      <th class="col_heading level0 col4" >vintage</th>
      <th class="col_heading level0 col5" >driving_license_No</th>
      <th class="col_heading level0 col6" >driving_license_Yes</th>
      <th class="col_heading level0 col7" >vehicle_age_1-2 Year</th>
      <th class="col_heading level0 col8" >vehicle_age_< 1 Year</th>
      <th class="col_heading level0 col9" >vehicle_age_> 2 Years</th>
      <th class="col_heading level0 col10" >vehicle_damage_No</th>
      <th class="col_heading level0 col11" >vehicle_damage_Yes</th>
      <th class="col_heading level0 col12" >previously_insured_No</th>
      <th class="col_heading level0 col13" >previously_insured_Yes</th>
      <th class="col_heading level0 col14" >gender_Female</th>
      <th class="col_heading level0 col15" >gender_Male</th>
      <th class="col_heading level0 col16" >mean_annual_vintage</th>
      <th class="col_heading level0 col17" >prod_annual_vintage</th>
      <th class="col_heading level0 col18" >sum_annual_vintage</th>
      <th class="col_heading level0 col19" >std_annual_vintage</th>
      <th class="col_heading level0 col20" >age_bin</th>
      <th class="col_heading level0 col21" >annual_premium_scaled</th>
      <th class="col_heading level0 col22" >annual_premium_min_max_scaled</th>
      <th class="col_heading level0 col23" >annual_premium_q_trans_uniform</th>
      <th class="col_heading level0 col24" >annual_premium_q_trans_normal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_8d113_level0_row0" class="row_heading level0 row0" >age</th>
      <td id="T_8d113_row0_col0" class="data row0 col0" >nan</td>
      <td id="T_8d113_row0_col1" class="data row0 col1" >nan</td>
      <td id="T_8d113_row0_col2" class="data row0 col2" >nan</td>
      <td id="T_8d113_row0_col3" class="data row0 col3" >nan</td>
      <td id="T_8d113_row0_col4" class="data row0 col4" >nan</td>
      <td id="T_8d113_row0_col5" class="data row0 col5" >nan</td>
      <td id="T_8d113_row0_col6" class="data row0 col6" >nan</td>
      <td id="T_8d113_row0_col7" class="data row0 col7" >nan</td>
      <td id="T_8d113_row0_col8" class="data row0 col8" >nan</td>
      <td id="T_8d113_row0_col9" class="data row0 col9" >nan</td>
      <td id="T_8d113_row0_col10" class="data row0 col10" >nan</td>
      <td id="T_8d113_row0_col11" class="data row0 col11" >nan</td>
      <td id="T_8d113_row0_col12" class="data row0 col12" >nan</td>
      <td id="T_8d113_row0_col13" class="data row0 col13" >nan</td>
      <td id="T_8d113_row0_col14" class="data row0 col14" >nan</td>
      <td id="T_8d113_row0_col15" class="data row0 col15" >nan</td>
      <td id="T_8d113_row0_col16" class="data row0 col16" >nan</td>
      <td id="T_8d113_row0_col17" class="data row0 col17" >nan</td>
      <td id="T_8d113_row0_col18" class="data row0 col18" >nan</td>
      <td id="T_8d113_row0_col19" class="data row0 col19" >nan</td>
      <td id="T_8d113_row0_col20" class="data row0 col20" >nan</td>
      <td id="T_8d113_row0_col21" class="data row0 col21" >nan</td>
      <td id="T_8d113_row0_col22" class="data row0 col22" >nan</td>
      <td id="T_8d113_row0_col23" class="data row0 col23" >nan</td>
      <td id="T_8d113_row0_col24" class="data row0 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row1" class="row_heading level0 row1" >region_code</th>
      <td id="T_8d113_row1_col0" class="data row1 col0" >0.04</td>
      <td id="T_8d113_row1_col1" class="data row1 col1" >nan</td>
      <td id="T_8d113_row1_col2" class="data row1 col2" >nan</td>
      <td id="T_8d113_row1_col3" class="data row1 col3" >nan</td>
      <td id="T_8d113_row1_col4" class="data row1 col4" >nan</td>
      <td id="T_8d113_row1_col5" class="data row1 col5" >nan</td>
      <td id="T_8d113_row1_col6" class="data row1 col6" >nan</td>
      <td id="T_8d113_row1_col7" class="data row1 col7" >nan</td>
      <td id="T_8d113_row1_col8" class="data row1 col8" >nan</td>
      <td id="T_8d113_row1_col9" class="data row1 col9" >nan</td>
      <td id="T_8d113_row1_col10" class="data row1 col10" >nan</td>
      <td id="T_8d113_row1_col11" class="data row1 col11" >nan</td>
      <td id="T_8d113_row1_col12" class="data row1 col12" >nan</td>
      <td id="T_8d113_row1_col13" class="data row1 col13" >nan</td>
      <td id="T_8d113_row1_col14" class="data row1 col14" >nan</td>
      <td id="T_8d113_row1_col15" class="data row1 col15" >nan</td>
      <td id="T_8d113_row1_col16" class="data row1 col16" >nan</td>
      <td id="T_8d113_row1_col17" class="data row1 col17" >nan</td>
      <td id="T_8d113_row1_col18" class="data row1 col18" >nan</td>
      <td id="T_8d113_row1_col19" class="data row1 col19" >nan</td>
      <td id="T_8d113_row1_col20" class="data row1 col20" >nan</td>
      <td id="T_8d113_row1_col21" class="data row1 col21" >nan</td>
      <td id="T_8d113_row1_col22" class="data row1 col22" >nan</td>
      <td id="T_8d113_row1_col23" class="data row1 col23" >nan</td>
      <td id="T_8d113_row1_col24" class="data row1 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row2" class="row_heading level0 row2" >annual_premium</th>
      <td id="T_8d113_row2_col0" class="data row2 col0" >0.06</td>
      <td id="T_8d113_row2_col1" class="data row2 col1" >-0.01</td>
      <td id="T_8d113_row2_col2" class="data row2 col2" >nan</td>
      <td id="T_8d113_row2_col3" class="data row2 col3" >nan</td>
      <td id="T_8d113_row2_col4" class="data row2 col4" >nan</td>
      <td id="T_8d113_row2_col5" class="data row2 col5" >nan</td>
      <td id="T_8d113_row2_col6" class="data row2 col6" >nan</td>
      <td id="T_8d113_row2_col7" class="data row2 col7" >nan</td>
      <td id="T_8d113_row2_col8" class="data row2 col8" >nan</td>
      <td id="T_8d113_row2_col9" class="data row2 col9" >nan</td>
      <td id="T_8d113_row2_col10" class="data row2 col10" >nan</td>
      <td id="T_8d113_row2_col11" class="data row2 col11" >nan</td>
      <td id="T_8d113_row2_col12" class="data row2 col12" >nan</td>
      <td id="T_8d113_row2_col13" class="data row2 col13" >nan</td>
      <td id="T_8d113_row2_col14" class="data row2 col14" >nan</td>
      <td id="T_8d113_row2_col15" class="data row2 col15" >nan</td>
      <td id="T_8d113_row2_col16" class="data row2 col16" >nan</td>
      <td id="T_8d113_row2_col17" class="data row2 col17" >nan</td>
      <td id="T_8d113_row2_col18" class="data row2 col18" >nan</td>
      <td id="T_8d113_row2_col19" class="data row2 col19" >nan</td>
      <td id="T_8d113_row2_col20" class="data row2 col20" >nan</td>
      <td id="T_8d113_row2_col21" class="data row2 col21" >nan</td>
      <td id="T_8d113_row2_col22" class="data row2 col22" >nan</td>
      <td id="T_8d113_row2_col23" class="data row2 col23" >nan</td>
      <td id="T_8d113_row2_col24" class="data row2 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row3" class="row_heading level0 row3" >policy_sales_channel</th>
      <td id="T_8d113_row3_col0" class="data row3 col0" >-0.58</td>
      <td id="T_8d113_row3_col1" class="data row3 col1" >-0.04</td>
      <td id="T_8d113_row3_col2" class="data row3 col2" >-0.11</td>
      <td id="T_8d113_row3_col3" class="data row3 col3" >nan</td>
      <td id="T_8d113_row3_col4" class="data row3 col4" >nan</td>
      <td id="T_8d113_row3_col5" class="data row3 col5" >nan</td>
      <td id="T_8d113_row3_col6" class="data row3 col6" >nan</td>
      <td id="T_8d113_row3_col7" class="data row3 col7" >nan</td>
      <td id="T_8d113_row3_col8" class="data row3 col8" >nan</td>
      <td id="T_8d113_row3_col9" class="data row3 col9" >nan</td>
      <td id="T_8d113_row3_col10" class="data row3 col10" >nan</td>
      <td id="T_8d113_row3_col11" class="data row3 col11" >nan</td>
      <td id="T_8d113_row3_col12" class="data row3 col12" >nan</td>
      <td id="T_8d113_row3_col13" class="data row3 col13" >nan</td>
      <td id="T_8d113_row3_col14" class="data row3 col14" >nan</td>
      <td id="T_8d113_row3_col15" class="data row3 col15" >nan</td>
      <td id="T_8d113_row3_col16" class="data row3 col16" >nan</td>
      <td id="T_8d113_row3_col17" class="data row3 col17" >nan</td>
      <td id="T_8d113_row3_col18" class="data row3 col18" >nan</td>
      <td id="T_8d113_row3_col19" class="data row3 col19" >nan</td>
      <td id="T_8d113_row3_col20" class="data row3 col20" >nan</td>
      <td id="T_8d113_row3_col21" class="data row3 col21" >nan</td>
      <td id="T_8d113_row3_col22" class="data row3 col22" >nan</td>
      <td id="T_8d113_row3_col23" class="data row3 col23" >nan</td>
      <td id="T_8d113_row3_col24" class="data row3 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row4" class="row_heading level0 row4" >vintage</th>
      <td id="T_8d113_row4_col0" class="data row4 col0" >-0.00</td>
      <td id="T_8d113_row4_col1" class="data row4 col1" >-0.00</td>
      <td id="T_8d113_row4_col2" class="data row4 col2" >0.00</td>
      <td id="T_8d113_row4_col3" class="data row4 col3" >0.00</td>
      <td id="T_8d113_row4_col4" class="data row4 col4" >nan</td>
      <td id="T_8d113_row4_col5" class="data row4 col5" >nan</td>
      <td id="T_8d113_row4_col6" class="data row4 col6" >nan</td>
      <td id="T_8d113_row4_col7" class="data row4 col7" >nan</td>
      <td id="T_8d113_row4_col8" class="data row4 col8" >nan</td>
      <td id="T_8d113_row4_col9" class="data row4 col9" >nan</td>
      <td id="T_8d113_row4_col10" class="data row4 col10" >nan</td>
      <td id="T_8d113_row4_col11" class="data row4 col11" >nan</td>
      <td id="T_8d113_row4_col12" class="data row4 col12" >nan</td>
      <td id="T_8d113_row4_col13" class="data row4 col13" >nan</td>
      <td id="T_8d113_row4_col14" class="data row4 col14" >nan</td>
      <td id="T_8d113_row4_col15" class="data row4 col15" >nan</td>
      <td id="T_8d113_row4_col16" class="data row4 col16" >nan</td>
      <td id="T_8d113_row4_col17" class="data row4 col17" >nan</td>
      <td id="T_8d113_row4_col18" class="data row4 col18" >nan</td>
      <td id="T_8d113_row4_col19" class="data row4 col19" >nan</td>
      <td id="T_8d113_row4_col20" class="data row4 col20" >nan</td>
      <td id="T_8d113_row4_col21" class="data row4 col21" >nan</td>
      <td id="T_8d113_row4_col22" class="data row4 col22" >nan</td>
      <td id="T_8d113_row4_col23" class="data row4 col23" >nan</td>
      <td id="T_8d113_row4_col24" class="data row4 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row5" class="row_heading level0 row5" >driving_license_No</th>
      <td id="T_8d113_row5_col0" class="data row5 col0" >0.27</td>
      <td id="T_8d113_row5_col1" class="data row5 col1" >0.03</td>
      <td id="T_8d113_row5_col2" class="data row5 col2" >-0.01</td>
      <td id="T_8d113_row5_col3" class="data row5 col3" >-0.22</td>
      <td id="T_8d113_row5_col4" class="data row5 col4" >-0.01</td>
      <td id="T_8d113_row5_col5" class="data row5 col5" >nan</td>
      <td id="T_8d113_row5_col6" class="data row5 col6" >nan</td>
      <td id="T_8d113_row5_col7" class="data row5 col7" >nan</td>
      <td id="T_8d113_row5_col8" class="data row5 col8" >nan</td>
      <td id="T_8d113_row5_col9" class="data row5 col9" >nan</td>
      <td id="T_8d113_row5_col10" class="data row5 col10" >nan</td>
      <td id="T_8d113_row5_col11" class="data row5 col11" >nan</td>
      <td id="T_8d113_row5_col12" class="data row5 col12" >nan</td>
      <td id="T_8d113_row5_col13" class="data row5 col13" >nan</td>
      <td id="T_8d113_row5_col14" class="data row5 col14" >nan</td>
      <td id="T_8d113_row5_col15" class="data row5 col15" >nan</td>
      <td id="T_8d113_row5_col16" class="data row5 col16" >nan</td>
      <td id="T_8d113_row5_col17" class="data row5 col17" >nan</td>
      <td id="T_8d113_row5_col18" class="data row5 col18" >nan</td>
      <td id="T_8d113_row5_col19" class="data row5 col19" >nan</td>
      <td id="T_8d113_row5_col20" class="data row5 col20" >nan</td>
      <td id="T_8d113_row5_col21" class="data row5 col21" >nan</td>
      <td id="T_8d113_row5_col22" class="data row5 col22" >nan</td>
      <td id="T_8d113_row5_col23" class="data row5 col23" >nan</td>
      <td id="T_8d113_row5_col24" class="data row5 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row6" class="row_heading level0 row6" >driving_license_Yes</th>
      <td id="T_8d113_row6_col0" class="data row6 col0" >-0.27</td>
      <td id="T_8d113_row6_col1" class="data row6 col1" >-0.03</td>
      <td id="T_8d113_row6_col2" class="data row6 col2" >0.01</td>
      <td id="T_8d113_row6_col3" class="data row6 col3" >0.22</td>
      <td id="T_8d113_row6_col4" class="data row6 col4" >0.01</td>
      <td id="T_8d113_row6_col5" class="data row6 col5" >-1.00</td>
      <td id="T_8d113_row6_col6" class="data row6 col6" >nan</td>
      <td id="T_8d113_row6_col7" class="data row6 col7" >nan</td>
      <td id="T_8d113_row6_col8" class="data row6 col8" >nan</td>
      <td id="T_8d113_row6_col9" class="data row6 col9" >nan</td>
      <td id="T_8d113_row6_col10" class="data row6 col10" >nan</td>
      <td id="T_8d113_row6_col11" class="data row6 col11" >nan</td>
      <td id="T_8d113_row6_col12" class="data row6 col12" >nan</td>
      <td id="T_8d113_row6_col13" class="data row6 col13" >nan</td>
      <td id="T_8d113_row6_col14" class="data row6 col14" >nan</td>
      <td id="T_8d113_row6_col15" class="data row6 col15" >nan</td>
      <td id="T_8d113_row6_col16" class="data row6 col16" >nan</td>
      <td id="T_8d113_row6_col17" class="data row6 col17" >nan</td>
      <td id="T_8d113_row6_col18" class="data row6 col18" >nan</td>
      <td id="T_8d113_row6_col19" class="data row6 col19" >nan</td>
      <td id="T_8d113_row6_col20" class="data row6 col20" >nan</td>
      <td id="T_8d113_row6_col21" class="data row6 col21" >nan</td>
      <td id="T_8d113_row6_col22" class="data row6 col22" >nan</td>
      <td id="T_8d113_row6_col23" class="data row6 col23" >nan</td>
      <td id="T_8d113_row6_col24" class="data row6 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row7" class="row_heading level0 row7" >vehicle_age_1-2 Year</th>
      <td id="T_8d113_row7_col0" class="data row7 col0" >0.71</td>
      <td id="T_8d113_row7_col1" class="data row7 col1" >0.04</td>
      <td id="T_8d113_row7_col2" class="data row7 col2" >-0.01</td>
      <td id="T_8d113_row7_col3" class="data row7 col3" >-0.51</td>
      <td id="T_8d113_row7_col4" class="data row7 col4" >-0.01</td>
      <td id="T_8d113_row7_col5" class="data row7 col5" >0.29</td>
      <td id="T_8d113_row7_col6" class="data row7 col6" >-0.29</td>
      <td id="T_8d113_row7_col7" class="data row7 col7" >nan</td>
      <td id="T_8d113_row7_col8" class="data row7 col8" >nan</td>
      <td id="T_8d113_row7_col9" class="data row7 col9" >nan</td>
      <td id="T_8d113_row7_col10" class="data row7 col10" >nan</td>
      <td id="T_8d113_row7_col11" class="data row7 col11" >nan</td>
      <td id="T_8d113_row7_col12" class="data row7 col12" >nan</td>
      <td id="T_8d113_row7_col13" class="data row7 col13" >nan</td>
      <td id="T_8d113_row7_col14" class="data row7 col14" >nan</td>
      <td id="T_8d113_row7_col15" class="data row7 col15" >nan</td>
      <td id="T_8d113_row7_col16" class="data row7 col16" >nan</td>
      <td id="T_8d113_row7_col17" class="data row7 col17" >nan</td>
      <td id="T_8d113_row7_col18" class="data row7 col18" >nan</td>
      <td id="T_8d113_row7_col19" class="data row7 col19" >nan</td>
      <td id="T_8d113_row7_col20" class="data row7 col20" >nan</td>
      <td id="T_8d113_row7_col21" class="data row7 col21" >nan</td>
      <td id="T_8d113_row7_col22" class="data row7 col22" >nan</td>
      <td id="T_8d113_row7_col23" class="data row7 col23" >nan</td>
      <td id="T_8d113_row7_col24" class="data row7 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row8" class="row_heading level0 row8" >vehicle_age_< 1 Year</th>
      <td id="T_8d113_row8_col0" class="data row8 col0" >-0.80</td>
      <td id="T_8d113_row8_col1" class="data row8 col1" >-0.04</td>
      <td id="T_8d113_row8_col2" class="data row8 col2" >-0.02</td>
      <td id="T_8d113_row8_col3" class="data row8 col3" >0.57</td>
      <td id="T_8d113_row8_col4" class="data row8 col4" >0.01</td>
      <td id="T_8d113_row8_col5" class="data row8 col5" >-0.36</td>
      <td id="T_8d113_row8_col6" class="data row8 col6" >0.36</td>
      <td id="T_8d113_row8_col7" class="data row8 col7" >-0.92</td>
      <td id="T_8d113_row8_col8" class="data row8 col8" >nan</td>
      <td id="T_8d113_row8_col9" class="data row8 col9" >nan</td>
      <td id="T_8d113_row8_col10" class="data row8 col10" >nan</td>
      <td id="T_8d113_row8_col11" class="data row8 col11" >nan</td>
      <td id="T_8d113_row8_col12" class="data row8 col12" >nan</td>
      <td id="T_8d113_row8_col13" class="data row8 col13" >nan</td>
      <td id="T_8d113_row8_col14" class="data row8 col14" >nan</td>
      <td id="T_8d113_row8_col15" class="data row8 col15" >nan</td>
      <td id="T_8d113_row8_col16" class="data row8 col16" >nan</td>
      <td id="T_8d113_row8_col17" class="data row8 col17" >nan</td>
      <td id="T_8d113_row8_col18" class="data row8 col18" >nan</td>
      <td id="T_8d113_row8_col19" class="data row8 col19" >nan</td>
      <td id="T_8d113_row8_col20" class="data row8 col20" >nan</td>
      <td id="T_8d113_row8_col21" class="data row8 col21" >nan</td>
      <td id="T_8d113_row8_col22" class="data row8 col22" >nan</td>
      <td id="T_8d113_row8_col23" class="data row8 col23" >nan</td>
      <td id="T_8d113_row8_col24" class="data row8 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row9" class="row_heading level0 row9" >vehicle_age_> 2 Years</th>
      <td id="T_8d113_row9_col0" class="data row9 col0" >0.22</td>
      <td id="T_8d113_row9_col1" class="data row9 col1" >0.01</td>
      <td id="T_8d113_row9_col2" class="data row9 col2" >0.06</td>
      <td id="T_8d113_row9_col3" class="data row9 col3" >-0.14</td>
      <td id="T_8d113_row9_col4" class="data row9 col4" >0.00</td>
      <td id="T_8d113_row9_col5" class="data row9 col5" >0.19</td>
      <td id="T_8d113_row9_col6" class="data row9 col6" >-0.19</td>
      <td id="T_8d113_row9_col7" class="data row9 col7" >-0.21</td>
      <td id="T_8d113_row9_col8" class="data row9 col8" >-0.18</td>
      <td id="T_8d113_row9_col9" class="data row9 col9" >nan</td>
      <td id="T_8d113_row9_col10" class="data row9 col10" >nan</td>
      <td id="T_8d113_row9_col11" class="data row9 col11" >nan</td>
      <td id="T_8d113_row9_col12" class="data row9 col12" >nan</td>
      <td id="T_8d113_row9_col13" class="data row9 col13" >nan</td>
      <td id="T_8d113_row9_col14" class="data row9 col14" >nan</td>
      <td id="T_8d113_row9_col15" class="data row9 col15" >nan</td>
      <td id="T_8d113_row9_col16" class="data row9 col16" >nan</td>
      <td id="T_8d113_row9_col17" class="data row9 col17" >nan</td>
      <td id="T_8d113_row9_col18" class="data row9 col18" >nan</td>
      <td id="T_8d113_row9_col19" class="data row9 col19" >nan</td>
      <td id="T_8d113_row9_col20" class="data row9 col20" >nan</td>
      <td id="T_8d113_row9_col21" class="data row9 col21" >nan</td>
      <td id="T_8d113_row9_col22" class="data row9 col22" >nan</td>
      <td id="T_8d113_row9_col23" class="data row9 col23" >nan</td>
      <td id="T_8d113_row9_col24" class="data row9 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row10" class="row_heading level0 row10" >vehicle_damage_No</th>
      <td id="T_8d113_row10_col0" class="data row10 col0" >-0.28</td>
      <td id="T_8d113_row10_col1" class="data row10 col1" >-0.03</td>
      <td id="T_8d113_row10_col2" class="data row10 col2" >-0.01</td>
      <td id="T_8d113_row10_col3" class="data row10 col3" >0.23</td>
      <td id="T_8d113_row10_col4" class="data row10 col4" >0.01</td>
      <td id="T_8d113_row10_col5" class="data row10 col5" >-0.82</td>
      <td id="T_8d113_row10_col6" class="data row10 col6" >0.82</td>
      <td id="T_8d113_row10_col7" class="data row10 col7" >-0.29</td>
      <td id="T_8d113_row10_col8" class="data row10 col8" >0.37</td>
      <td id="T_8d113_row10_col9" class="data row10 col9" >-0.20</td>
      <td id="T_8d113_row10_col10" class="data row10 col10" >nan</td>
      <td id="T_8d113_row10_col11" class="data row10 col11" >nan</td>
      <td id="T_8d113_row10_col12" class="data row10 col12" >nan</td>
      <td id="T_8d113_row10_col13" class="data row10 col13" >nan</td>
      <td id="T_8d113_row10_col14" class="data row10 col14" >nan</td>
      <td id="T_8d113_row10_col15" class="data row10 col15" >nan</td>
      <td id="T_8d113_row10_col16" class="data row10 col16" >nan</td>
      <td id="T_8d113_row10_col17" class="data row10 col17" >nan</td>
      <td id="T_8d113_row10_col18" class="data row10 col18" >nan</td>
      <td id="T_8d113_row10_col19" class="data row10 col19" >nan</td>
      <td id="T_8d113_row10_col20" class="data row10 col20" >nan</td>
      <td id="T_8d113_row10_col21" class="data row10 col21" >nan</td>
      <td id="T_8d113_row10_col22" class="data row10 col22" >nan</td>
      <td id="T_8d113_row10_col23" class="data row10 col23" >nan</td>
      <td id="T_8d113_row10_col24" class="data row10 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row11" class="row_heading level0 row11" >vehicle_damage_Yes</th>
      <td id="T_8d113_row11_col0" class="data row11 col0" >0.28</td>
      <td id="T_8d113_row11_col1" class="data row11 col1" >0.03</td>
      <td id="T_8d113_row11_col2" class="data row11 col2" >0.01</td>
      <td id="T_8d113_row11_col3" class="data row11 col3" >-0.23</td>
      <td id="T_8d113_row11_col4" class="data row11 col4" >-0.01</td>
      <td id="T_8d113_row11_col5" class="data row11 col5" >0.82</td>
      <td id="T_8d113_row11_col6" class="data row11 col6" >-0.82</td>
      <td id="T_8d113_row11_col7" class="data row11 col7" >0.29</td>
      <td id="T_8d113_row11_col8" class="data row11 col8" >-0.37</td>
      <td id="T_8d113_row11_col9" class="data row11 col9" >0.20</td>
      <td id="T_8d113_row11_col10" class="data row11 col10" >-1.00</td>
      <td id="T_8d113_row11_col11" class="data row11 col11" >nan</td>
      <td id="T_8d113_row11_col12" class="data row11 col12" >nan</td>
      <td id="T_8d113_row11_col13" class="data row11 col13" >nan</td>
      <td id="T_8d113_row11_col14" class="data row11 col14" >nan</td>
      <td id="T_8d113_row11_col15" class="data row11 col15" >nan</td>
      <td id="T_8d113_row11_col16" class="data row11 col16" >nan</td>
      <td id="T_8d113_row11_col17" class="data row11 col17" >nan</td>
      <td id="T_8d113_row11_col18" class="data row11 col18" >nan</td>
      <td id="T_8d113_row11_col19" class="data row11 col19" >nan</td>
      <td id="T_8d113_row11_col20" class="data row11 col20" >nan</td>
      <td id="T_8d113_row11_col21" class="data row11 col21" >nan</td>
      <td id="T_8d113_row11_col22" class="data row11 col22" >nan</td>
      <td id="T_8d113_row11_col23" class="data row11 col23" >nan</td>
      <td id="T_8d113_row11_col24" class="data row11 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row12" class="row_heading level0 row12" >previously_insured_No</th>
      <td id="T_8d113_row12_col0" class="data row12 col0" >0.27</td>
      <td id="T_8d113_row12_col1" class="data row12 col1" >0.03</td>
      <td id="T_8d113_row12_col2" class="data row12 col2" >-0.01</td>
      <td id="T_8d113_row12_col3" class="data row12 col3" >-0.22</td>
      <td id="T_8d113_row12_col4" class="data row12 col4" >-0.01</td>
      <td id="T_8d113_row12_col5" class="data row12 col5" >1.00</td>
      <td id="T_8d113_row12_col6" class="data row12 col6" >-1.00</td>
      <td id="T_8d113_row12_col7" class="data row12 col7" >0.29</td>
      <td id="T_8d113_row12_col8" class="data row12 col8" >-0.36</td>
      <td id="T_8d113_row12_col9" class="data row12 col9" >0.19</td>
      <td id="T_8d113_row12_col10" class="data row12 col10" >-0.82</td>
      <td id="T_8d113_row12_col11" class="data row12 col11" >0.82</td>
      <td id="T_8d113_row12_col12" class="data row12 col12" >nan</td>
      <td id="T_8d113_row12_col13" class="data row12 col13" >nan</td>
      <td id="T_8d113_row12_col14" class="data row12 col14" >nan</td>
      <td id="T_8d113_row12_col15" class="data row12 col15" >nan</td>
      <td id="T_8d113_row12_col16" class="data row12 col16" >nan</td>
      <td id="T_8d113_row12_col17" class="data row12 col17" >nan</td>
      <td id="T_8d113_row12_col18" class="data row12 col18" >nan</td>
      <td id="T_8d113_row12_col19" class="data row12 col19" >nan</td>
      <td id="T_8d113_row12_col20" class="data row12 col20" >nan</td>
      <td id="T_8d113_row12_col21" class="data row12 col21" >nan</td>
      <td id="T_8d113_row12_col22" class="data row12 col22" >nan</td>
      <td id="T_8d113_row12_col23" class="data row12 col23" >nan</td>
      <td id="T_8d113_row12_col24" class="data row12 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row13" class="row_heading level0 row13" >previously_insured_Yes</th>
      <td id="T_8d113_row13_col0" class="data row13 col0" >-0.27</td>
      <td id="T_8d113_row13_col1" class="data row13 col1" >-0.03</td>
      <td id="T_8d113_row13_col2" class="data row13 col2" >0.01</td>
      <td id="T_8d113_row13_col3" class="data row13 col3" >0.22</td>
      <td id="T_8d113_row13_col4" class="data row13 col4" >0.01</td>
      <td id="T_8d113_row13_col5" class="data row13 col5" >-1.00</td>
      <td id="T_8d113_row13_col6" class="data row13 col6" >1.00</td>
      <td id="T_8d113_row13_col7" class="data row13 col7" >-0.29</td>
      <td id="T_8d113_row13_col8" class="data row13 col8" >0.36</td>
      <td id="T_8d113_row13_col9" class="data row13 col9" >-0.19</td>
      <td id="T_8d113_row13_col10" class="data row13 col10" >0.82</td>
      <td id="T_8d113_row13_col11" class="data row13 col11" >-0.82</td>
      <td id="T_8d113_row13_col12" class="data row13 col12" >-1.00</td>
      <td id="T_8d113_row13_col13" class="data row13 col13" >nan</td>
      <td id="T_8d113_row13_col14" class="data row13 col14" >nan</td>
      <td id="T_8d113_row13_col15" class="data row13 col15" >nan</td>
      <td id="T_8d113_row13_col16" class="data row13 col16" >nan</td>
      <td id="T_8d113_row13_col17" class="data row13 col17" >nan</td>
      <td id="T_8d113_row13_col18" class="data row13 col18" >nan</td>
      <td id="T_8d113_row13_col19" class="data row13 col19" >nan</td>
      <td id="T_8d113_row13_col20" class="data row13 col20" >nan</td>
      <td id="T_8d113_row13_col21" class="data row13 col21" >nan</td>
      <td id="T_8d113_row13_col22" class="data row13 col22" >nan</td>
      <td id="T_8d113_row13_col23" class="data row13 col23" >nan</td>
      <td id="T_8d113_row13_col24" class="data row13 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row14" class="row_heading level0 row14" >gender_Female</th>
      <td id="T_8d113_row14_col0" class="data row14 col0" >-0.16</td>
      <td id="T_8d113_row14_col1" class="data row14 col1" >-0.00</td>
      <td id="T_8d113_row14_col2" class="data row14 col2" >-0.00</td>
      <td id="T_8d113_row14_col3" class="data row14 col3" >0.11</td>
      <td id="T_8d113_row14_col4" class="data row14 col4" >0.00</td>
      <td id="T_8d113_row14_col5" class="data row14 col5" >-0.08</td>
      <td id="T_8d113_row14_col6" class="data row14 col6" >0.08</td>
      <td id="T_8d113_row14_col7" class="data row14 col7" >-0.15</td>
      <td id="T_8d113_row14_col8" class="data row14 col8" >0.17</td>
      <td id="T_8d113_row14_col9" class="data row14 col9" >-0.05</td>
      <td id="T_8d113_row14_col10" class="data row14 col10" >0.09</td>
      <td id="T_8d113_row14_col11" class="data row14 col11" >-0.09</td>
      <td id="T_8d113_row14_col12" class="data row14 col12" >-0.08</td>
      <td id="T_8d113_row14_col13" class="data row14 col13" >0.08</td>
      <td id="T_8d113_row14_col14" class="data row14 col14" >nan</td>
      <td id="T_8d113_row14_col15" class="data row14 col15" >nan</td>
      <td id="T_8d113_row14_col16" class="data row14 col16" >nan</td>
      <td id="T_8d113_row14_col17" class="data row14 col17" >nan</td>
      <td id="T_8d113_row14_col18" class="data row14 col18" >nan</td>
      <td id="T_8d113_row14_col19" class="data row14 col19" >nan</td>
      <td id="T_8d113_row14_col20" class="data row14 col20" >nan</td>
      <td id="T_8d113_row14_col21" class="data row14 col21" >nan</td>
      <td id="T_8d113_row14_col22" class="data row14 col22" >nan</td>
      <td id="T_8d113_row14_col23" class="data row14 col23" >nan</td>
      <td id="T_8d113_row14_col24" class="data row14 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row15" class="row_heading level0 row15" >gender_Male</th>
      <td id="T_8d113_row15_col0" class="data row15 col0" >0.16</td>
      <td id="T_8d113_row15_col1" class="data row15 col1" >0.00</td>
      <td id="T_8d113_row15_col2" class="data row15 col2" >0.00</td>
      <td id="T_8d113_row15_col3" class="data row15 col3" >-0.11</td>
      <td id="T_8d113_row15_col4" class="data row15 col4" >-0.00</td>
      <td id="T_8d113_row15_col5" class="data row15 col5" >0.08</td>
      <td id="T_8d113_row15_col6" class="data row15 col6" >-0.08</td>
      <td id="T_8d113_row15_col7" class="data row15 col7" >0.15</td>
      <td id="T_8d113_row15_col8" class="data row15 col8" >-0.17</td>
      <td id="T_8d113_row15_col9" class="data row15 col9" >0.05</td>
      <td id="T_8d113_row15_col10" class="data row15 col10" >-0.09</td>
      <td id="T_8d113_row15_col11" class="data row15 col11" >0.09</td>
      <td id="T_8d113_row15_col12" class="data row15 col12" >0.08</td>
      <td id="T_8d113_row15_col13" class="data row15 col13" >-0.08</td>
      <td id="T_8d113_row15_col14" class="data row15 col14" >-1.00</td>
      <td id="T_8d113_row15_col15" class="data row15 col15" >nan</td>
      <td id="T_8d113_row15_col16" class="data row15 col16" >nan</td>
      <td id="T_8d113_row15_col17" class="data row15 col17" >nan</td>
      <td id="T_8d113_row15_col18" class="data row15 col18" >nan</td>
      <td id="T_8d113_row15_col19" class="data row15 col19" >nan</td>
      <td id="T_8d113_row15_col20" class="data row15 col20" >nan</td>
      <td id="T_8d113_row15_col21" class="data row15 col21" >nan</td>
      <td id="T_8d113_row15_col22" class="data row15 col22" >nan</td>
      <td id="T_8d113_row15_col23" class="data row15 col23" >nan</td>
      <td id="T_8d113_row15_col24" class="data row15 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row16" class="row_heading level0 row16" >mean_annual_vintage</th>
      <td id="T_8d113_row16_col0" class="data row16 col0" >0.06</td>
      <td id="T_8d113_row16_col1" class="data row16 col1" >-0.01</td>
      <td id="T_8d113_row16_col2" class="data row16 col2" >1.00</td>
      <td id="T_8d113_row16_col3" class="data row16 col3" >-0.11</td>
      <td id="T_8d113_row16_col4" class="data row16 col4" >0.01</td>
      <td id="T_8d113_row16_col5" class="data row16 col5" >-0.01</td>
      <td id="T_8d113_row16_col6" class="data row16 col6" >0.01</td>
      <td id="T_8d113_row16_col7" class="data row16 col7" >-0.01</td>
      <td id="T_8d113_row16_col8" class="data row16 col8" >-0.02</td>
      <td id="T_8d113_row16_col9" class="data row16 col9" >0.06</td>
      <td id="T_8d113_row16_col10" class="data row16 col10" >-0.01</td>
      <td id="T_8d113_row16_col11" class="data row16 col11" >0.01</td>
      <td id="T_8d113_row16_col12" class="data row16 col12" >-0.01</td>
      <td id="T_8d113_row16_col13" class="data row16 col13" >0.01</td>
      <td id="T_8d113_row16_col14" class="data row16 col14" >-0.00</td>
      <td id="T_8d113_row16_col15" class="data row16 col15" >0.00</td>
      <td id="T_8d113_row16_col16" class="data row16 col16" >nan</td>
      <td id="T_8d113_row16_col17" class="data row16 col17" >nan</td>
      <td id="T_8d113_row16_col18" class="data row16 col18" >nan</td>
      <td id="T_8d113_row16_col19" class="data row16 col19" >nan</td>
      <td id="T_8d113_row16_col20" class="data row16 col20" >nan</td>
      <td id="T_8d113_row16_col21" class="data row16 col21" >nan</td>
      <td id="T_8d113_row16_col22" class="data row16 col22" >nan</td>
      <td id="T_8d113_row16_col23" class="data row16 col23" >nan</td>
      <td id="T_8d113_row16_col24" class="data row16 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row17" class="row_heading level0 row17" >prod_annual_vintage</th>
      <td id="T_8d113_row17_col0" class="data row17 col0" >0.04</td>
      <td id="T_8d113_row17_col1" class="data row17 col1" >-0.01</td>
      <td id="T_8d113_row17_col2" class="data row17 col2" >0.67</td>
      <td id="T_8d113_row17_col3" class="data row17 col3" >-0.07</td>
      <td id="T_8d113_row17_col4" class="data row17 col4" >0.65</td>
      <td id="T_8d113_row17_col5" class="data row17 col5" >-0.01</td>
      <td id="T_8d113_row17_col6" class="data row17 col6" >0.01</td>
      <td id="T_8d113_row17_col7" class="data row17 col7" >-0.01</td>
      <td id="T_8d113_row17_col8" class="data row17 col8" >-0.01</td>
      <td id="T_8d113_row17_col9" class="data row17 col9" >0.04</td>
      <td id="T_8d113_row17_col10" class="data row17 col10" >0.00</td>
      <td id="T_8d113_row17_col11" class="data row17 col11" >-0.00</td>
      <td id="T_8d113_row17_col12" class="data row17 col12" >-0.01</td>
      <td id="T_8d113_row17_col13" class="data row17 col13" >0.01</td>
      <td id="T_8d113_row17_col14" class="data row17 col14" >-0.00</td>
      <td id="T_8d113_row17_col15" class="data row17 col15" >0.00</td>
      <td id="T_8d113_row17_col16" class="data row17 col16" >0.68</td>
      <td id="T_8d113_row17_col17" class="data row17 col17" >nan</td>
      <td id="T_8d113_row17_col18" class="data row17 col18" >nan</td>
      <td id="T_8d113_row17_col19" class="data row17 col19" >nan</td>
      <td id="T_8d113_row17_col20" class="data row17 col20" >nan</td>
      <td id="T_8d113_row17_col21" class="data row17 col21" >nan</td>
      <td id="T_8d113_row17_col22" class="data row17 col22" >nan</td>
      <td id="T_8d113_row17_col23" class="data row17 col23" >nan</td>
      <td id="T_8d113_row17_col24" class="data row17 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row18" class="row_heading level0 row18" >sum_annual_vintage</th>
      <td id="T_8d113_row18_col0" class="data row18 col0" >0.06</td>
      <td id="T_8d113_row18_col1" class="data row18 col1" >-0.01</td>
      <td id="T_8d113_row18_col2" class="data row18 col2" >1.00</td>
      <td id="T_8d113_row18_col3" class="data row18 col3" >-0.11</td>
      <td id="T_8d113_row18_col4" class="data row18 col4" >0.01</td>
      <td id="T_8d113_row18_col5" class="data row18 col5" >-0.01</td>
      <td id="T_8d113_row18_col6" class="data row18 col6" >0.01</td>
      <td id="T_8d113_row18_col7" class="data row18 col7" >-0.01</td>
      <td id="T_8d113_row18_col8" class="data row18 col8" >-0.02</td>
      <td id="T_8d113_row18_col9" class="data row18 col9" >0.06</td>
      <td id="T_8d113_row18_col10" class="data row18 col10" >-0.01</td>
      <td id="T_8d113_row18_col11" class="data row18 col11" >0.01</td>
      <td id="T_8d113_row18_col12" class="data row18 col12" >-0.01</td>
      <td id="T_8d113_row18_col13" class="data row18 col13" >0.01</td>
      <td id="T_8d113_row18_col14" class="data row18 col14" >-0.00</td>
      <td id="T_8d113_row18_col15" class="data row18 col15" >0.00</td>
      <td id="T_8d113_row18_col16" class="data row18 col16" >1.00</td>
      <td id="T_8d113_row18_col17" class="data row18 col17" >0.68</td>
      <td id="T_8d113_row18_col18" class="data row18 col18" >nan</td>
      <td id="T_8d113_row18_col19" class="data row18 col19" >nan</td>
      <td id="T_8d113_row18_col20" class="data row18 col20" >nan</td>
      <td id="T_8d113_row18_col21" class="data row18 col21" >nan</td>
      <td id="T_8d113_row18_col22" class="data row18 col22" >nan</td>
      <td id="T_8d113_row18_col23" class="data row18 col23" >nan</td>
      <td id="T_8d113_row18_col24" class="data row18 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row19" class="row_heading level0 row19" >std_annual_vintage</th>
      <td id="T_8d113_row19_col0" class="data row19 col0" >0.06</td>
      <td id="T_8d113_row19_col1" class="data row19 col1" >-0.01</td>
      <td id="T_8d113_row19_col2" class="data row19 col2" >1.00</td>
      <td id="T_8d113_row19_col3" class="data row19 col3" >-0.11</td>
      <td id="T_8d113_row19_col4" class="data row19 col4" >-0.00</td>
      <td id="T_8d113_row19_col5" class="data row19 col5" >-0.01</td>
      <td id="T_8d113_row19_col6" class="data row19 col6" >0.01</td>
      <td id="T_8d113_row19_col7" class="data row19 col7" >-0.01</td>
      <td id="T_8d113_row19_col8" class="data row19 col8" >-0.02</td>
      <td id="T_8d113_row19_col9" class="data row19 col9" >0.06</td>
      <td id="T_8d113_row19_col10" class="data row19 col10" >-0.01</td>
      <td id="T_8d113_row19_col11" class="data row19 col11" >0.01</td>
      <td id="T_8d113_row19_col12" class="data row19 col12" >-0.01</td>
      <td id="T_8d113_row19_col13" class="data row19 col13" >0.01</td>
      <td id="T_8d113_row19_col14" class="data row19 col14" >-0.00</td>
      <td id="T_8d113_row19_col15" class="data row19 col15" >0.00</td>
      <td id="T_8d113_row19_col16" class="data row19 col16" >1.00</td>
      <td id="T_8d113_row19_col17" class="data row19 col17" >0.67</td>
      <td id="T_8d113_row19_col18" class="data row19 col18" >1.00</td>
      <td id="T_8d113_row19_col19" class="data row19 col19" >nan</td>
      <td id="T_8d113_row19_col20" class="data row19 col20" >nan</td>
      <td id="T_8d113_row19_col21" class="data row19 col21" >nan</td>
      <td id="T_8d113_row19_col22" class="data row19 col22" >nan</td>
      <td id="T_8d113_row19_col23" class="data row19 col23" >nan</td>
      <td id="T_8d113_row19_col24" class="data row19 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row20" class="row_heading level0 row20" >age_bin</th>
      <td id="T_8d113_row20_col0" class="data row20 col0" >0.93</td>
      <td id="T_8d113_row20_col1" class="data row20 col1" >0.03</td>
      <td id="T_8d113_row20_col2" class="data row20 col2" >0.07</td>
      <td id="T_8d113_row20_col3" class="data row20 col3" >-0.54</td>
      <td id="T_8d113_row20_col4" class="data row20 col4" >-0.00</td>
      <td id="T_8d113_row20_col5" class="data row20 col5" >0.23</td>
      <td id="T_8d113_row20_col6" class="data row20 col6" >-0.23</td>
      <td id="T_8d113_row20_col7" class="data row20 col7" >0.60</td>
      <td id="T_8d113_row20_col8" class="data row20 col8" >-0.68</td>
      <td id="T_8d113_row20_col9" class="data row20 col9" >0.21</td>
      <td id="T_8d113_row20_col10" class="data row20 col10" >-0.24</td>
      <td id="T_8d113_row20_col11" class="data row20 col11" >0.24</td>
      <td id="T_8d113_row20_col12" class="data row20 col12" >0.23</td>
      <td id="T_8d113_row20_col13" class="data row20 col13" >-0.23</td>
      <td id="T_8d113_row20_col14" class="data row20 col14" >-0.14</td>
      <td id="T_8d113_row20_col15" class="data row20 col15" >0.14</td>
      <td id="T_8d113_row20_col16" class="data row20 col16" >0.07</td>
      <td id="T_8d113_row20_col17" class="data row20 col17" >0.04</td>
      <td id="T_8d113_row20_col18" class="data row20 col18" >0.07</td>
      <td id="T_8d113_row20_col19" class="data row20 col19" >0.07</td>
      <td id="T_8d113_row20_col20" class="data row20 col20" >nan</td>
      <td id="T_8d113_row20_col21" class="data row20 col21" >nan</td>
      <td id="T_8d113_row20_col22" class="data row20 col22" >nan</td>
      <td id="T_8d113_row20_col23" class="data row20 col23" >nan</td>
      <td id="T_8d113_row20_col24" class="data row20 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row21" class="row_heading level0 row21" >annual_premium_scaled</th>
      <td id="T_8d113_row21_col0" class="data row21 col0" >0.06</td>
      <td id="T_8d113_row21_col1" class="data row21 col1" >-0.01</td>
      <td id="T_8d113_row21_col2" class="data row21 col2" >1.00</td>
      <td id="T_8d113_row21_col3" class="data row21 col3" >-0.11</td>
      <td id="T_8d113_row21_col4" class="data row21 col4" >0.00</td>
      <td id="T_8d113_row21_col5" class="data row21 col5" >-0.01</td>
      <td id="T_8d113_row21_col6" class="data row21 col6" >0.01</td>
      <td id="T_8d113_row21_col7" class="data row21 col7" >-0.01</td>
      <td id="T_8d113_row21_col8" class="data row21 col8" >-0.02</td>
      <td id="T_8d113_row21_col9" class="data row21 col9" >0.06</td>
      <td id="T_8d113_row21_col10" class="data row21 col10" >-0.01</td>
      <td id="T_8d113_row21_col11" class="data row21 col11" >0.01</td>
      <td id="T_8d113_row21_col12" class="data row21 col12" >-0.01</td>
      <td id="T_8d113_row21_col13" class="data row21 col13" >0.01</td>
      <td id="T_8d113_row21_col14" class="data row21 col14" >-0.00</td>
      <td id="T_8d113_row21_col15" class="data row21 col15" >0.00</td>
      <td id="T_8d113_row21_col16" class="data row21 col16" >1.00</td>
      <td id="T_8d113_row21_col17" class="data row21 col17" >0.67</td>
      <td id="T_8d113_row21_col18" class="data row21 col18" >1.00</td>
      <td id="T_8d113_row21_col19" class="data row21 col19" >1.00</td>
      <td id="T_8d113_row21_col20" class="data row21 col20" >0.07</td>
      <td id="T_8d113_row21_col21" class="data row21 col21" >nan</td>
      <td id="T_8d113_row21_col22" class="data row21 col22" >nan</td>
      <td id="T_8d113_row21_col23" class="data row21 col23" >nan</td>
      <td id="T_8d113_row21_col24" class="data row21 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row22" class="row_heading level0 row22" >annual_premium_min_max_scaled</th>
      <td id="T_8d113_row22_col0" class="data row22 col0" >0.06</td>
      <td id="T_8d113_row22_col1" class="data row22 col1" >-0.01</td>
      <td id="T_8d113_row22_col2" class="data row22 col2" >1.00</td>
      <td id="T_8d113_row22_col3" class="data row22 col3" >-0.11</td>
      <td id="T_8d113_row22_col4" class="data row22 col4" >0.00</td>
      <td id="T_8d113_row22_col5" class="data row22 col5" >-0.01</td>
      <td id="T_8d113_row22_col6" class="data row22 col6" >0.01</td>
      <td id="T_8d113_row22_col7" class="data row22 col7" >-0.01</td>
      <td id="T_8d113_row22_col8" class="data row22 col8" >-0.02</td>
      <td id="T_8d113_row22_col9" class="data row22 col9" >0.06</td>
      <td id="T_8d113_row22_col10" class="data row22 col10" >-0.01</td>
      <td id="T_8d113_row22_col11" class="data row22 col11" >0.01</td>
      <td id="T_8d113_row22_col12" class="data row22 col12" >-0.01</td>
      <td id="T_8d113_row22_col13" class="data row22 col13" >0.01</td>
      <td id="T_8d113_row22_col14" class="data row22 col14" >-0.00</td>
      <td id="T_8d113_row22_col15" class="data row22 col15" >0.00</td>
      <td id="T_8d113_row22_col16" class="data row22 col16" >1.00</td>
      <td id="T_8d113_row22_col17" class="data row22 col17" >0.67</td>
      <td id="T_8d113_row22_col18" class="data row22 col18" >1.00</td>
      <td id="T_8d113_row22_col19" class="data row22 col19" >1.00</td>
      <td id="T_8d113_row22_col20" class="data row22 col20" >0.07</td>
      <td id="T_8d113_row22_col21" class="data row22 col21" >1.00</td>
      <td id="T_8d113_row22_col22" class="data row22 col22" >nan</td>
      <td id="T_8d113_row22_col23" class="data row22 col23" >nan</td>
      <td id="T_8d113_row22_col24" class="data row22 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row23" class="row_heading level0 row23" >annual_premium_q_trans_uniform</th>
      <td id="T_8d113_row23_col0" class="data row23 col0" >0.09</td>
      <td id="T_8d113_row23_col1" class="data row23 col1" >-0.01</td>
      <td id="T_8d113_row23_col2" class="data row23 col2" >0.92</td>
      <td id="T_8d113_row23_col3" class="data row23 col3" >-0.14</td>
      <td id="T_8d113_row23_col4" class="data row23 col4" >0.00</td>
      <td id="T_8d113_row23_col5" class="data row23 col5" >0.02</td>
      <td id="T_8d113_row23_col6" class="data row23 col6" >-0.02</td>
      <td id="T_8d113_row23_col7" class="data row23 col7" >0.02</td>
      <td id="T_8d113_row23_col8" class="data row23 col8" >-0.05</td>
      <td id="T_8d113_row23_col9" class="data row23 col9" >0.07</td>
      <td id="T_8d113_row23_col10" class="data row23 col10" >-0.03</td>
      <td id="T_8d113_row23_col11" class="data row23 col11" >0.03</td>
      <td id="T_8d113_row23_col12" class="data row23 col12" >0.02</td>
      <td id="T_8d113_row23_col13" class="data row23 col13" >-0.02</td>
      <td id="T_8d113_row23_col14" class="data row23 col14" >-0.01</td>
      <td id="T_8d113_row23_col15" class="data row23 col15" >0.01</td>
      <td id="T_8d113_row23_col16" class="data row23 col16" >0.92</td>
      <td id="T_8d113_row23_col17" class="data row23 col17" >0.61</td>
      <td id="T_8d113_row23_col18" class="data row23 col18" >0.92</td>
      <td id="T_8d113_row23_col19" class="data row23 col19" >0.92</td>
      <td id="T_8d113_row23_col20" class="data row23 col20" >0.10</td>
      <td id="T_8d113_row23_col21" class="data row23 col21" >0.92</td>
      <td id="T_8d113_row23_col22" class="data row23 col22" >0.92</td>
      <td id="T_8d113_row23_col23" class="data row23 col23" >nan</td>
      <td id="T_8d113_row23_col24" class="data row23 col24" >nan</td>
    </tr>
    <tr>
      <th id="T_8d113_level0_row24" class="row_heading level0 row24" >annual_premium_q_trans_normal</th>
      <td id="T_8d113_row24_col0" class="data row24 col0" >-0.00</td>
      <td id="T_8d113_row24_col1" class="data row24 col1" >-0.00</td>
      <td id="T_8d113_row24_col2" class="data row24 col2" >0.90</td>
      <td id="T_8d113_row24_col3" class="data row24 col3" >-0.07</td>
      <td id="T_8d113_row24_col4" class="data row24 col4" >0.00</td>
      <td id="T_8d113_row24_col5" class="data row24 col5" >-0.05</td>
      <td id="T_8d113_row24_col6" class="data row24 col6" >0.05</td>
      <td id="T_8d113_row24_col7" class="data row24 col7" >-0.06</td>
      <td id="T_8d113_row24_col8" class="data row24 col8" >0.05</td>
      <td id="T_8d113_row24_col9" class="data row24 col9" >0.03</td>
      <td id="T_8d113_row24_col10" class="data row24 col10" >0.03</td>
      <td id="T_8d113_row24_col11" class="data row24 col11" >-0.03</td>
      <td id="T_8d113_row24_col12" class="data row24 col12" >-0.05</td>
      <td id="T_8d113_row24_col13" class="data row24 col13" >0.05</td>
      <td id="T_8d113_row24_col14" class="data row24 col14" >0.01</td>
      <td id="T_8d113_row24_col15" class="data row24 col15" >-0.01</td>
      <td id="T_8d113_row24_col16" class="data row24 col16" >0.90</td>
      <td id="T_8d113_row24_col17" class="data row24 col17" >0.60</td>
      <td id="T_8d113_row24_col18" class="data row24 col18" >0.90</td>
      <td id="T_8d113_row24_col19" class="data row24 col19" >0.90</td>
      <td id="T_8d113_row24_col20" class="data row24 col20" >0.02</td>
      <td id="T_8d113_row24_col21" class="data row24 col21" >0.90</td>
      <td id="T_8d113_row24_col22" class="data row24 col22" >0.90</td>
      <td id="T_8d113_row24_col23" class="data row24 col23" >0.90</td>
      <td id="T_8d113_row24_col24" class="data row24 col24" >nan</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="bewertung-des-feature-engineerings-mittels-logistischer-regression">
<h3>Bewertung des Feature Engineerings mittels Logistischer Regression<a class="headerlink" href="#bewertung-des-feature-engineerings-mittels-logistischer-regression" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Modell für die logistische Regression instanzieren</span>
<span class="n">lrg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Splitting vornehmen</span>
<span class="n">stratified_kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                       <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                       <span class="n">random_state</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Grid Search mit Parametertuning durchführen</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]}</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">RandomizedSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">lrg</span><span class="p">,</span>
                           <span class="n">param_distributions</span><span class="o">=</span><span class="n">param_grid</span><span class="p">,</span>
                           <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
                           <span class="n">cv</span><span class="o">=</span><span class="n">stratified_kfold</span><span class="p">,</span>
                           <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>


<span class="c1"># Modell fitten</span>
<span class="n">lrg_model</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_df_fe</span><span class="p">,</span> <span class="n">y_train_df</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">lrg_model</span><span class="o">.</span><span class="n">best_params_</span><span class="p">)</span>

<span class="n">cv_score</span> <span class="o">=</span> <span class="n">lrg_model</span><span class="o">.</span><span class="n">best_score_</span>

<span class="c1"># absolute und relative Vorhersagen treffen</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lrg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_df_fe</span><span class="p">)</span>
<span class="n">y_pred_proba</span> <span class="o">=</span> <span class="n">lrg_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_df_fe</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cross-validation score: </span><span class="si">{</span><span class="n">cv_score</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\aster\Documents_\Hochschule\Data Analysis Hausarbeit\Hausarbeit\venv\lib\site-packages\sklearn\model_selection\_search.py:292: UserWarning:

The total space of parameters 7 is smaller than n_iter=10. Running 7 iterations. For exhaustive searches, use GridSearchCV.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;C&#39;: 0.01}
Cross-validation score: 0.5780259616811314
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># False Positive, True Postive Rate bestimmen</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test_label_encoded</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">],</span> <span class="n">y_pred_proba</span><span class="p">)</span>

<span class="c1"># Fläche unter der False Positive, True Postive Rate berechnen</span>
<span class="n">auc_score</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test_label_encoded</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">],</span> <span class="n">y_pred_proba</span><span class="p">)</span>

<span class="c1"># Area Plot erstellen</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">area</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">fpr</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">tpr</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ROC-Curve (AUC=</span><span class="si">{</span><span class="n">auc</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">)</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;False Positive Rate&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;True Positive Rate&#39;</span><span class="p">),</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span>
<span class="p">)</span>

<span class="c1"># Linie des Zufallsmodelles einfügen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">),</span>
    <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># Skalierung anpassen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">constrain</span><span class="o">=</span><span class="s1">&#39;domain&#39;</span><span class="p">)</span>

<span class="c1"># Plot erstellen</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Aufgrund der niedrigen Korellation zwischen den, von uns neu generierten Variablen und den ursprünglichen, gehen wir nicht davon aus, dass diese unsere Daten besser beschreiben können und einen Mehrwert beim Modelling darstellen. Die gleiche Aussage lässt sich nach der Auswerung der logistischen Regression treffen, da sich der ROC AUC unterhalb der Kurve des Zufallsmodelles befindet. Daher haben wir uns dazu entschieden, keine neuen Features in den Trainingsdatensatz aufzunehmen.</p>
<p>Exportieren der finalen Trains - und Testdaten als csv Dateien</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_under</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/x_train_clean.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">y_train_under</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/y_train_clean.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

<span class="n">X_test_under</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/x_test_clean.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">y_test_under</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/y_test_clean.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="data_understanding.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Data Understanding</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="modelling.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Random Forest Classifier Train Set</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Marc Bösen, Tim Lui<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>